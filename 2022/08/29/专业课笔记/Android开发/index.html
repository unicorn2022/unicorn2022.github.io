<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Android开发 | 华风夏韵</title><meta name="author" content="华丰夏"><meta name="copyright" content="华丰夏"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Android开发学习笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="Android开发">
<meta property="og:url" content="https://hzoi-unicorn.top/2022/08/29/%E4%B8%93%E4%B8%9A%E8%AF%BE%E7%AC%94%E8%AE%B0/Android%E5%BC%80%E5%8F%91/index.html">
<meta property="og:site_name" content="华风夏韵">
<meta property="og:description" content="Android开发学习笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hzoi-unicorn.top/img/avatar.png">
<meta property="article:published_time" content="2022-08-28T16:00:00.000Z">
<meta property="article:modified_time" content="2023-08-05T07:49:31.723Z">
<meta property="article:author" content="华丰夏">
<meta property="article:tag" content="专业课">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hzoi-unicorn.top/img/avatar.png"><link rel="shortcut icon" href="https://raw.githubusercontent.com/unicorn2022/Pictures/main/img/favicon.png"><link rel="canonical" href="https://hzoi-unicorn.top/2022/08/29/%E4%B8%93%E4%B8%9A%E8%AF%BE%E7%AC%94%E8%AE%B0/Android%E5%BC%80%E5%8F%91/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="baidu-site-verification" content="codeva-PpLfvQYdq5"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: 华丰夏","link":"链接: ","source":"来源: 华风夏韵","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Android开发',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2023-08-05 15:49:31'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/background.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">48</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/resources/"><i class="fa-fw fa fa-book"></i><span> 资源</span></a></div><div class="menus_item"><a class="site-page" href="/tools/"><i class="fa-fw fas fa-list"></i><span> 在线工具</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/default_top_img.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="华风夏韵"><span class="site-name">华风夏韵</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/resources/"><i class="fa-fw fa fa-book"></i><span> 资源</span></a></div><div class="menus_item"><a class="site-page" href="/tools/"><i class="fa-fw fas fa-list"></i><span> 在线工具</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Android开发</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-08-28T16:00:00.000Z" title="发表于 2022-08-29 00:00:00">2022-08-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-08-05T07:49:31.723Z" title="更新于 2023-08-05 15:49:31">2023-08-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%B8%93%E4%B8%9A%E8%AF%BE%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">专业课学习笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">23.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>99分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Android开发"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><script type="text/javascript"
src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<h1 id="day1-android简介">Day1 Android简介</h1>
<h2 id="快捷键">快捷键</h2>
<h3 id="运行">运行</h3>
<ol type="1">
<li>运行：<strong>Shift+F10</strong></li>
<li>终止：<strong>Ctrl+F2</strong></li>
</ol>
<h3 id="日志">日志</h3>
<ol type="1">
<li>生成<strong>TAG</strong>常量：<strong>在方法外输入logt +
TAB</strong></li>
<li>打印不同级别的日志：<strong>在方法内输入logd/logi/logw/loge +
TAB</strong></li>
</ol>
<h2 id="第一章-开始启程--你的第一行android代码">第一章
开始启程--你的第一行Android代码</h2>
<h3 id="android的四大组件">1.1 Android的四大组件</h3>
<ol type="1">
<li>活动(<strong>Activity</strong>) ：
<ol type="1">
<li>活动是所有Android应用程序的门面，凡是在应用中你看得到的东西 ，
都是放在活动中的</li>
</ol></li>
<li>服务(<strong>Service</strong>)：
<ol type="1">
<li>你无法看到它，但它会一自在后台默默地运行</li>
<li>即使用户退出了应用，服务仍然是可以继续运行的。</li>
</ol></li>
<li>广播接收器(<strong>BroadcastReceiver</strong>) ：
<ol type="1">
<li>广播接收器允许你的应用接收来自 各处的广播消息，
比如电话、短信等</li>
<li>当然你的应用同样也可以向外发出广播消息</li>
</ol></li>
<li>内容提供器(<strong>ContentProvider</strong>)：
<ol type="1">
<li>内容提供器则为应用程序之间共享数据提供了可能</li>
<li>比如你想要读取系统电话部中的联系人，就需要通过内容提供器来实现。</li>
</ol></li>
</ol>
<h3 id="项目目录">1.2 项目目录</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830143913960.png" alt="image-20220830143913960" style="zoom:80%;" /></p>
<h4 id="gradle和idea">1.2.1 .gradle和idea</h4>
<ol type="1">
<li>这两个目录下放置的都是Android Studio自动生成的一些文件</li>
<li>我们无须关心、 也不要去手动编辑</li>
</ol>
<h4 id="app">1.2.2 app</h4>
<ol type="1">
<li>项目中的<strong>代码、资源</strong>等内容几乎都是放置在这个目录下的、
我们后面的开发工作也基本都是在这个目录下进行的，
待会儿还会对这个目录单独展开进行讲解</li>
</ol>
<h4 id="build">1.2.3 build</h4>
<ol type="1">
<li>这个目录你也不需要过多关心，
它主要包含了一些在编译时自动生成的文件</li>
</ol>
<h4 id="gradle">1.2.4 gradle</h4>
<ol type="1">
<li>这个目录下包含了<strong>gradle wrapper</strong>的配置文件</li>
<li>使用gradle
wrapper的方式不需要提前将gradle下载好，而是会自动根据本地的缓存情况决定是否需要联网下载gradle</li>
<li>Android Studio默认没有启用gradle
wrapper的方式，如果需要打开，可以点击<strong>Android
Studio导航栏|File|Settings|Build, Execution, Deployment |
Gradle</strong>，进行配置更改。</li>
</ol>
<h4 id="gitignore">1.2.5 . gitignore</h4>
<ol type="1">
<li>这个文件是用来将指定的目录或文件排除在版本控制之外的</li>
</ol>
<h4 id="build.gradle">1.2.6 build.gradle</h4>
<ol type="1">
<li>这是项目全局的<strong>gradle构建脚本</strong> ，
通常这个义件中的内容是不需要修改的</li>
</ol>
<h4 id="gradle.properties">1.2.7 gradle.properties</h4>
<ol type="1">
<li>这个文件是全局的<strong>gradle配置文件</strong>
，存这里配置的屈性将会影响到项目中所有的gradle编译脚本</li>
</ol>
<h4 id="gradlew和gradlew.bat">1.2.8 gradlew和gradlew.bat</h4>
<ol type="1">
<li>这两个文件是用来在命令行界面中执行gradle命令的</li>
<li>其中gradlew是在Linux或Mac系统中使用时，gradJew.bat是在Windows系统中使用的</li>
</ol>
<h4 id="helloworld.iml">1.2.9 HelloWorld.iml</h4>
<ol type="1">
<li>iml文件是所有lntelliJ IDEA项目都会自动生成的一个文件(Android
Studio是基T lntelliJ IDEA开发的）</li>
<li>用于标识这是一个lntelliJ IDEA顶目</li>
<li>我们不需要修改这个文件中的任何内容</li>
</ol>
<h4 id="local.properties">1.2.10 local.properties</h4>
<ol type="1">
<li>这个文件用于指定<strong>本机中的Android SDK路径</strong></li>
<li>通常内容都是自动生成的， 我们并不需要修改，除非你本机中的Android
SOK位置发生了变化 ，那么就将这个文件中的路径改成新的位置即可</li>
</ol>
<h4 id="settings.gradle">1.2.11 settings.gradle</h4>
<ol type="1">
<li>这个文件用于指定项目中<strong>所有引入的模块</strong></li>
<li>由于HelloWorld项目中就只有一个app模块，因此该文件中也就只引入了app这一个模块</li>
<li>通常情况下模块的引入都是自动完成的，需要我们手动去修改这个文件的场景可能比较少</li>
</ol>
<h3 id="app目录">1.3 app目录</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830144532751.png" alt="image-20220830144532751" style="zoom:80%;" /></p>
<h4 id="build-1">1.3.1 build</h4>
<ol type="1">
<li>这个目录和外层的build目录类似，主要也是包含了一些在编译时自动生成的文件，不过它里面的内容会更多更杂，我们不需要过多关心</li>
</ol>
<h4 id="libs">1.3.2 libs</h4>
<ol type="1">
<li>如果你的项目中使用到了<strong>第三方jar包</strong>，就需要把这些jar包都放在libs目录下</li>
<li>放在这个目录下的jar包都会被自动添加到构建路径里去。</li>
</ol>
<h4 id="androidtest">1.3.3 androidTest</h4>
<ol type="1">
<li>此处是用来编写<strong>Android Test测试用例</strong>的，
可以对项目进行一些<strong>自动化测试</strong></li>
</ol>
<h4 id="java">1.3.4 java</h4>
<ol type="1">
<li>毫无疑问，java目录是放置我们<strong>所有Java代码</strong>的地方</li>
<li>展开该目录，你将看到我们刚才创建的HelloWorldActivity文件就在里面。</li>
</ol>
<h4 id="res">1.3.5 res</h4>
<p>Android布局下的res文件夹：<img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830150114123.png" alt="image-20220830150114123" style="zoom:80%;" /></p>
<p>项目目录下的res文件夹：<img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830150302717.png" alt="image-20220830150302717" style="zoom:80%;" /></p>
<ol type="1">
<li>项目中使用到的所有<strong>图片、布局
、字符串等资源</strong>都要存放在这个目录下。</li>
<li>当然这个目录下还有很多子目录，所以你不用担心会把整个res目录弄得乱糟糟的
<ol type="1">
<li><strong>drawable</strong>目录：图片，多个文件夹用于适用不同设备的分辨率</li>
<li><strong>layout</strong>目录：布局</li>
<li><strong>mipmap</strong>目录：应用图标，多个文件夹用于适用不同设备的分辨率</li>
<li><strong>values</strong>目录：字符串、样式、颜色等配置</li>
</ol></li>
</ol>
<h4 id="androidmanifest.xml">1.3.6 AndroidManifest.xml</h4>
<ol type="1">
<li>这是你<strong>整个Android项目的配置文件</strong></li>
<li>你在程序中定义的所有四大组件都需要在这个文件里注册，另外还可以在这个文件中给应用程序添加权限声明。</li>
<li>由于这个文件以后会经常用到，我们用到的时候再做详细说明</li>
</ol>
<h4 id="test">1.3.7 test</h4>
<ol type="1">
<li>此处是用来编写<strong>Unit
Test测试用例</strong>的，是对项目进行自动化测试的另一种方式</li>
</ol>
<h4 id="gitignore-1">1.3.8 .gitignore</h4>
<ol type="1">
<li>这个文件用于将app
模块内的指定的目录或文件排除在版本控制之外，作用和外层的．gitignore文件类似</li>
</ol>
<h4 id="app.iml">1.3.9 app.iml</h4>
<ol type="1">
<li>IntelliJ IDEA项目自动生成的文件，
我们不需要关心或修改这个文件中的内容。</li>
</ol>
<h4 id="build.gradle-1">1.3.10 build.gradle</h4>
<ol type="1">
<li>这是<strong>app模块的gradle构建脚本</strong>，这个文件中会指定很多项目构建相关的配置</li>
</ol>
<h4 id="proguard-rules.pro">1.3.11 proguard-rules.pro</h4>
<ol type="1">
<li>这个文件用于指定<strong>项目代码的混淆规则</strong></li>
<li>当代码开发完成后打成安装包文件，如果不希望代码被别入破解，
通常会将代码进行混淆， 从而让破解者难以阅读</li>
</ol>
<h3 id="项目的运行">1.4 项目的运行</h3>
<h4 id="androidmanifest.xml注册活动">1.4.1
AndroidManifest.xml：注册活动</h4>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">package</span>=<span class="string">&quot;com.example.hw2_activity&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:allowBackup</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:dataExtractionRules</span>=<span class="string">&quot;@xml/data_extraction_rules&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fullBackupContent</span>=<span class="string">&quot;@xml/backup_rules&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:icon</span>=<span class="string">&quot;@mipmap/ic_launcher&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:label</span>=<span class="string">&quot;@string/app_name&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:roundIcon</span>=<span class="string">&quot;@mipmap/ic_launcher_round&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:supportsRtl</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:theme</span>=<span class="string">&quot;@style/Theme.Hw2_Activity&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">tools:targetApi</span>=<span class="string">&quot;31&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--对资源文件的引用--&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">&quot;.MainActivity&quot;</span> <span class="attr">android:exported</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.MAIN&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.LAUNCHER&quot;</span> /&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--这两句话表示, MainActivity是本项目的主活动, 在手机上点击应用图标, 首先应该启动这个活动--&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="mainactivity.java">1.4.2 MainActivity.java</h4>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line"><span class="comment">//AppCompatActivity是一种向下兼容的Activity</span></span><br><span class="line"><span class="comment">//可以将Activity在各个系统版本中增加的特性和功能最低兼容到Android 2.1版本</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">    <span class="comment">//活动被创建时必须执行的方法</span></span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        </span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        <span class="comment">//给当前活动引入了一个activity_main布局</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="activity_main.xml">1.4.3 activity_main.xml</h4>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.MainActivity&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--用于显示文字的一个控件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Hello World!&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="resvaluesstrings.xml">1.4.4 res/values/strings.xml</h4>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">&quot;app_name&quot;</span>&gt;</span>hw2_Activity<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol type="1">
<li>定义了一个应用程序名的字符串</li>
<li>引用方式：
<ol type="1">
<li>在代码中：<strong>R.string.app_name</strong></li>
<li>在XML中：<strong><span class="citation"
data-cites="string/app_name">@string/app_name</span></strong></li>
</ol></li>
<li><strong>string</strong>可以换成<strong>drawable、mipmap、layout</strong>等，用于引用其它文件夹内的资源</li>
</ol>
<h4 id="build.gradle-2">1.4.5 build.gradle</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830210700816.png" alt="image-20220830210700816" style="zoom:80%;" /></p>
<p>外层的<strong>build.gradle</strong>文件</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">plugins &#123;</span><br><span class="line">    id <span class="string">&#x27;com.android.application&#x27;</span> version <span class="string">&#x27;7.2.2&#x27;</span> apply <span class="literal">false</span></span><br><span class="line">    id <span class="string">&#x27;com.android.library&#x27;</span> version <span class="string">&#x27;7.2.2&#x27;</span> apply <span class="literal">false</span></span><br><span class="line">    <span class="comment">//构件中可能会使用到的插件的声明</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">task clean(<span class="attr">type:</span> Delete) &#123;</span><br><span class="line">    delete rootProject.buildDir</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>app/build.gradle</strong>文件</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">plugins &#123;</span><br><span class="line">    id <span class="string">&#x27;com.android.application&#x27;</span></span><br><span class="line">    <span class="comment">//使用插件</span></span><br><span class="line">    <span class="comment">//.application表示是应用程序模块</span></span><br><span class="line">    <span class="comment">//.library表示是库模块</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">    compileSdk <span class="number">32</span> <span class="comment">//指定项目的编译版本</span></span><br><span class="line"></span><br><span class="line">    defaultConfig &#123; <span class="comment">//项目的更多细节配置</span></span><br><span class="line">        applicationId <span class="string">&quot;com.example.hw2_activity&quot;</span> <span class="comment">//指定项目的包名</span></span><br><span class="line">        minSdk <span class="number">21</span>			<span class="comment">//最低兼容的Android系统版本</span></span><br><span class="line">        targetSdk <span class="number">32</span>		<span class="comment">//在该目标版本上已经做过充分的测试,系统会为程序启用该版本的最新功能和特性</span></span><br><span class="line">        versionCode <span class="number">1</span>		<span class="comment">//指定项目的版本号</span></span><br><span class="line">        versionName <span class="string">&quot;1.0&quot;</span>	<span class="comment">//指定项目的版本名</span></span><br><span class="line">        testInstrumentationRunner <span class="string">&quot;androidx.test.runner.AndroidJUnitRunner&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123; <span class="comment">//生成正式版安装文件的配置</span></span><br><span class="line">            minifyEnabled <span class="literal">false</span></span><br><span class="line">            <span class="comment">// 是否对项目的代码进行混淆</span></span><br><span class="line">            proguardFiles getDefaultProguardFile(<span class="string">&#x27;proguard-android-optimize.txt&#x27;</span>), <span class="string">&#x27;proguard-rules.pro&#x27;</span></span><br><span class="line">            <span class="comment">//混淆时使用的规则文件</span></span><br><span class="line">            <span class="comment">//proguard-android-optimize.txt是所有项目通用的混淆规则, 在Android SDK目录下</span></span><br><span class="line">            <span class="comment">//proguard-rules.pro当前有项目特有的混淆规则, 在当前项目的根目录下</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    compileOptions &#123;</span><br><span class="line">        sourceCompatibility JavaVersion.VERSION_1_8</span><br><span class="line">        targetCompatibility JavaVersion.VERSION_1_8</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123; <span class="comment">//项目的所有依赖关系</span></span><br><span class="line">    implementation <span class="string">&#x27;androidx.appcompat:appcompat:1.3.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;com.google.android.material:material:1.4.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;androidx.constraintlayout:constraintlayout:2.0.4&#x27;</span></span><br><span class="line">    </span><br><span class="line">    testImplementation <span class="string">&#x27;junit:junit:4.13.2&#x27;</span></span><br><span class="line">    androidTestImplementation <span class="string">&#x27;androidx.test.ext:junit:1.1.3&#x27;</span></span><br><span class="line">    androidTestImplementation <span class="string">&#x27;androidx.test.espresso:espresso-core:3.4.0&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>三种依赖关系：</p>
<ol type="1">
<li>本地依赖：可以对<strong>本地的Jar包或目录</strong>添加依赖关系</li>
<li>库依赖：可以对<strong>项目中的库模块</strong>添加依赖关系</li>
<li>远程依赖：可以对<strong>jcenter库上的开源项目</strong>添加依赖关系
<ol type="1">
<li><strong>com.google.android.material</strong>：域名</li>
<li><strong>:material</strong>：组名</li>
<li><strong>:1.4.0</strong>：版本号</li>
</ol></li>
</ol>
<h3 id="日志工具log">1.5 日志工具Log</h3>
<h4 id="日志工具类的使用">1.5.1 日志工具类的使用</h4>
<p>Android中的日志工具类是<strong>Log (android.util.Log)</strong>．
这个类中提供如下5个方法来供我们打印日志</p>
<ol type="1">
<li><strong>Log.v()</strong>：用于打印那些最为琐碎的意义最小的日志信息。对应级别<strong>verbose</strong>，是Android日志里面级别最低的一种</li>
<li><strong>Log.d()</strong>：用于打印一些调试信息，这些信息对你调试程序和分析问题应该是有帮助的。对应级别<strong>debug</strong>，比verbose高一级</li>
<li><strong>Log.i()</strong>：用于打印一些比较重要的数据，这些数据应该是你非常想看到的，可以帮你分析用户行为数据。
对应级别<strong>info</strong>, 比debug高一级</li>
<li><strong>Log.w()</strong>：用于打印一些警告信息，提示程序在这个地力可能会有潜在的风险，最好去修复一下这些出现瞥告的地方。对应级别<strong>warn</strong>，比info高一级</li>
<li><strong>Log.e()</strong>：用于打印程序中的错误信息，一般都代表程序出现严重问题了，必须尽快修复。对应级别<strong>error</strong>，比warn高一级</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.activity_main);</span><br><span class="line">    Log.d(<span class="string">&quot;MainActivity&quot;</span>, <span class="string">&quot;onCreate execute&quot;</span>);</span><br><span class="line">    <span class="comment">//第一个参数为tag, 一般传入当前类名</span></span><br><span class="line">    <span class="comment">//第二个参数为msg, 为想要打印的具体内容</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="logcat的使用">1.5.2 Logcat的使用</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830154354724.png" alt="image-20220830154354724" style="zoom:80%;" /></p>
<ol type="1">
<li><p>过滤器：<img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830154410752.png" alt="image-20220830154410752" style="zoom:80%;" /></p></li>
<li><p>自定义过滤器：在上述图标下拉栏中，选择<strong>Edit Filter
Configuration</strong></p>
<ol type="1">
<li>Log Tag：按照日志的TAG过滤</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830154509417.png" alt="image-20220830154509417" style="zoom:80%;" /></p></li>
<li><p>按照日志的级别过滤：只会显示高于选中级别的日志</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830154655780.png" alt="image-20220830154655780" style="zoom:80%;" /></p></li>
</ol>
<h1 id="day2-android基础ui开发">Day2 Android基础UI开发</h1>
<h2 id="第二章-先从看得到的入手--探究活动">第二章
先从看得到的入手--探究活动</h2>
<h3 id="活动的基本用法">2.1 活动的基本用法</h3>
<h4 id="手动创建活动">2.1.1 手动创建活动</h4>
<ol type="1">
<li><p>在下图目录下，<strong>右击|新建|Activity|Empty
Activity</strong></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830162047076.png" alt="image-20220830162047076" style="zoom:80%;" /></p></li>
<li><p>不要勾选</p>
<ol type="1">
<li>Generate a Layout File：自动创建一个对应的布局文件</li>
<li>Lancher
Activity：自动将创建的活动MainActivity设置为当前项目的主活动</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830162335459.png" alt="image-20220830162335459" style="zoom:80%;" /></p></li>
</ol>
<h4 id="创建和加载布局">2.1.2 创建和加载布局</h4>
<ol type="1">
<li><p>在下图目录下，<strong>右击|新建|Layout Resource File</strong></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830162420500.png" alt="image-20220830162420500" style="zoom:80%;" /></p></li>
<li><p>布局文件的首字母要小写</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830162517505.png" alt="image-20220830162517505" style="zoom:80%;" /></p></li>
<li><p><strong>first_layout.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--match_parent表示让当前元素和父元素一样宽--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--wrap_content表示当前元素的高度只要能刚好包含里面的内容就可以--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/button&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Button&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--@+表示在xml中定义一个id--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p><strong>FirstActivity.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FirstActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.first_layout);</span><br><span class="line">    	<span class="comment">//给当前活动加载一个布局</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="在androidmainfest文件中注册">2.1.3
在AndroidMainfest文件中注册</h4>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">package</span>=<span class="string">&quot;com.example.hw2_activity&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:allowBackup</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:dataExtractionRules</span>=<span class="string">&quot;@xml/data_extraction_rules&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fullBackupContent</span>=<span class="string">&quot;@xml/backup_rules&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:icon</span>=<span class="string">&quot;@mipmap/ic_launcher&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:label</span>=<span class="string">&quot;@string/app_name&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:roundIcon</span>=<span class="string">&quot;@mipmap/ic_launcher_round&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:supportsRtl</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:theme</span>=<span class="string">&quot;@style/Theme.Hw2_Activity&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">tools:targetApi</span>=<span class="string">&quot;31&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:name</span>=<span class="string">&quot;.FirstActivity&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:exported</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:label</span>=<span class="string">&quot;This is the first activity&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--注意android:exported必须为true--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--android:label是当前活动的标题--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.MAIN&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.LAUNCHER&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="在活动中使用toast">2.1.4 在活动中使用Toast</h4>
<ol type="1">
<li><p>Toast是Android系统提供的一种非常好的提醒方式</p></li>
<li><p>在程序中可以使用它将一些短小的信息通知给用户，这些信息会在一段时间后自动消失，并且不会占用任何屏幕空间，</p></li>
<li><p>我们现在就尝试一下如何在活动中使用Toast：通过Button触发Toast，修改<strong>FirstActivity.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FirstActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.first_layout);</span><br><span class="line"></span><br><span class="line">        <span class="type">Button</span> <span class="variable">button1</span> <span class="operator">=</span> (Button) findViewById(R.id.button);</span><br><span class="line">        <span class="comment">// 通过button的id,获取其实例</span></span><br><span class="line">        <span class="comment">// 这个值是在first_layout.xml中通过android:id属性指定的</span></span><br><span class="line">        <span class="comment">// findViewById返回的是View对象, 需要将其向下转化为Button对象</span></span><br><span class="line">        button1.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="comment">// 获得按钮实例后, 通过调用setOnClickListener()方法为按钮注册一个监听器</span></span><br><span class="line">            <span class="comment">// 点击按钮时, 就会执行监听器中的onClick()方法</span></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                Toast.makeText(FirstActivity.<span class="built_in">this</span>, <span class="string">&quot;You clicked Button &quot;</span>,Toast.LENGTH_SHORT).show();</span><br><span class="line">                <span class="comment">// 通过静态方法makeText()创建一个Toast对象, 然后调用show()方法将其显示出来即可</span></span><br><span class="line">                <span class="comment">// makeText()的三个参数:</span></span><br><span class="line">                <span class="comment">// context: Toast要求的上下文, 由于活动本身就是一个Context对象, 因此这里直接传入this</span></span><br><span class="line">                <span class="comment">// text: Toast显示的文本内容</span></span><br><span class="line">                <span class="comment">// Toast显示的时长, 有两个选择: Toast.LENGTH_SHORT/Toast.LENGTH_LONG</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="在活动中使用menu">2.1.5 在活动中使用Menu</h4>
<ol type="1">
<li><p>在<strong>res</strong>目录下，新建一个目录<strong>menu</strong></p></li>
<li><p><strong>右击menu文件夹|新建|Menu Resource
File</strong>，文件名输入<strong>main</strong></p></li>
<li><p>修改<strong>main.xml</strong>文件</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">menu</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/add_item&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">&quot;Add&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/remove_item&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">&quot;Remove&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;item&gt;标签就是用来创建具体的某一个菜单项--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--android:id表示唯一标识符--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--android:title给这个菜单项指定一个名称--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">menu</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>修改<strong>FirstActivity.java</strong>文件，重写<strong>onCreateOptionMenu()</strong>方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onCreateOptionsMenu</span><span class="params">(Menu menu)</span> &#123;</span><br><span class="line">    getMenuInflater().inflate(R.menu.main, menu);</span><br><span class="line">    <span class="comment">// 通过getMenuInflater()方法能够得到MenuInflater对象</span></span><br><span class="line">    <span class="comment">// 再调用它的inflate()方法就可以给当前活动创建菜单了</span></span><br><span class="line">    <span class="comment">// inflate的两个参数:</span></span><br><span class="line">    <span class="comment">// 第一个: 指定通过哪一个资源文件来创建菜单</span></span><br><span class="line">    <span class="comment">// 第二个: 指定我们的菜单项将添加到哪一个Menu对象中</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">// 返回true: 表示允许创建的菜单显示出来</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>定义菜单响应事件：重写<strong>onOptionsItemSelected</strong>函数</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onOptionsItemSelected</span><span class="params">(<span class="meta">@NonNull</span> MenuItem item)</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> (item.getItemId())&#123; <span class="comment">// 判断点击的是哪一个菜单项</span></span><br><span class="line">        <span class="keyword">case</span>  R.id.add_item:</span><br><span class="line">            Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;You clicked Add&quot;</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> R.id.remove_item:</span><br><span class="line">            Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;You clicked Remove&quot;</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>  <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="销毁一个活动">2.1.6 销毁一个活动</h4>
<ol type="1">
<li><p>调用<strong>Activity</strong>类的<strong>finish()</strong>方法即可，修改<strong>Button</strong>监听器中的代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">button1.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">        Toast.makeText(FirstActivity.<span class="built_in">this</span>, <span class="string">&quot;You clicked Button &quot;</span>,Toast.LENGTH_SHORT).show();</span><br><span class="line">        finish();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="使用intent在活动之间穿梭">2.2 使用Intent在活动之间穿梭</h3>
<h4 id="使用显式intent">2.2.1 使用显式Intent</h4>
<ol type="1">
<li><p><strong>右击com.example.hw2_Activity包|新建|Activity|Empty
Activity</strong>，创建一个新活动</p></li>
<li><p>这次勾选<strong>Generate Layout
File</strong>，并将布局文件起名为<strong>second_layout</strong>，但是不要勾选<strong>Launcher
Activity</strong></p></li>
<li><p>进入布局文件，新建一个<strong>Button</strong>控件</p></li>
<li><p>注意：所有Activity都需要在<strong>AndroidManifest.xml</strong>中注册，这里系统已经帮我们注册好了</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--注册SecondActivity--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">activity</span></span></span><br><span class="line"><span class="tag">          <span class="attr">android:name</span>=<span class="string">&quot;.SecondActivity&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">android:exported</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--注册FirstActivity--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">activity</span></span></span><br><span class="line"><span class="tag">          <span class="attr">android:name</span>=<span class="string">&quot;.FirstActivity&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">android:exported</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">android:label</span>=<span class="string">&quot;This is the first activity&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.MAIN&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.LAUNCHER&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>使用显式Intent启动活动：修改<strong>FirstActivity.java</strong>中的按钮点击事件</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">button1.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">        <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(FirstActivity.<span class="built_in">this</span>, SecondActivity.class);</span><br><span class="line">        <span class="comment">// 第一个参数: 启动活动的上下文</span></span><br><span class="line">        <span class="comment">// 第二个参数: 目标活动</span></span><br><span class="line">        startActivity(intent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="使用隐式intent">2.2.2 使用隐式Intent</h4>
<ol type="1">
<li><p>相比于显式Intent，隐式Intent则含蓄了许多，它并不明确指出我们想要启动哪一个活动，而是指定了一系列更为抽象的action和category等信息，然后交由系统去分析这个Intent，并帮我们找出合适的活动去启动。</p></li>
<li><p>什么叫作合适的活动呢？简单来说就是可以响应我们这个隐式Intent的活动。</p></li>
<li><p>修改<strong>AndroidManifest.xml</strong>，让<strong>SecondActivity</strong>能够响应<strong>隐式Intent</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--注册SecondActivity--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">activity</span></span></span><br><span class="line"><span class="tag">          <span class="attr">android:name</span>=<span class="string">&quot;.SecondActivity&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">android:exported</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;com.example.hw2_activity.ACTION_START&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--指明当前活动可以响应com.example.hw2_activity.ACTION_START这个action--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.DEFAULT&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--指明当前活动能够响应的Intent中还可能带有的category--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--只有&lt;action&gt;和&lt;category&gt;同时匹配上Intent中指定的action和category时,这个活动才能响应该Intent--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>修改<strong>FirstActivity.java</strong>中的按钮点击事件</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">button1.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">        <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(<span class="string">&quot;com.example.hw2_activity.ACTION_START&quot;</span>);</span><br><span class="line">        intent.addCategory(<span class="string">&quot;com.example.hw2_activity.MY_CATEGORY&quot;</span>);</span><br><span class="line">        <span class="comment">// 每个Intent只能有一个Action, 但是可以有多个Category</span></span><br><span class="line">        <span class="comment">// 只有当Activity同时匹配上Action和所有的Category时, 才会响应Intent</span></span><br><span class="line">        startActivity(intent);</span><br><span class="line">        <span class="comment">// android.intent.category.DEFAULT是默认category</span></span><br><span class="line">        <span class="comment">// 在调用startActivity()方法时会自动将这个category添加到Intent中</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="更多隐式intent的用法">2.2.3 更多隐式Intent的用法</h4>
<ol type="1">
<li><p><strong>打开网页</strong>：修改<strong>FirstActivity.java</strong>中的按钮点击事件</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">button1.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">        <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(Intent.ACTION_VIEW);</span><br><span class="line">        <span class="comment">// Intent.ACTION_VIEW是Android系统内置的动作</span></span><br><span class="line">        <span class="comment">// 其常量值为android.intent.action.VIEW</span></span><br><span class="line">        intent.setData(Uri.parse(<span class="string">&quot;http://www.baidu.com&quot;</span>));</span><br><span class="line">        <span class="comment">// 使用Uri.parse()方法,将一个网址字符串解析成一个Uri对象</span></span><br><span class="line">        <span class="comment">// 调用Intent的setData()方法, 将这个Uri对象传递进去</span></span><br><span class="line">        startActivity(intent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li><p><strong>setData()</strong>方法：指定当前Intent正在操作的数据</p>
<ol type="1">
<li>与此对应,我们还可以在<strong>&lt; intent-filter
&gt;</strong>标签中再配置一个<strong>&lt; data
&gt;</strong>标签，用于更精确地指定当前活动能够响应什么类型的数据。<strong>&lt;
data &gt;</strong>标签中主要可以配置以下内容。
<ol type="1">
<li><strong>android:scheme</strong>：用于指定数据的协议部分，如上例中的http部分</li>
<li><strong>android:
host</strong>：用于指定数据的主机名部分,如上例中的www.baidu.com部分</li>
<li><strong>android:port</strong>：用于指定数据的端口部分，一般紧随在主机名之后</li>
<li><strong>android:path</strong>：用于指定主机名和端口之后的部分，如一段网址中跟在域名之后的内容</li>
<li><strong>android:mimeType</strong>：用于指定可以处理的数据类型，允许使用通配符的方式进行指定。</li>
</ol></li>
<li>只有<strong>&lt; data
&gt;</strong>标签中指定的内容和Intent中携带的Data完全一致时，当前活动才能够响应该Intent</li>
<li>不过一般在<strong>&lt; data &gt;</strong>标签中都不会指定过多的内容
<ol type="1">
<li>如上面浏览器示例中，其实只需要指定<strong>android:scheme为http</strong>，就可以响应所有的http协议的Intent了</li>
</ol></li>
</ol></li>
<li><p>写一个能够<strong>响应打开网页</strong>的活动</p>
<ol type="1">
<li>新建一个活动<strong>ThirdActivity</strong></li>
<li>修改<strong>AndroidManifest.xml</strong></li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;!-- 注册ThirdActivity --&gt;</span><br><span class="line">&lt;activity</span><br><span class="line">	android:name=<span class="string">&quot;.ThirdActivity&quot;</span></span><br><span class="line">	android:exported=<span class="string">&quot;true&quot;</span>&gt;</span><br><span class="line">	&lt;intent-filter&gt;</span><br><span class="line">		&lt;action android:name=<span class="string">&quot;android.intent.action.VIEW&quot;</span>/&gt;</span><br><span class="line">		&lt;category android:name=<span class="string">&quot;android.intent.category.DEFAULT&quot;</span>/&gt;</span><br><span class="line">		&lt;data android:scheme=<span class="string">&quot;http&quot;</span>/&gt;</span><br><span class="line">	&lt;/intent-filter&gt;</span><br><span class="line">&lt;/activity&gt;</span><br></pre></td></tr></table></figure></li>
<li><p><strong>拨打电话</strong>：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">button1.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">        <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(Intent.ACTION_DIAL);</span><br><span class="line">        intent.setData(Uri.parse(<span class="string">&quot;tel:10086&quot;</span>));</span><br><span class="line">        startActivity(intent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="向下一个活动传递数据">2.2.4 向下一个活动传递数据</h4>
<ol type="1">
<li><p>给出数据：<strong>putExtra()</strong>方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">button1.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> <span class="string">&quot;Hello SecondActivity&quot;</span>;</span><br><span class="line">        <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(FirstActivity.<span class="built_in">this</span>, SecondActivity.class);</span><br><span class="line">        intent.putExtra(<span class="string">&quot;extra_data&quot;</span>, data);</span><br><span class="line">        <span class="comment">// 第一个参数是键, 第二个参数是传递的数据</span></span><br><span class="line">        startActivity(intent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li><p>接收数据：<strong>getStringExtra()</strong>方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SecondActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.second_layout);</span><br><span class="line">        <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> getIntent();</span><br><span class="line">        <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> intent.getStringExtra(<span class="string">&quot;extra_data&quot;</span>);</span><br><span class="line">        <span class="comment">// 字符串型数据就是getStringExtra, 整型数据就是getIntExtra</span></span><br><span class="line">        Log.d(<span class="string">&quot;SecondActivity&quot;</span>, data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="返回数据给上一个活动">2.2.5 返回数据给上一个活动</h4>
<ol type="1">
<li><p>需要返回数据的启动新活动：<strong>startActivityForResult()</strong>方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">button1.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">        <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(FirstActivity.<span class="built_in">this</span>, SecondActivity.class);</span><br><span class="line">        startActivityForResult(intent, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li><p>返回数据：<strong>setResult()</strong>方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">button2.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">        <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>();</span><br><span class="line">        intent.putExtra(<span class="string">&quot;data_return&quot;</span>, <span class="string">&quot;Hello FirstActivity&quot;</span>);</span><br><span class="line">        setResult(RESULT_OK, intent);</span><br><span class="line">        <span class="comment">// 第一个参数: 向上一个活动返回处理结果, 一般只使用RESULT_OK/RESULT_CANCELED</span></span><br><span class="line">        <span class="comment">// 第二个参数: 带有数据的Intent</span></span><br><span class="line">        finish();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li><p>获取返回数据：<strong>onActivityResult()</strong>方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onActivityResult</span><span class="params">(<span class="type">int</span> requestCode, <span class="type">int</span> resultCode, <span class="meta">@Nullable</span> Intent data)</span> &#123;</span><br><span class="line">    <span class="comment">// requestCode: 启动新活动是传入的请求码</span></span><br><span class="line">    <span class="comment">// resultCode: 返回数据时传入的处理结果</span></span><br><span class="line">    <span class="comment">// data: 携带着返回数据的Intent</span></span><br><span class="line">    <span class="keyword">switch</span> (requestCode)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span>(resultCode == RESULT_OK)&#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">returnedData</span> <span class="operator">=</span> data.getStringExtra(<span class="string">&quot;data_return&quot;</span>);</span><br><span class="line">                Log.d(<span class="string">&quot;FirstActivity&quot;</span>, returnedData);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>按返回键返回：<strong>onBackPressed()</strong>方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onBackPressed</span><span class="params">()</span> &#123; <span class="comment">// 按返回键返回</span></span><br><span class="line">    <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>();</span><br><span class="line">    intent.putExtra(<span class="string">&quot;data_return&quot;</span>, <span class="string">&quot;Hello FirstActivity&quot;</span>);</span><br><span class="line">    setResult(RESULT_OK, intent);</span><br><span class="line">    finish();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="活动的生命周期">2.3 活动的生命周期</h3>
<h4 id="返回栈-back-stack">2.3.1 返回栈 Back Stack</h4>
<ol type="1">
<li>其实Android是使用任务(Task)来管理活动的，一个任务就是一组存放在栈里的活动的集合，这个栈也被称作返回栈(<strong>Back
Stack</strong>)</li>
<li>栈是一种后进先出的数据结构，在默认情况下，每当我们启动了一个新的活动，它会在返回栈中入栈，并处于栈顶的位置。而每当我们按下Back键或调用finish()方法去销毁一个活动时，处于栈顶的活动会出栈，这时前一个入栈的活动就会重新处于栈顶的位置</li>
<li>系统总是会显示处于栈顶的活动给用户</li>
</ol>
<h4 id="活动状态">2.3.2 活动状态</h4>
<ol type="1">
<li><strong>运行状态</strong>：活动位于返回栈栈顶</li>
<li><strong>暂停状态</strong>：活动不在栈顶，但是仍然可见</li>
<li><strong>停止状态</strong>：活动不在栈顶，且不可见</li>
<li><strong>销毁状态</strong>：活动不在返回栈中</li>
</ol>
<h4 id="活动的生命周期-1">2.3.3 活动的生命周期</h4>
<h5 id="对应的7个回调方法">2.3.3.1 对应的7个回调方法</h5>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830192712259.png" alt="image-20220830192712259" style="zoom:80%;" /></p>
<ol type="1">
<li><strong>onCreate()</strong>：它会在活动<strong>第一次被创建</strong>的时候调用。
<ol type="1">
<li>你应该在这个方法中完成活动的<strong>初始化操作</strong>，比如说加载布局、绑定事件等</li>
</ol></li>
<li><strong>onStart()</strong>：这个方法在活动由<strong>不可见变为可见</strong>的时候调用</li>
<li><strong>onResume()</strong>：这个方法在活动准备好和用户进行交互的时候调用。
<ol type="1">
<li>此时的活动一定<strong>位于返回栈的栈顶</strong>，并且处于运行状态</li>
</ol></li>
<li><strong>onPause()</strong>：这个方法在系统准备去<strong>启动或者恢复另一个活动</strong>的时候调用。
<ol type="1">
<li>我们通常会在这个方法中将一些消耗CPU的资源释放掉，以及保存一些关键数据</li>
<li>但这个方法的执行速度一定要快，不然会影响到新的栈顶活动的使用</li>
</ol></li>
<li><strong>onStop()</strong>：这个方法在活动<strong>完全不可见</strong>的时候调用。
<ol type="1">
<li>它和<strong>onPause()</strong>方法的主要区别在于，如果启动的新活动是一个对话框式的活动，那么<strong>onPause()</strong>方法会得到执行，而<strong>onStop()</strong>方法并不会执行</li>
</ol></li>
<li><strong>onDestroy()</strong>：这个方法在活动<strong>被销毁</strong>之前调用，之后活动的状态将变为销毁状态</li>
<li><strong>onRestart()</strong>：这个方法在活动由<strong>停止状态变为运行状态</strong>之前调用，也就是活动被重新启动了</li>
</ol>
<h5 id="将活动注册为对话框">2.3.3.2 将活动注册为对话框</h5>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span></span></span><br><span class="line"><span class="tag">	<span class="attr">android:name</span>=<span class="string">&quot;.DialogActivity&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">android:exported</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">android:theme</span>=<span class="string">&quot;@style/Theme.AppCompat.Dialog&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="活动被回收了怎么办">2.3.4 活动被回收了怎么办</h4>
<ol type="1">
<li><p>存储临时数据：<strong>onSaveInstanceState()</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onSaveInstanceState</span><span class="params">(<span class="meta">@NonNull</span> Bundle outState, <span class="meta">@NonNull</span> PersistableBundle outPersistentState)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.onSaveInstanceState(outState, outPersistentState);</span><br><span class="line">    <span class="type">String</span> <span class="variable">temoData</span> <span class="operator">=</span> <span class="string">&quot;Something you just Typed&quot;</span>;</span><br><span class="line">    outState.putString(<span class="string">&quot;data_key&quot;</span>, temoData);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>恢复临时数据：<strong>onCreate()</strong>中的<strong>savedInstanceState</strong>参数</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    Log.d(TAG,<span class="string">&quot;onCreate&quot;</span>);</span><br><span class="line">    setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(savedInstanceState != <span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">tempData</span> <span class="operator">=</span> savedInstanceState.getString(<span class="string">&quot;data_key&quot;</span>);</span><br><span class="line">        Log.d(TAG, tempData);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="活动的启动模式">2.4 活动的启动模式</h3>
<ol type="1">
<li>可以在<strong>AndroidManifest.xml</strong>中，通过给<strong>&lt;
activity
&gt;</strong>标签指定<strong>android:launchMode</strong>属性，来指定启动模式</li>
</ol>
<h4 id="standard">2.4.1 standard</h4>
<ol type="1">
<li>默认启动模式</li>
<li>不检查栈中有是否已有这个Activity，总会<strong>创建⼀个新Activity</strong>，并push到栈顶</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830195908952.png" alt="image-20220830195908952" style="zoom:80%;" /></p>
<h4 id="singletop">2.4.2 singleTop</h4>
<ol type="1">
<li><strong>检查栈顶</strong>判断是否需要新建Activity</li>
<li>⾮栈顶的元素不会检查，所以当FirstActivity不位于栈顶时，再次startActivity(FirstActivity)还会再创建⼀个FirstActivity</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830200014909.png" alt="image-20220830200014909" style="zoom:80%;" /></p>
<h4 id="singletask">2.4.3 singleTask</h4>
<ol type="1">
<li>每次启动该活动时系统⾸先会<strong>在返回栈中检查是否存在该Activity的实例</strong></li>
<li>如果发现已经存在则直接使⽤该实例，并把在这个Activity之上的所有Activity统统出栈</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830200117581.png" alt="image-20220830200117581" style="zoom:80%;" /></p>
<h4 id="singleinstance">2.4.4 singleInstance</h4>
<ol type="1">
<li><p>会<strong>启用一个新的返回栈</strong>来管理指定为<strong>singleInstance</strong>的<strong>Activity</strong></p></li>
<li><p>使⽤场景：跨进程（app）间的Activity实例共享，不管是哪个应⽤程序来访问这个Activity，都共⽤同⼀个返回栈</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830200531526.png" alt="image-20220830200531526" style="zoom:80%;" /></p></li>
</ol>
<h3 id="活动的最佳实践">2.5 活动的最佳实践</h3>
<h4 id="知晓当前是在哪一个活动">2.5.1 知晓当前是在哪一个活动</h4>
<ol type="1">
<li><p>首先，新建一个<strong>BaseActivity</strong>类，继承自<strong>AppCompatActivity</strong></p></li>
<li><p>重写<strong>OnCreate()</strong>方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BaseActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(<span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        Log.d(<span class="string">&quot;BaseActivity&quot;</span>, getClass().getSimpleName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>让<strong>BaseActivity</strong>称为<strong>hw2_activity</strong>项目中所有活动的父类</p>
<ol type="1">
<li>修改<strong>FirstActivity、SecondActivity、ThirdActivity</strong>，让他们不再继承于<strong>AppCompatActivity</strong>，而是继承自<strong>BaseActivity</strong></li>
</ol></li>
</ol>
<h4 id="随时随地退出程序">2.5.2 随时随地退出程序</h4>
<ol type="1">
<li><p>新建一个类<strong>ActivityCollector</strong>作为活动管理器</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ActivityCollector</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Activity&gt; activities = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">addActivity</span><span class="params">(Activity activity)</span>&#123;</span><br><span class="line">        activities.add(activity);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">removeActivity</span><span class="params">(Activity activity)</span>&#123;</span><br><span class="line">        activities.remove(activity);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">finishAll</span><span class="params">()</span>&#123;</span><br><span class="line">        Log.d(<span class="string">&quot;ActivityCollector&quot;</span>, <span class="string">&quot;finishAll&quot;</span>+activities.size());</span><br><span class="line">        <span class="keyword">for</span>(Activity activity : activities)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!activity.isFinishing())</span><br><span class="line">                activity.finish();</span><br><span class="line">        &#125;</span><br><span class="line">        activities.clear();</span><br><span class="line"></span><br><span class="line">        android.os.Process.killProcess(android.os.Process.myPid());</span><br><span class="line">        <span class="comment">// 只能杀掉当前进程</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>修改<strong>BaseActivity</strong>中的代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BaseActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(<span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        Log.d(<span class="string">&quot;BaseActivity&quot;</span>, getClass().getSimpleName());</span><br><span class="line"></span><br><span class="line">        ActivityCollector.addActivity(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onDestroy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onDestroy();</span><br><span class="line">        ActivityCollector.removeActivity(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>在<strong>ThirdActivity</strong>界面中点击按钮直接退出程序</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThirdActivity</span> <span class="keyword">extends</span> <span class="title class_">BaseActivity</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.third_layout);</span><br><span class="line"></span><br><span class="line">        <span class="type">Button</span> <span class="variable">button3</span> <span class="operator">=</span> (Button) findViewById(R.id.button3);</span><br><span class="line">        button3.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                Log.d(<span class="string">&quot;ThirdActivity&quot;</span>, <span class="string">&quot;onClick: &quot;</span>);</span><br><span class="line">                ActivityCollector.finishAll();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="启动进程的最佳写法">2.5.3 启动进程的最佳写法</h4>
<ol type="1">
<li><p>启动<strong>Secondary</strong>进程时，我们可能并不知道它需要哪些参数，要么去问负责这个活动的同学，要么自己去看代码</p></li>
<li><p>我们只需要在<strong>Secondary</strong>中封装一个方法<strong>actionStart</strong>，即可方便的告诉大家，<strong>Secondary</strong>启动时需要哪些参数</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SecondActivity</span> <span class="keyword">extends</span> <span class="title class_">BaseActivity</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">actionStart</span><span class="params">(Context context, String data1, String data2)</span>&#123;</span><br><span class="line">        <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(context, SecondActivity.class);</span><br><span class="line">        intent.putExtra(<span class="string">&quot;param1&quot;</span>, data1);</span><br><span class="line">        intent.putExtra(<span class="string">&quot;param2&quot;</span>, data2);</span><br><span class="line">        context.startActivity(intent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="第三章-软件也要拼脸蛋--ui开发的点点滴滴">第三章
软件也要拼脸蛋--UI开发的点点滴滴</h2>
<h3 id="控件与布局">3.1 控件与布局</h3>
<ol type="1">
<li>UI控件：<strong>TextView</strong>, <strong>ImageView</strong>,
<strong>Button</strong>, <strong>ProgressBar</strong></li>
<li>UI布局：<strong>LinearLayout</strong>,
<strong>RelativeLayout</strong>, <strong>FrameLayout</strong>,</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830204018378.png" alt="image-20220830204018378" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830204024868.png" alt="image-20220830204024868" style="zoom:80%;" /></p>
<h3 id="常用控件">3.2 常用控件</h3>
<h4 id="textview">3.2.1 TextView</h4>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830204858307.png"
alt="image-20220830204858307" />
<figcaption aria-hidden="true">image-20220830204858307</figcaption>
</figure>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830204911012.png" alt="image-20220830204911012" style="zoom:80%;" /></p>
<ol type="1">
<li><strong>layout_width</strong>：控件的宽</li>
<li><strong>layout_height</strong>：控件的⾼</li>
<li><strong>wrap_content</strong>：表示和⾃身内容⼀样的⻓度</li>
<li><strong>match_parent</strong>：表示和⽗组件⼀样的⻓度</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830204243973.png" alt="image-20220830204243973" style="zoom:80%;" /></p>
<h4 id="pxdpdpidensity-与-sp">3.2.2 px、dp、dpi、density 与 sp</h4>
<ol type="1">
<li><strong>px</strong>：pixel，1px代表屏幕上的⼀个物理像素点</li>
<li><strong>dpi</strong>：dots per
inch，对角线每英寸的像素点的个数；该值越大表示屏幕越清，<span
class="math inline">\(dpi=\frac{\sqrt{ {height}^2+{width}^2}
}{size}\)</span>。</li>
<li><strong>density</strong>：<span
class="math inline">\(density=\frac{dpi}{60}\)</span>。</li>
<li><strong>dp/dip</strong>：density-independent
pixel，设备无关像素，<span
class="math inline">\(dp=\frac{px}{density}\)</span>。</li>
<li><strong>sp</strong>：scale-independent pixel，与缩放⽆关的抽象像素
<ol type="1">
<li>与dp近似，但除了受屏幕密度影响外，还受到⽤户字体大小影响（正相关）</li>
</ol></li>
</ol>
<h4 id="edittext">3.2.3 EditText</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830204922564.png" alt="image-20220830204922564" style="zoom: 80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830204836168.png" alt="image-20220830204836168" style="zoom:80%;" /></p>
<ol type="1">
<li>监听输⼊内容变化：<strong>TextWatcher</strong></li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830205018365.png" alt="image-20220830205018365" style="zoom: 80%;" /></p>
<h4 id="imageview">3.2.4 ImageView</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830205158604.png" alt="image-20220830205158604" style="zoom:80%;" /></p>
<ol type="1">
<li><p>静态设置</p>
<ol type="1">
<li><strong>android:src</strong>：指定<strong>drawable</strong>(本地图片)或<strong>bitmap</strong>资源(网络图片)</li>
<li><strong>android:background</strong>：指定ImageView背景（如color）</li>
<li><strong>android:scaleType</strong>：设置图片如何缩放以适应ImageView大小；
<ol type="1">
<li>参数如center，centerCrop等</li>
</ol></li>
</ol></li>
<li><p>动态设置</p>
<ol type="1">
<li><p><strong>setImageResource</strong>：添加资源</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">mImageView.setImageResource(R.drawable.icon_search);</span><br></pre></td></tr></table></figure></li>
<li><p>解析成bitmap后，setRotate设置旋转等</p></li>
</ol></li>
<li><p><strong>svg</strong>和<strong>png</strong>相比有何优势</p>
<ol type="1">
<li>抗拉伸</li>
<li>适配分辨率友好</li>
<li>占⽤空间小</li>
</ol></li>
</ol>
<h4 id="dialogs自学内容">3.2.5 Dialogs(自学内容)</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830205419562.png" alt="image-20220830205419562" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830205454275.png" alt="image-20220830205454275" style="zoom:80%;" /></p>
<ol type="1">
<li>https://developer.android.com/guide/topics/ui/dialogs</li>
<li>如何生成，展示，隐藏⼀个Dialog？</li>
<li>如何⾃定义Dialog样式，添加Button和Listener？</li>
</ol>
<h3 id="基本布局">3.3 基本布局</h3>
<h4 id="linearlayout">3.3.1 LinearLayout</h4>
<ol type="1">
<li><p><strong>android:orientation</strong>：表示线性布局排列⽅向</p>
<ol type="1">
<li>可选<strong>vertical</strong>或<strong>horizontal</strong></li>
</ol></li>
<li><p><strong>android:layout_gravity</strong>：表示指定控件在layout中的对⻬⽅式</p>
<ol type="1">
<li><strong>center_vertical</strong>只在orientation=“<strong>horizontal</strong>”时⽣效</li>
<li><strong>center_horizontal</strong>只在orientation=“<strong>vertical</strong>”时⽣效</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830205626934.png" alt="image-20220830205626934" style="zoom:80%;" /></p></li>
<li><p><strong>android:layout_weight</strong>：使用<strong>比例</strong>的方式指定控件的大小</p>
<ol type="1">
<li>每个控件在排列⽅向上尺寸占比为：<strong>self weight / total
weight</strong></li>
<li>如下图两个View的weight都为1，则两个View的宽度与屏幕宽度⽐均为<span
class="math inline">\(\frac{1}{1+1}=\frac{1}{2}\)</span></li>
<li>两个View的layout_width的规范写法为0dp</li>
<li>如果⼀些控件未指定weight，则这些控件按指定width或height展示。其余指定weight的控件对剩余屏幕宽度或高度进行分割</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830210035726.png" alt="image-20220830210035726" style="zoom:80%;" /></p></li>
</ol>
<h4 id="relativelayout">3.3.2 RelativeLayout</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830210142687.png" alt="image-20220830210142687" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830210118803.png" alt="image-20220830210118803" style="zoom:80%;" /></p>
<h4 id="padding-与-margin">3.3.3 padding 与 margin</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830210223617.png" alt="image-20220830210223617" style="zoom:80%;" /></p>
<h4 id="framelayout自学内容">3.3.4 FrameLayout（自学内容）</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830210319103.png" alt="image-20220830210319103" style="zoom:80%;" /></p>
<h4 id="constraintlayout">3.3.5 ConstraintLayout</h4>
<ol type="1">
<li><p>对View A在水平和垂直两个方向上指定限制，每⼀方向上⾄少指定⼀个
限制，限制标的可以是其他View或父View</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830210417516.png" alt="image-20220830210417516" style="zoom:80%;" /></p></li>
<li><p>如果对ViewB同时添加了app:layout_constraintRight_toRightOf=“<span
class="citation" data-cites="id/viewA">@id/viewA</span>”和
app:layout_constraintLeft_toLeftOf=“<span class="citation"
data-cites="id/viewA">@id/viewA</span>”表示什么含义？</p></li>
<li><p>ConstraintLayout的使⽤场景（拓展）</p>
<ol type="1">
<li>N等分布局</li>
<li>角度布局</li>
<li>超长限制优化</li>
</ol>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">	implementation <span class="string">&quot;androidx.constraintlayout:constraintlayout:2.1.4&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="自定义控件">3.3.6 自定义控件</h4>
<ol type="1">
<li><p>可继承任意Android控件，在此基础上添加或重写功能</p></li>
<li><p>更好的封装</p>
<ol type="1">
<li><p>举例：六个可输入方格、选中框、光标等</p></li>
<li><p>⼀种实现：作为⼀个<strong>EditText</strong>，⾃定义<strong>View(SixWordEditText)</strong>继承<strong>EditText</strong></p>
<ol type="1">
<li><p><strong>Override
TextView</strong>的<strong>onDraw</strong>⽅法，绘制每个方格样式和⽂字</p></li>
<li><p><strong>TextWatcher</strong>监听<strong>afterTextChanged</strong></p></li>
<li><p><strong>SixWorkEdtiText</strong>在<strong>XML</strong>中引⽤</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">com.ss.meetx.roomui.widget.SixWordEditText</span></span></span><br><span class="line"><span class="tag">	<span class="attr">android:id</span>=<span class="string">&quot;@+id/accessCodeEditText&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol></li>
</ol></li>
<li><p>提高复用性</p>
<ol type="1">
<li><p>如何在XML中实现下面的UI？使⽤什么布局和控件？层级是怎样的？</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830211137204.png" alt="image-20220830211137204" style="zoom:80%;" /></p>
<ol type="1">
<li><p><strong>input_view.xml</strong></p></li>
<li><p>构造<strong>SearchTextLayout</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// constructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">SearchTextLayout</span><span class="params">(Context context, AttributeSet attrs)</span> &#123;</span><br><span class="line">	LayoutInflater.from(context).inflate(R.layout.input_view, <span class="built_in">this</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>引用<strong>SearchTextLayout</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">com.ss.meetx.roomui.widget.input.SearchTextLayout</span></span></span><br><span class="line"><span class="tag">	<span class="attr">android:id</span>=<span class="string">“@+id/inputViewSearch</span>&quot;</span></span><br><span class="line"><span class="tag">	<span class="attr">android:layout_width</span>=<span class="string">“0dp</span>&quot;</span></span><br><span class="line"><span class="tag">	<span class="attr">android:layout_height</span>=<span class="string">“52dp</span>&quot;/&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol></li>
</ol></li>
</ol>
<h3 id="recyclerview">3.4 RecyclerView</h3>
<h4 id="基本布局scrollview">3.4.1 基本布局：ScrollView</h4>
<ol type="1">
<li><p>滚动布局，默认垂直方向滑动，也⽀持水平方向滑动HorizontalScrollView</p></li>
<li><p>直接<strong>子View只能有⼀个</strong></p></li>
<li><p>如果⽤<strong>ScrollView</strong>实现右侧的滑动列表应该怎么做？</p></li>
<li><p>开发上有什么不便？性能上有什么弊端？</p>
<ol type="1">
<li>重复写n个View，动态添加View比较复杂</li>
<li>初始化时会将所有数据项全部加载出来，没有回收和复同；导致内存占用大和OOM</li>
<li>用户体验是加载速度慢，卡顿</li>
</ol></li>
</ol>
<h4 id="recyclerview-1">3.4.2 RecyclerView</h4>
<ol type="1">
<li><p>核心：<strong>View Holder</strong>，
<strong>Adapter</strong>，<strong>Recycler View</strong></p></li>
<li><p><strong>Item
Decorator</strong>：Item之间Divider（分割线）</p></li>
<li><p><strong>Item Animator</strong>：添加删除Item的动画</p></li>
</ol>
<h4 id="layoutmanager">3.4.3 LayoutManager</h4>
<ol type="1">
<li><p><strong>LinearLayoutManager</strong>(左图）</p>
<ol type="1">
<li>线性造型，类似ListView的功能</li>
<li>支持上下或左右滑动，每⼀行或⼀列上仅有⼀个item</li>
</ol></li>
<li><p><strong>GridLayoutManager</strong>(中图）</p>
<ol type="1">
<li>网格造型，每个item在滑动方向上的尺寸相同</li>
<li>可以通过setSpanSizeLookup和getSpanSize，指定条件（如item中text宽度，item的position等），来控制该item占几个位置（即每⼀行有几个item）</li>
</ol></li>
<li><p><strong>StaggeredGridLayoutManager</strong>(右图)</p>
<ol type="1">
<li>瀑布流造型，每个item的尺寸可不相同，错落式布局</li>
<li>在其constructor中可指定滑动方向和行数（或列数）</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830211927154.png" alt="image-20220830211927154" style="zoom:80%;" /></p></li>
<li><p><strong>自定义LayoutManager</strong>（拓展）</p>
<ol type="1">
<li>继承<strong>LayoutManager</strong>类</li>
<li>重写<strong>generateDefaultLayoutParams</strong>⽅法，直接返回⼀个⻓宽都为<strong>WRAP_CONTENT</strong>的<strong>LayoutParams</strong>即可；</li>
<li>重写<strong>onLayoutChildren</strong>⽅法，在这⾥⾯布局<strong>Items</strong>（显示出来）；具体包括分离和回收有效items（detachAndScrapAttachedViews），获取需要布局的items（可见的），再通过addView将这些item添加回去。然后对其测量
（measureChild）确定View的宽高，</li>
<li>使⽤<strong>layoutDecorated</strong>确定View摆放的位置，并设置跟随滑动放缩比例</li>
<li>重写<strong>canScrollHorizontally</strong>和<strong>canScrollVertically</strong>方法，使它⽀持⽔平或垂直滚动；</li>
<li>重写<strong>scrollHorizontallyBy</strong>和<strong>scrollVerticallyBy</strong>，并在这里处理滚动工作；</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830212145783.png" alt="image-20220830212145783" style="zoom:80%;" /></p></li>
</ol>
<h4 id="recyclerview使用示例">3.4.4 RecyclerView使用示例</h4>
<h5 id="添加依赖">3.4.4.1 添加依赖</h5>
<blockquote>
<ol type="1">
<li>在<strong>app/build.gradle</strong>中，添加<strong>RecyclerView</strong>的依赖</li>
</ol>
</blockquote>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">implementation <span class="string">&#x27;androidx.recyclerview:recyclerview:1.1.0&#x27;</span></span><br></pre></td></tr></table></figure>
<h5 id="添加相关内容表示recyclerview中每一个独立的item">3.4.4.2
添加相关内容，表示RecyclerView中每一个独立的item</h5>
<blockquote>
<ol type="1">
<li>创建<strong>Java</strong>类<strong>ItemData</strong>，表示每一个<strong>item</strong>存储的数据</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ItemData</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="keyword">private</span> String link;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ItemData</span><span class="params">(String title, String link)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.title = <span class="string">&quot;  &quot;</span> + title;</span><br><span class="line">        <span class="built_in">this</span>.link = link;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getTitle</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> title;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getLink</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> link;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<ol start="2" type="1">
<li>创建<strong>layout</strong>布局文件<strong>recyclerview_item.xml</strong>，表示每一个<strong>item</strong>的布局</li>
</ol>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;@drawable/text_view_shape&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/RecyclerView_Item&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginEnd</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:drawableBottom</span>=<span class="string">&quot;@drawable/text_view_shape&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fontFamily</span>=<span class="string">&quot;sans-serif-thin&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:maxLines</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;文章的标题&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textAlignment</span>=<span class="string">&quot;viewStart&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">&quot;#000000&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;24sp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textStyle</span>=<span class="string">&quot;bold&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:typeface</span>=<span class="string">&quot;sans&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<ol start="3" type="1">
<li>创建<strong>Java</strong>类<strong>MyViewHolder</strong>，用于存储每个<strong>item</strong>的控件，控件都有哪些，在<strong>recyclerview_item.xml</strong>中定义</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyViewHolder</span> <span class="keyword">extends</span> <span class="title class_">RecyclerView</span>.ViewHolder&#123;</span><br><span class="line">    <span class="keyword">public</span> TextView textView;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyViewHolder</span><span class="params">(View itemView)</span>&#123;</span><br><span class="line">        <span class="built_in">super</span>(itemView);</span><br><span class="line">        <span class="built_in">this</span>.textView = itemView.findViewById(R.id.recyclerview_item);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="添加recyclerview的adapter">3.4.4.3
添加RecyclerView的Adapter</h5>
<blockquote>
<ol type="1">
<li>创建<strong>Java</strong>类<strong>MyRecyclerViewAdapter</strong>，为<strong>RecyclerView</strong>控件的<strong>Adapter</strong>
<ol type="1">
<li>这个类继承自<strong>RecyclerView.Adapter&lt; MyViewHolder
&gt;</strong></li>
<li>这个类会重写<strong>View.OnClickListener</strong></li>
</ol></li>
<li>类中包含了<strong>Adapter</strong>所在的<strong>Context</strong>，每个<strong>item</strong>包含的数据
<ol type="1">
<li>这些是在构造函数中需要传入的</li>
</ol></li>
<li>创建一个方法<strong>setItem(int position, ItemData
item)</strong>，表示修改<strong>position</strong>地方的数据
<ol type="1">
<li>先修改<strong>itemList</strong>中的数据</li>
<li>然后调用<strong>this.notifyItemChanged(position)</strong>方法，修改<strong>item</strong>的控件</li>
</ol></li>
<li>重写多个方法，实现<strong>Adapter</strong>的功能
<ol type="1">
<li><strong>onCreateViewHolder()</strong>：<strong>item</strong>框创立时,
调用该方法
<ol type="1">
<li>根据<strong>item</strong>对应的<strong>layout</strong>文件<strong>recyclerview_item.xml</strong>，创建每个<strong>item</strong>对应的<strong>View</strong>视图</li>
<li>给<strong>View</strong>视图设置<strong>Listener</strong></li>
<li>从<strong>itemView</strong>中获取<strong>MyViewHolder</strong>并返回</li>
</ol></li>
<li><strong>onAttachedToRecyclerView()</strong>：将<strong>RecycleView</strong>附加到<strong>Adapter</strong>上时,
调用该方法
<ol type="1">
<li>设置当前<strong>Adapter</strong>负责的<strong>RecyclerView</strong></li>
</ol></li>
<li><strong>onDetachedFromRecyclerView()</strong>：将<strong>RecycleView</strong>从<strong>Adapter</strong>解除时,
调用该方法
<ol type="1">
<li>设置当前<strong>Adapter</strong>负责的<strong>RecyclerView</strong></li>
</ol></li>
<li><strong>onBindViewHolder()</strong>：<strong>item</strong>显示时,
调用该方法
<ol type="1">
<li>根据<strong>item</strong>的位置，设置当前<strong>item</strong>的每个组件的值</li>
</ol></li>
<li><strong>getItemCount()</strong>：<strong>item</strong>的数量</li>
</ol></li>
<li>重写<strong>onClick()</strong>方法，处理<strong>RecyclerView</strong>的点击事件
<ol type="1">
<li>添加自定义接口<strong>OnItemClickListener</strong>，处理<strong>item</strong>的点击事件
<ol type="1">
<li>需要实现的方法：<strong>void onItemClick(RecyclerView parent, View
view, int position, ItemData data);</strong></li>
</ol></li>
<li>通过<strong>recyclerView.getChildAdapterPosition()</strong>方法，获取当前点击的<strong>item</strong>的位置</li>
<li>执行具体实现的<strong>onItemClick()</strong>方法</li>
</ol></li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyRecyclerViewAdapter</span></span><br><span class="line">        <span class="keyword">extends</span> <span class="title class_">RecyclerView</span>.Adapter&lt;MyViewHolder&gt;</span><br><span class="line">        <span class="keyword">implements</span> <span class="title class_">View</span>.OnClickListener&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当前Activity/Fragment</span></span><br><span class="line">    <span class="keyword">private</span> Context context;</span><br><span class="line">    <span class="comment">// 每个item包含的数据</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;ItemData&gt; itemList;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 每个item的控件</span></span><br><span class="line">    <span class="keyword">private</span> View itemView;</span><br><span class="line">    <span class="comment">// 被附加到Adapter上的RecyclerView控件</span></span><br><span class="line">    <span class="keyword">private</span> RecyclerView recyclerView;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyRecyclerViewAdapter</span><span class="params">(Context context, List&lt;ItemData&gt; itemList)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.context = context;</span><br><span class="line">        <span class="built_in">this</span>.itemList = itemList;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setItem</span><span class="params">(<span class="type">int</span> position, ItemData item)</span>&#123;</span><br><span class="line">        itemList.set(position, item);</span><br><span class="line">        <span class="built_in">this</span>.notifyItemChanged(position);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// item框创立时, 调用该方法</span></span><br><span class="line">    <span class="meta">@NonNull</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> MyViewHolder <span class="title function_">onCreateViewHolder</span><span class="params">(<span class="meta">@NonNull</span> ViewGroup parent, <span class="type">int</span> viewType)</span> &#123;</span><br><span class="line">        <span class="comment">// 根据layout文件, 创建View视图</span></span><br><span class="line">        itemView = LayoutInflater.from(context).inflate(R.layout.recyclerview_item, parent, <span class="literal">false</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 给View视图设置Listener</span></span><br><span class="line">        itemView.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 从itemView中获取MyViewHolder并返回</span></span><br><span class="line">        <span class="type">MyViewHolder</span> <span class="variable">myViewHolder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyViewHolder</span>(itemView);</span><br><span class="line">        <span class="keyword">return</span> myViewHolder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将RecycleView附加到Adapter上时, 调用该方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAttachedToRecyclerView</span><span class="params">(<span class="meta">@NonNull</span> RecyclerView recyclerView)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onAttachedToRecyclerView(recyclerView);</span><br><span class="line">        <span class="built_in">this</span>.recyclerView = recyclerView;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将RecycleView从Adapter解除时, 调用该方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onDetachedFromRecyclerView</span><span class="params">(<span class="meta">@NonNull</span> RecyclerView recyclerView)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onDetachedFromRecyclerView(recyclerView);</span><br><span class="line">        <span class="built_in">this</span>.recyclerView = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// item显示时, 调用该方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onBindViewHolder</span><span class="params">(<span class="meta">@NonNull</span> MyViewHolder holder, <span class="type">int</span> position)</span> &#123;</span><br><span class="line">        <span class="comment">// 根据item位置的数据, 设置当前item的每个组件的值</span></span><br><span class="line">        <span class="type">ItemData</span> <span class="variable">data</span> <span class="operator">=</span> itemList.get(position);</span><br><span class="line">        holder.textView.setText(data.getTitle());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// item的数量</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getItemCount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> itemList.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在 RecyclerView 的 Adapter 中定义单击事件的回调接口</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">OnItemClickListener</span>&#123;</span><br><span class="line">        <span class="comment">//参数: 父组件, 当前单击的View, 单击的View的位置, 数据</span></span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">onItemClick</span><span class="params">(RecyclerView parent, View view, <span class="type">int</span> position, ItemData data)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> OnItemClickListener onItemClickListener;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setOnItemClickListener</span><span class="params">(OnItemClickListener onItemClickListener)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.onItemClickListener = onItemClickListener;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// RecyclerView被点击时, 调用该方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">        <span class="comment">//根据RecyclerView获得当前View的位置</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">position</span> <span class="operator">=</span> recyclerView.getChildAdapterPosition(view);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//程序执行到此，会去执行具体实现的onItemClick()方法</span></span><br><span class="line">        <span class="keyword">if</span>(onItemClickListener != <span class="literal">null</span>)&#123;</span><br><span class="line">            onItemClickListener.onItemClick(recyclerView, view, position, itemList.get(position));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="在activity中对recyclerview控件进行相关的设置">3.4.4.4
在Activity中对RecyclerView控件进行相关的设置</h5>
<blockquote>
<ol type="1">
<li>在<strong>onCreate()</strong>中调用自定义方法<strong>setRecyclerView()</strong></li>
<li>在<strong>setRecyclerView()</strong>中进行<strong>RecyclerView</strong>控件的初始化操作
<ol type="1">
<li>设置所有<strong>item</strong>的默认数据</li>
<li>设置<strong>RecyclerView</strong>控件的<strong>Adapter</strong></li>
<li>设置<strong>RecyclerView</strong>控件的<strong>LayoutManager</strong></li>
<li>设置<strong>RecyclerView</strong>控件的<strong>Adapter</strong>的点击事件响应方法<strong>OnItemClickListener()</strong></li>
</ol></li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">CONTENT_ACTIVITY_RequestCode</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> RecyclerView recyclerView;</span><br><span class="line">    <span class="keyword">private</span> MyRecyclerViewAdapter adapter;</span><br><span class="line">    <span class="keyword">private</span> LinearLayoutManager layoutManager;</span><br><span class="line">    <span class="keyword">private</span> List&lt;ItemData&gt; itemList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="comment">// 初始化界面的相关操作</span></span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.lab5_main_layout);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 初始化RecyclerView</span></span><br><span class="line">        networkResult = findViewById(R.id.recyclerView);</span><br><span class="line">        setRecyclerView();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化RecyclerView</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">setRecyclerView</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">// 设置recyclerView中所有item的数据</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">20</span>; i++)&#123;</span><br><span class="line">            <span class="type">ItemData</span> <span class="variable">data</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ItemData</span>(<span class="string">&quot;第 &quot;</span> + i +<span class="string">&quot; 篇文章标题为:&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">            itemList.add(data);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置Adapter</span></span><br><span class="line">        adapter = <span class="keyword">new</span> <span class="title class_">MyRecyclerViewAdapter</span>(<span class="built_in">this</span>, itemList);</span><br><span class="line">        recyclerView.setAdapter(adapter);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置LayoutManager</span></span><br><span class="line">        layoutManager = <span class="keyword">new</span> <span class="title class_">LinearLayoutManager</span>(<span class="built_in">this</span>);</span><br><span class="line">        layoutManager.setOrientation(RecyclerView.VERTICAL);</span><br><span class="line">        recyclerView.setLayoutManager(layoutManager);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置click事件响应</span></span><br><span class="line">        adapter.setOnItemClickListener(<span class="keyword">new</span> <span class="title class_">MyRecyclerViewAdapter</span>.OnItemClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onItemClick</span><span class="params">(RecyclerView parent, View view, <span class="type">int</span> position, ItemData data)</span> &#123;</span><br><span class="line">                <span class="comment">// 使用WebView Activity打开网页</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">urlString</span> <span class="operator">=</span> data.getLink();</span><br><span class="line">                <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(MainActivity.<span class="built_in">this</span>, WebViewActivity.class);</span><br><span class="line">                intent.putExtra(<span class="string">&quot;url&quot;</span>, urlString);</span><br><span class="line">                startActivity(intent);</span><br><span class="line">                </span><br><span class="line">                 <span class="comment">// 修改Adapter中的itemID处的文本</span></span><br><span class="line">                    adapter = (MyRecyclerViewAdapter) recyclerView.getAdapter();</span><br><span class="line">                    <span class="type">ItemData</span> <span class="variable">item</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ItemData</span>(<span class="string">&quot;item &quot;</span> + itemID + <span class="string">&quot; 已完成&quot;</span>);</span><br><span class="line">                    adapter.setItem(itemID, item);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="回收复用机制">3.4.5 回收复用机制</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220830212638148.png" alt="image-20220830212638148" style="zoom:80%;" /></p>
<h1 id="day3-ui进阶">Day3 UI进阶</h1>
<h2 id="一fragment">一、Fragment</h2>
<h3 id="fragment的基本用法和生命周期">1.1
Fragment的基本用法和生命周期</h3>
<h4 id="fragment的优点">1.1.1 Fragment的优点</h4>
<ol type="1">
<li>将Activity模块化，将功能分散到小的Fragment中</li>
<li>一个Activity可以有多个Fragment，一个Fragment也可以有多个Fragment</li>
<li>可以重用、灵活</li>
<li>相比View，带有声明周期的概念</li>
</ol>
<h4 id="静态添加fragment">1.1.2 静态添加Fragment</h4>
<ol type="1">
<li><p>定义<strong>fragment布局文件</strong>：<strong>fragment_hello_layout.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;@color/black&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--显示一行文字: Hello--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/tv_hello&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Hello&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;32sp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">&quot;@color/white&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>定义<strong>fragment类</strong>：<strong>HelloFragment.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloFragment</span> <span class="keyword">extends</span> <span class="title class_">Fragment</span> &#123;</span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(<span class="meta">@NonNull</span> LayoutInflater inflater, <span class="meta">@Nullable</span> ViewGroup container, <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> inflater.inflate(R.layout.fragment_hello_layout, container, <span class="literal">false</span>);</span><br><span class="line">        <span class="comment">// inflate方法的主要作用: 将xml转换成一个View对象, 用于动态的创建布局</span></span><br><span class="line">        <span class="comment">// 参数说明</span></span><br><span class="line">        <span class="comment">// 1.int resource:          布局的资源id</span></span><br><span class="line">        <span class="comment">// 2.ViewGroup root:        填充的根视图</span></span><br><span class="line">        <span class="comment">// 3.boolean attachToRoot:  是否将载入的视图绑定到根视图中</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>在 <strong>activity布局文件</strong>中嵌入
<strong>fragment</strong>：</p>
<p><strong>activity_main.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.MainActivity&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.fragment.app.FragmentContainerView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/fragment_hello&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;com.example.demo.HelloFragment&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;300dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;400dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>MainActivity.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="动态添加删除fragment">1.1.3 动态添加/删除Fragment</h4>
<ol type="1">
<li><p>在<strong>Activity布局文件</strong>中定义<strong>Fragment容器</strong>：<strong>activity_main.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.MainActivity&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.fragment.app.FragmentContainerView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/fragment_hello&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;com.example.demo.HelloFragment&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;300dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;400dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--Fragment容器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/fragment_container&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--后续实现跳转逻辑的一个Button--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/btn_replace&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;120dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginBottom</span>=<span class="string">&quot;40dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;bottom|center_horizontal&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Replace&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>定义⼀个新的<strong>MainFragment</strong>：</p>
<p><strong>fragment布局文件</strong>：<strong>fragment_main_layout.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;#66CCFF&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--设置背景色: android:background=&quot;#66CCFF&quot;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--显示一行文字: Replace success--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/tv_replace&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Replace success&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;32sp&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>fragment类</strong>：<strong>MainFragment.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainFragment</span> <span class="keyword">extends</span> <span class="title class_">Fragment</span> &#123;</span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(<span class="meta">@NonNull</span> LayoutInflater inflater, <span class="meta">@Nullable</span> ViewGroup container, <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> inflater.inflate(R.layout.fragment_main_layout, container, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>使用<strong>FragmentManager</strong>添加<strong>Fragment</strong>：<strong>MainActivity.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TAG</span> <span class="operator">=</span> <span class="string">&quot;MainActivity&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> Button mReplaceButton;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        mReplaceButton = findViewById(R.id.btn_replace);</span><br><span class="line">        mReplaceButton.setOnClickListener(v-&gt;&#123;</span><br><span class="line">            <span class="type">FragmentManager</span> <span class="variable">fragmentManager</span> <span class="operator">=</span> getSupportFragmentManager();</span><br><span class="line">            <span class="comment">// 获取一个系统提供的FragmentManager</span></span><br><span class="line"></span><br><span class="line">            fragmentManager.beginTransaction().commit()</span><br><span class="line"></span><br><span class="line">            fragmentManager.beginTransaction()</span><br><span class="line">                    .remove(fragmentManager.findFragmentById(R.id.fragment_hello))</span><br><span class="line">                    .add(R.id.fragment_container, <span class="keyword">new</span> <span class="title class_">MainFragment</span>())</span><br><span class="line">                    .commit();</span><br><span class="line">            <span class="comment">// FragmentManager使用事务机制管理所有的Fragment</span></span><br><span class="line">            <span class="comment">// .beginTransaction(): 开始事务, 返回类型为FragmentTransaction</span></span><br><span class="line">            <span class="comment">// .remove(Fragment): 移除一个Fragment, 返回类型为FragmentTransaction</span></span><br><span class="line">            <span class="comment">// .add(id, Fragment): 添加一个Fragment, 返回类型为FragmentTransaction</span></span><br><span class="line">            <span class="comment">// .commit(): 将当前执行的操作提交, 返回类型为int</span></span><br><span class="line"></span><br><span class="line">            mReplaceButton.setVisibility(View.GONE);</span><br><span class="line">            <span class="comment">// setVisibility(): 设置组件的是否可见</span></span><br><span class="line">            <span class="comment">// 有三个参数可供选择</span></span><br><span class="line">            <span class="comment">// VISIBLE:0  意思是可见的</span></span><br><span class="line">            <span class="comment">// INVISIBILITY:4 意思是不可见的，但还占着原来的空间</span></span><br><span class="line">            <span class="comment">// GONE:8  意思是不可见的，不占用原来的布局空间</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="fragment-生命周期">1.1.4 Fragment 生命周期</h4>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220831095802196.png"
alt="image-20220831095802196" />
<figcaption aria-hidden="true">image-20220831095802196</figcaption>
</figure>
<ol type="1">
<li><strong>onAttach/onDetach</strong>：Fragment与Activity绑定/解除绑定</li>
<li><strong>onCreate/onDestroy</strong>：进行与View无关的初始化才做</li>
<li><strong>onCreateView/onDestroyView</strong>：渲染出视图布局，进行与View有关的初始化才做</li>
<li><strong>onActivityCreated</strong>：宿主Activity执行onCreate后调用该方法</li>
<li><strong>onStart/onStop</strong>：可见/不可见</li>
<li><strong>onResume/onPause</strong>：可交互/不可交互</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220831100204861.png" alt="image-20220831100204861" style="zoom:80%;" /></p>
<h4 id="fragment添加到返回栈">1.1.5 Fragment添加到返回栈</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220831100403525.png" alt="image-20220831100403525" style="zoom:67%;" /></p>
<ol type="1">
<li><p><strong>addToBackStack</strong>：将新的Fragment添加至返回栈，<strong>MainActivity.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TAG</span> <span class="operator">=</span> <span class="string">&quot;MainActivity&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> Button mReplaceButton;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        mReplaceButton = findViewById(R.id.btn_replace);</span><br><span class="line">        mReplaceButton.setOnClickListener(v-&gt;&#123;</span><br><span class="line">            <span class="type">FragmentManager</span> <span class="variable">fragmentManager</span> <span class="operator">=</span> getSupportFragmentManager();</span><br><span class="line"></span><br><span class="line">            fragmentManager.beginTransaction()</span><br><span class="line">                            .add(R.id.fragment_container, <span class="keyword">new</span> <span class="title class_">MainFragment</span>())</span><br><span class="line">                            .addToBackStack(<span class="literal">null</span>)</span><br><span class="line">                            .commit();</span><br><span class="line">            <span class="comment">// .addToBackStack(String name): 将Fragment加入到回退栈</span></span><br><span class="line">            <span class="comment">// 是否使用 取决于 是否要在回退的时候显示上一个Fragment</span></span><br><span class="line"></span><br><span class="line">            mReplaceButton.setVisibility(View.GONE);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="结合-viewpager-创建多-tab-界">1.2 结合 ViewPager 创建多 Tab
界⾯</h3>
<h4 id="viewpager的作用">1.2.1 ViewPager的作用</h4>
<ol type="1">
<li>常用于实现<strong>可滑动的多个视图</strong></li>
<li>容器，类似于<strong>RecyclerView</strong></li>
<li>需要通过 <strong>Adapter</strong> 配置内容</li>
<li>内容⼀般通过 <strong>Fragment</strong> 实现</li>
<li>可配置 <strong>TabLayout</strong> 或三⽅库添加
<strong>Title</strong></li>
</ol>
<h4 id="viewpager-fragment">1.2.2 ViewPager + Fragment</h4>
<ol type="1">
<li><p>在<strong>布局xml</strong> 中添加<strong>ViewPager</strong>
：<strong>fragment_main_layout.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--线性布局的对齐方式: android:orientation--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--添加一个ViewPager2--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.viewpager2.widget.ViewPager2</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/view_pager_main&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>定义<strong>Fragment</strong></p>
<p><strong>fragment_view_animation.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--显示文本: values/string.xml中名为first_text的变量的值--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/tv_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;@string/first_text&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;28sp&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>fragment_object_animation.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;#34C724&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--显示文本: values/string.xml中名为second_text的变量的值--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/tv_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;@string/second_text&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;28sp&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>fragment_lottie_animation.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;#ff0000&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--显示文本: values/string.xml中名为third_text的变量的值--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/tv_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;@string/third_text&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;28sp&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>定义配置页面<strong>Fragment</strong>的<strong>Adapter</strong>：<strong>HelloFragmentViewPagerAdapter.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloFragmentViewPagerAdapter</span> <span class="keyword">extends</span> <span class="title class_">FragmentStateAdapter</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">FRAGMENTS_Count</span> <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">FRAGMENT_View_Animation</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">FRAGMENT_Object_Animation</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">FRAGMENT_Lottie_Animation</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HelloFragmentViewPagerAdapter</span><span class="params">(<span class="meta">@NonNull</span> Fragment fragment)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(fragment);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 根据position的值, 判断创建哪一个Fragment</span></span><br><span class="line">    <span class="meta">@NonNull</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Fragment <span class="title function_">createFragment</span><span class="params">(<span class="type">int</span> position)</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> (position)&#123;</span><br><span class="line">            <span class="keyword">case</span> FRAGMENT_View_Animation:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ViewAnimationFragment</span>();</span><br><span class="line">            <span class="keyword">case</span> FRAGMENT_Object_Animation:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ObjectAnimationFragment</span>();</span><br><span class="line">            <span class="keyword">case</span> FRAGMENT_Lottie_Animation:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">LottieAnimationFragment</span>();</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Fragment</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回当前ViewPager有多少个Fragment</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getItemCount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> FRAGMENTS_Count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>为<strong>ViewPager</strong>设置<strong>Adapter</strong>：<strong>MainFragment.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainFragment</span> <span class="keyword">extends</span> <span class="title class_">Fragment</span> &#123;</span><br><span class="line">    ViewPager2 mViewPager;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(<span class="meta">@NonNull</span> LayoutInflater inflater, <span class="meta">@Nullable</span> ViewGroup container, <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="type">View</span> <span class="variable">view</span> <span class="operator">=</span> inflater.inflate(R.layout.fragment_main_layout, container, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">        mViewPager = view.findViewById(R.id.view_pager_main);</span><br><span class="line">        mViewPager.setAdapter(<span class="keyword">new</span> <span class="title class_">HelloFragmentViewPagerAdapter</span>(<span class="built_in">this</span>));</span><br><span class="line">        <span class="keyword">return</span> view;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="viewpager-tablayout">1.2.3 ViewPager + TabLayout</h4>
<ol type="1">
<li><p>在<strong>布局 xml</strong> 中继续添加
<strong>TabLayout</strong>：<strong>fragment_main_layout.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--线性布局的对齐方式: android:orientation--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.google.android.material.tabs.TabLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/tab_layout&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;40dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:tabIndicatorColor</span>=<span class="string">&quot;@color/black&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:tabIndicatorHeight</span>=<span class="string">&quot;2dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:tabIndicatorFullWidth</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:tabIndicatorGravity</span>=<span class="string">&quot;bottom&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:tabGravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">View</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/divider&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;2dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:background</span>=<span class="string">&quot;#1A000000&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--添加一个ViewPager2--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.viewpager2.widget.ViewPager2</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/view_pager_main&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>在代码中<strong>对 ViewPager 和 TabLayout
建立关联</strong>：<strong>MainFragment.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainFragment</span> <span class="keyword">extends</span> <span class="title class_">Fragment</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TITLE_View_Animation</span> <span class="operator">=</span> <span class="string">&quot;视图动画&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TITLE_Object_Animation</span> <span class="operator">=</span> <span class="string">&quot;属性动画&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TITLE_Lottie_Animation</span> <span class="operator">=</span> <span class="string">&quot;Lottie动画&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String[] tabTitles = <span class="keyword">new</span> <span class="title class_">String</span>[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">private</span> ViewPager2 mViewPager;</span><br><span class="line">    <span class="keyword">private</span> TabLayout mTabLayout;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(<span class="meta">@NonNull</span> LayoutInflater inflater, <span class="meta">@Nullable</span> ViewGroup container, <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="type">View</span> <span class="variable">view</span> <span class="operator">=</span> inflater.inflate(R.layout.fragment_main_layout, container, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置ViewPager的Adapter</span></span><br><span class="line">        mViewPager = view.findViewById(R.id.view_pager_main);</span><br><span class="line">        mViewPager.setAdapter(<span class="keyword">new</span> <span class="title class_">HelloFragmentViewPagerAdapter</span>(<span class="built_in">this</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置标题</span></span><br><span class="line">        tabTitles[HelloFragmentViewPagerAdapter.FRAGMENT_View_Animation] = TITLE_View_Animation;</span><br><span class="line">        tabTitles[HelloFragmentViewPagerAdapter.FRAGMENT_Object_Animation] = TITLE_Object_Animation;</span><br><span class="line">        tabTitles[HelloFragmentViewPagerAdapter.FRAGMENT_Lottie_Animation] = TITLE_Lottie_Animation;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置TabLayout的监听器</span></span><br><span class="line">        mTabLayout = view.findViewById(R.id.tab_layout);</span><br><span class="line">        <span class="type">TabLayoutMediator</span> <span class="variable">tabLayoutMediator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TabLayoutMediator</span>(</span><br><span class="line">                mTabLayout,</span><br><span class="line">                mViewPager,</span><br><span class="line">                <span class="literal">true</span>,</span><br><span class="line">                <span class="literal">false</span>,</span><br><span class="line">                (tab, position) -&gt; tab.setText(tabTitles[position]));</span><br><span class="line">        tabLayoutMediator.attach();</span><br><span class="line">        <span class="keyword">return</span> view;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="fragmentactivity-之间的通信">1.3 Fragment/Activity
之间的通信</h3>
<ol type="1">
<li>构造 Fragment 时传递参数（setArguments/getArguments）</li>
<li>通过接口和回调</li>
</ol>
<h4 id="fragment与activity之间的通信">1.3.1
Fragment与Activity之间的通信</h4>
<h5 id="传参">1.3.1.1 传参</h5>
<ol type="1">
<li><p>在<strong>activity_main.xml</strong>中添加一个文本框，用于测试</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.MainActivity&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.fragment.app.FragmentContainerView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/fragment_hello&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;com.example.demo.HelloFragment&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;300dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;400dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--Fragment容器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/fragment_container&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--后续实现跳转逻辑的一个Button--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/btn_replace&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;120dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginBottom</span>=<span class="string">&quot;40dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;bottom|center_horizontal&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Replace&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--用于测试传参的文本框--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/tv_tabs_count&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_horizontal&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:visibility</span>=<span class="string">&quot;gone&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;32sp&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>通过传参为Fragment指定⼀个背景色：<strong>ViewAnimationFragment.java</strong></p>
<ol type="1">
<li><strong>Fragment</strong>中提供实例化自身对象的静态方法</li>
<li><strong>onCreate</strong>中处理传递的参数</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ViewAnimationFragment</span> <span class="keyword">extends</span> <span class="title class_">Fragment</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PARAM_Color</span> <span class="operator">=</span> <span class="string">&quot;param_color&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">mColor</span> <span class="operator">=</span> Color.WHITE;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ViewAnimationFragment</span><span class="params">()</span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ViewAnimationFragment <span class="title function_">newInstance</span><span class="params">(<span class="type">int</span> color)</span>&#123;</span><br><span class="line">        <span class="type">ViewAnimationFragment</span> <span class="variable">fragment</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ViewAnimationFragment</span>();</span><br><span class="line">        <span class="type">Bundle</span> <span class="variable">args</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bundle</span>();</span><br><span class="line">        args.putInt(PARAM_Color, color);</span><br><span class="line">        fragment.setArguments(args);</span><br><span class="line">        <span class="keyword">return</span> fragment;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(<span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        <span class="keyword">if</span> (getArguments() != <span class="literal">null</span>) &#123;</span><br><span class="line">            mColor = getArguments().getInt(PARAM_Color);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(<span class="meta">@NonNull</span> LayoutInflater inflater, <span class="meta">@Nullable</span> ViewGroup container, <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="type">View</span> <span class="variable">view</span> <span class="operator">=</span> inflater.inflate(R.layout.fragment_view_animation, container, <span class="literal">false</span>);</span><br><span class="line">        view.setBackgroundColor(mColor);</span><br><span class="line">        <span class="keyword">return</span> view;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h5 id="listener">1.3.1.2 Listener</h5>
<ol type="1">
<li><p><strong>宿主Activity</strong>通过<strong>Listener</strong>回调获取当前已创建的<strong>tab数量</strong>：<strong>MainFragment.java</strong>(省略部分见之前的MainFragment.java)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainFragment</span> <span class="keyword">extends</span> <span class="title class_">Fragment</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Fragment 中定义⼀个接⼝以及接⼝类型的成员变量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">MainFragmentListener</span> <span class="variable">mListener</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MainFragmentListener</span>&#123;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">onMultiTabsViewCreated</span><span class="params">(<span class="type">int</span> tabsCount)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// onAttach 中获取接⼝实例</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAttach</span><span class="params">(<span class="meta">@NonNull</span> Context context)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onAttach(context);</span><br><span class="line">        mListener = (MainFragmentListener) context;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(<span class="meta">@NonNull</span> LayoutInflater inflater, <span class="meta">@Nullable</span> ViewGroup container, <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="comment">// 创建view, 见之前的MainFragment...</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 按需调⽤改接⼝⽅法进⾏通信</span></span><br><span class="line">        <span class="keyword">if</span>(mListener != <span class="literal">null</span>)&#123;</span><br><span class="line">            mListener.onMultiTabsViewCreated(adapter.getItemCount());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> view;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p><strong>宿主Activity</strong>中实现接口方法，执行相关处理：<strong>MainActivity.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span></span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">MainFragment</span>.MainFragmentListener &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onMultiTabsViewCreated</span><span class="params">(<span class="type">int</span> tabsCount)</span> &#123;</span><br><span class="line">        <span class="type">TextView</span> <span class="variable">tv</span> <span class="operator">=</span> findViewById(R.id.tv_tabs_count);</span><br><span class="line">        tv.setText(tabsCount + <span class="string">&quot; tabs created&quot;</span>);</span><br><span class="line">        tv.setVisibility(View.VISIBLE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="master-detail自学">1.3.2 Master Detail(自学)</h4>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220831104220441.png"
alt="image-20220831104220441" />
<figcaption aria-hidden="true">image-20220831104220441</figcaption>
</figure>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220831104235895.png"
alt="image-20220831104235895" />
<figcaption aria-hidden="true">image-20220831104235895</figcaption>
</figure>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220831104243620.png"
alt="image-20220831104243620" />
<figcaption aria-hidden="true">image-20220831104243620</figcaption>
</figure>
<h3 id="总结">1.4 总结</h3>
<ol type="1">
<li>Fragment: 灵活，可重⽤，迷你 Activity</li>
<li>生命周期、静态/动态添加⽤法</li>
<li>ViewPager &amp; Fragment</li>
<li>和 Activity 通信：Argument、Listener</li>
</ol>
<h2 id="二animation">二、Animation</h2>
<h3 id="视图动画">2.1 视图动画</h3>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220831104443434.png"
alt="image-20220831104443434" />
<figcaption aria-hidden="true">image-20220831104443434</figcaption>
</figure>
<h4 id="示例">2.1.1 示例</h4>
<ol type="1">
<li><p>Java方式设置</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">ROTATE_Duration</span> <span class="operator">=</span> <span class="number">2000</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">ROTATE_Start_Degree</span> <span class="operator">=</span> <span class="number">0f</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">ROTATE_End_Degree</span> <span class="operator">=</span> <span class="number">360f</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">ROTATE_Pivot</span> <span class="operator">=</span> <span class="number">0.5f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">initAnimation</span><span class="params">()</span>&#123;</span><br><span class="line">    mRotateAnimation = <span class="keyword">new</span> <span class="title class_">RotateAnimation</span>(</span><br><span class="line">        ROTATE_Start_Degree, ROTATE_End_Degree,</span><br><span class="line">        Animation.RELATIVE_TO_SELF, ROTATE_Pivot, <span class="comment">//x轴旋转中心</span></span><br><span class="line">        Animation.RELATIVE_TO_SELF, ROTATE_Pivot  <span class="comment">//y轴旋转中心</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置动画的持续时间, 重复次数, 重复模式</span></span><br><span class="line">    mRotateAnimation.setDuration(ROTATE_Duration);</span><br><span class="line">    mRotateAnimation.setRepeatCount(Animation.INFINITE);</span><br><span class="line">    mRotateAnimation.setRepeatMode(Animation.REVERSE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置监听器</span></span><br><span class="line">    mRotateAnimation.setAnimationListener(<span class="keyword">new</span> <span class="title class_">Animation</span>.AnimationListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAnimationStart</span><span class="params">(Animation animation)</span> &#123;</span><br><span class="line">            Log.d(TAG, <span class="string">&quot;onAnimationStart&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAnimationEnd</span><span class="params">(Animation animation)</span> &#123;</span><br><span class="line">            Log.d(TAG, <span class="string">&quot;onAnimationEnd&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAnimationRepeat</span><span class="params">(Animation animation)</span> &#123;</span><br><span class="line">            Log.d(TAG, <span class="string">&quot;onAnimationRepeat&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>配合XML方式设置</p>
<p><strong>fragment_view_animation.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--显示一张图片--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/iv_robot&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;200dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;200dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:src</span>=<span class="string">&quot;@mipmap/ic_launcher_round&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>ViewAnimationFragment.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ViewAnimationFragment</span> <span class="keyword">extends</span> <span class="title class_">Fragment</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TAG</span> <span class="operator">=</span> <span class="string">&quot;ViewAnimationFragment&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PARAM_Color</span> <span class="operator">=</span> <span class="string">&quot;param_color&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">ROTATE_Duration</span> <span class="operator">=</span> <span class="number">2000</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">ROTATE_Start_Degree</span> <span class="operator">=</span> <span class="number">0f</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">ROTATE_End_Degree</span> <span class="operator">=</span> <span class="number">360f</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">ROTATE_Pivot</span> <span class="operator">=</span> <span class="number">0.5f</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">mColor</span> <span class="operator">=</span> Color.WHITE;</span><br><span class="line">    <span class="keyword">private</span> ImageView mRobot;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 动画部分: 旋转动画</span></span><br><span class="line">    <span class="keyword">private</span> RotateAnimation mRotateAnimation;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ViewAnimationFragment</span><span class="params">()</span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ViewAnimationFragment <span class="title function_">newInstance</span><span class="params">(<span class="type">int</span> color)</span>&#123;</span><br><span class="line">        <span class="type">ViewAnimationFragment</span> <span class="variable">fragment</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ViewAnimationFragment</span>();</span><br><span class="line">        <span class="type">Bundle</span> <span class="variable">args</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bundle</span>();</span><br><span class="line">        args.putInt(PARAM_Color, color);</span><br><span class="line">        fragment.setArguments(args);</span><br><span class="line">        <span class="keyword">return</span> fragment;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(<span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        <span class="type">Bundle</span> <span class="variable">args</span> <span class="operator">=</span> getArguments();</span><br><span class="line">        <span class="keyword">if</span>(args != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">givenColor</span> <span class="operator">=</span> args.getInt(PARAM_Color);</span><br><span class="line">            mColor = (givenColor != <span class="number">0</span>) ? givenColor : mColor;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(<span class="meta">@NonNull</span> LayoutInflater inflater, <span class="meta">@Nullable</span> ViewGroup container, <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="type">View</span> <span class="variable">view</span> <span class="operator">=</span> inflater.inflate(R.layout.fragment_view_animation, container, <span class="literal">false</span>);</span><br><span class="line">        view.setBackgroundColor(mColor);</span><br><span class="line">        mRobot = view.findViewById(R.id.iv_robot);</span><br><span class="line">        <span class="keyword">return</span> view;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onResume</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onResume();</span><br><span class="line">        <span class="comment">// 启动动画</span></span><br><span class="line">        initAnimation();</span><br><span class="line">        <span class="keyword">if</span>(mRobot != <span class="literal">null</span>)&#123;</span><br><span class="line">            mRobot.startAnimation(mRotateAnimation);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onPause</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onPause();</span><br><span class="line">        <span class="comment">// 动画不为空, 且动画已经启动, 则停止动画</span></span><br><span class="line">        <span class="keyword">if</span>(mRotateAnimation != <span class="literal">null</span> &amp;&amp; mRotateAnimation.hasStarted())&#123;</span><br><span class="line">            mRotateAnimation.cancel();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">initAnimation</span><span class="params">()</span>&#123;</span><br><span class="line">        mRotateAnimation = <span class="keyword">new</span> <span class="title class_">RotateAnimation</span>(</span><br><span class="line">                ROTATE_Start_Degree, ROTATE_End_Degree,</span><br><span class="line">                Animation.RELATIVE_TO_SELF, ROTATE_Pivot, <span class="comment">//x轴旋转中心</span></span><br><span class="line">                Animation.RELATIVE_TO_SELF, ROTATE_Pivot  <span class="comment">//y轴旋转中心</span></span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置动画的持续时间, 重复次数, 重复模式</span></span><br><span class="line">        mRotateAnimation.setDuration(ROTATE_Duration);</span><br><span class="line">        mRotateAnimation.setRepeatCount(Animation.INFINITE);</span><br><span class="line">        mRotateAnimation.setRepeatMode(Animation.REVERSE);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置监听器</span></span><br><span class="line">        mRotateAnimation.setAnimationListener(<span class="keyword">new</span> <span class="title class_">Animation</span>.AnimationListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAnimationStart</span><span class="params">(Animation animation)</span> &#123;</span><br><span class="line">                Log.d(TAG, <span class="string">&quot;onAnimationStart&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAnimationEnd</span><span class="params">(Animation animation)</span> &#123;</span><br><span class="line">                Log.d(TAG, <span class="string">&quot;onAnimationEnd&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAnimationRepeat</span><span class="params">(Animation animation)</span> &#123;</span><br><span class="line">                Log.d(TAG, <span class="string">&quot;onAnimationRepeat&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="视图动画的属性">2.1.2 视图动画的属性</h4>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220831105228934.png"
alt="image-20220831105228934" />
<figcaption aria-hidden="true">image-20220831105228934</figcaption>
</figure>
<h3 id="属性动画">2.2 属性动画</h3>
<h4 id="属性动画-vs-视图动画">2.2.1 属性动画 vs 视图动画</h4>
<ol type="1">
<li>属性动画：<strong>android.animation</strong>
<ol type="1">
<li>基于属性的动画</li>
<li>⼀切可以连续变化的属性都是动画的元素</li>
<li>实现⼀种复杂动画，就是将动画拆解成不同属性组合的过程</li>
</ol></li>
<li>视图动画：<strong>android.view.animation</strong>
<ol type="1">
<li>只能对 View 做动画</li>
<li>只能对 View 的某些绘制属性做动画</li>
<li>只是视觉效果</li>
</ol></li>
</ol>
<h4 id="属性动画的角色构成">2.2.2 属性动画的角色构成</h4>
<ol type="1">
<li><strong>Property</strong>：alpha, scaleX, scaleY, rotation,
translationX, translationY</li>
<li><strong>参数</strong>：StartValue, EndValue, Duration</li>
<li><strong>RepeatCount</strong>：number, infinite</li>
<li><strong>RepeatMode</strong>：restart, reverse</li>
<li><strong>TypeEvaluator</strong>：IntEvaluator, ArgbEvaluator</li>
<li><strong>Interpolator</strong>：linear/accelerate/decelerate</li>
</ol>
<h4 id="animator单个属性动画">2.2.3 Animator：单个属性动画</h4>
<h5 id="fragment_object_animation.xml">2.2.3.1
fragment_object_animation.xml</h5>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;#34C724&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--显示一张图片--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/iv_robot&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;200dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;200dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:src</span>=<span class="string">&quot;@mipmap/ic_launcher_round&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="objectanimationfragment.java">2.2.3.2
ObjectAnimationFragment.java</h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ObjectAnimationFragment</span> <span class="keyword">extends</span> <span class="title class_">Fragment</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PARAM_Color</span> <span class="operator">=</span> <span class="string">&quot;param_color&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">mColor</span> <span class="operator">=</span> Color.WHITE;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ImageView mRobot;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 属性动画类</span></span><br><span class="line">    <span class="keyword">private</span> ObjectAnimator mAnimator;</span><br><span class="line">    <span class="comment">// 当前播放的时哪一个动画</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">mAnimationType</span> <span class="operator">=</span> ALPHA_Animation_Type;</span><br><span class="line">    <span class="comment">// 每个动画的重复次数, 持续时间</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">ANIMATION_Repeat_Count</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">ANIMATION_Duration</span> <span class="operator">=</span> <span class="number">2000</span>;</span><br><span class="line">    <span class="comment">// 透明度动画</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">ALPHA_Animation_Type</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">ALPHA_Start</span> <span class="operator">=</span> <span class="number">1f</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">ALPHA_End</span> <span class="operator">=</span> <span class="number">0f</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ObjectAnimationFragment</span><span class="params">()</span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ObjectAnimationFragment加载视图时调用</span></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(<span class="meta">@NonNull</span> LayoutInflater inflater, <span class="meta">@Nullable</span> ViewGroup container, <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="type">View</span> <span class="variable">view</span> <span class="operator">=</span> inflater.inflate(R.layout.fragment_view_animation, container, <span class="literal">false</span>);</span><br><span class="line">        mRobot = view.findViewById(R.id.iv_robot);</span><br><span class="line">        <span class="keyword">return</span> view;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ObjectAnimationFragment可交互时调用</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onResume</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onResume();</span><br><span class="line">        startAnimation();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 创建动画类,并开始动画</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">startAnimation</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">// 如果图片不存在, 则直接返回</span></span><br><span class="line">        <span class="keyword">if</span>(mRobot == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line">        initAlphaAnimation();</span><br><span class="line">        mAnimator.start();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 初始化动画类</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">initAlphaAnimation</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">// 设置属性动画的相关参数</span></span><br><span class="line">        mAnimator = ObjectAnimator.ofFloat(</span><br><span class="line">                mRobot, <span class="string">&quot;alpha&quot;</span>,</span><br><span class="line">                ALPHA_Start, ALPHA_End, ALPHA_Start);</span><br><span class="line"></span><br><span class="line">        mAnimator.setDuration(ANIMATION_Duration);</span><br><span class="line">        mAnimator.setRepeatCount(ANIMATION_Repeat_Count);</span><br><span class="line">        mAnimator.setRepeatMode(ValueAnimator.RESTART);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ViewAnimationFragment不可交互时调用</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onPause</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onPause();</span><br><span class="line">        cancelAnimation();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 将所有动画类删除</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">cancelAnimation</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">// 动画不为空, 且动画已经启动, 则停止动画</span></span><br><span class="line">        <span class="keyword">if</span>(mAnimator != <span class="literal">null</span> &amp;&amp; mAnimator.isRunning())&#123;</span><br><span class="line">            mAnimator.cancel();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="animatorset多个属性动画之间的切换">2.2.4
AnimatorSet：多个属性动画之间的切换</h4>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ObjectAnimationFragment</span> <span class="keyword">extends</span> <span class="title class_">Fragment</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PARAM_Color</span> <span class="operator">=</span> <span class="string">&quot;param_color&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">mColor</span> <span class="operator">=</span> Color.WHITE;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ImageView mRobot;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 属性动画类</span></span><br><span class="line">    <span class="keyword">private</span> AnimatorSet mAnimatorSet;</span><br><span class="line">    <span class="comment">// 当前播放的时哪一个动画</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">mAnimationType</span> <span class="operator">=</span> ROTATE_Animation_Type;</span><br><span class="line">    <span class="comment">// 每个动画的重复次数, 持续时间</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">ANIMATION_Repeat_Count</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">ANIMATION_Duration</span> <span class="operator">=</span> <span class="number">2000</span>;</span><br><span class="line">    <span class="comment">// 透明度动画</span></span><br><span class="line">    <span class="keyword">private</span> ObjectAnimator mAlphaAnimator;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">ALPHA_Animation_Type</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">ALPHA_Start</span> <span class="operator">=</span> <span class="number">1f</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">ALPHA_End</span> <span class="operator">=</span> <span class="number">0f</span>;</span><br><span class="line">    <span class="comment">// 旋转动画</span></span><br><span class="line">    <span class="keyword">private</span> ObjectAnimator mRotateAnimator;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">ROTATE_Animation_Type</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">ROTATE_Start_Degree</span> <span class="operator">=</span> <span class="number">0f</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">ROTATE_End_Degree</span> <span class="operator">=</span> <span class="number">360f</span>;</span><br><span class="line">    <span class="comment">// 移动动画</span></span><br><span class="line">    <span class="keyword">private</span> ObjectAnimator mTranslateXAnimator;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">TRANSLATE_Animation_Type</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">TRANSLATE_XDelta_Start</span> <span class="operator">=</span> <span class="number">0f</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">TRANSLATE_XDelta_End</span> <span class="operator">=</span> <span class="number">100f</span>;</span><br><span class="line">    <span class="comment">// 缩放视图动画</span></span><br><span class="line">    <span class="keyword">private</span> ObjectAnimator mScaleXAnimator;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SCALE_Animation_Type</span> <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">SCALE_X_Start</span> <span class="operator">=</span> <span class="number">1f</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">SCALE_X_End</span> <span class="operator">=</span> <span class="number">1.5f</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ObjectAnimationFragment</span><span class="params">()</span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ObjectAnimationFragment加载视图时调用</span></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(<span class="meta">@NonNull</span> LayoutInflater inflater, <span class="meta">@Nullable</span> ViewGroup container, <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="type">View</span> <span class="variable">view</span> <span class="operator">=</span> inflater.inflate(R.layout.fragment_view_animation, container, <span class="literal">false</span>);</span><br><span class="line">        mRobot = view.findViewById(R.id.iv_robot);</span><br><span class="line">        <span class="keyword">return</span> view;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ObjectAnimationFragment可交互时调用</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onResume</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onResume();</span><br><span class="line">        startAnimation();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 创建AnimatorSet,并开始动画</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">startAnimation</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">// 如果图片不存在, 则直接返回</span></span><br><span class="line">        <span class="keyword">if</span>(mRobot == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="comment">// 创建动画类</span></span><br><span class="line">        initAlphaAnimation();</span><br><span class="line">        initRotateAnimation();</span><br><span class="line">        initTranslateXAnimation();</span><br><span class="line">        initScaleXAnimation();</span><br><span class="line">        <span class="comment">// 创建AnimatorSet</span></span><br><span class="line">        mAnimatorSet = <span class="keyword">new</span> <span class="title class_">AnimatorSet</span>();</span><br><span class="line">        mAnimatorSet.playSequentially(mAlphaAnimator, mRotateAnimator, mTranslateXAnimator, mScaleXAnimator);</span><br><span class="line">        mAnimatorSet.start();</span><br><span class="line">        mAnimatorSet.addListener(<span class="keyword">new</span> <span class="title class_">Animator</span>.AnimatorListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAnimationStart</span><span class="params">(Animator animator)</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAnimationEnd</span><span class="params">(Animator animator)</span> &#123;</span><br><span class="line">                <span class="comment">// 动画序列结束后, 重新开始播放动画序列</span></span><br><span class="line">                mAnimatorSet.start();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAnimationCancel</span><span class="params">(Animator animator)</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAnimationRepeat</span><span class="params">(Animator animator)</span> &#123; &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 初始化动画类</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">initAlphaAnimation</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">// 设置属性动画的相关参数</span></span><br><span class="line">        mAlphaAnimator = ObjectAnimator.ofFloat(</span><br><span class="line">                mRobot, <span class="string">&quot;alpha&quot;</span>,</span><br><span class="line">                ALPHA_Start, ALPHA_End, ALPHA_Start);</span><br><span class="line"></span><br><span class="line">        mAlphaAnimator.setDuration(ANIMATION_Duration);</span><br><span class="line">        mAlphaAnimator.setRepeatCount(ANIMATION_Repeat_Count);</span><br><span class="line">        mAlphaAnimator.setRepeatMode(ValueAnimator.RESTART);</span><br><span class="line">        mAlphaAnimator.setInterpolator(<span class="keyword">new</span> <span class="title class_">LinearInterpolator</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">initRotateAnimation</span><span class="params">()</span>&#123;</span><br><span class="line">        mRotateAnimator = ObjectAnimator.ofFloat(</span><br><span class="line">                mRobot, <span class="string">&quot;rotation&quot;</span>,</span><br><span class="line">                ROTATE_Start_Degree, ROTATE_End_Degree, ROTATE_Start_Degree);</span><br><span class="line"></span><br><span class="line">        mRotateAnimator.setDuration(ANIMATION_Duration);</span><br><span class="line">        mRotateAnimator.setRepeatCount(ANIMATION_Repeat_Count);</span><br><span class="line">        mRotateAnimator.setRepeatMode(ValueAnimator.RESTART);</span><br><span class="line">        mRotateAnimator.setInterpolator(<span class="keyword">new</span> <span class="title class_">LinearInterpolator</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">initTranslateXAnimation</span><span class="params">()</span>&#123;</span><br><span class="line">        mTranslateXAnimator = ObjectAnimator.ofFloat(</span><br><span class="line">                mRobot, <span class="string">&quot;translationX&quot;</span>,</span><br><span class="line">                TRANSLATE_XDelta_Start, TRANSLATE_XDelta_End, TRANSLATE_XDelta_Start);</span><br><span class="line"></span><br><span class="line">        mTranslateXAnimator.setDuration(ANIMATION_Duration);</span><br><span class="line">        mTranslateXAnimator.setRepeatCount(ANIMATION_Repeat_Count);</span><br><span class="line">        mTranslateXAnimator.setRepeatMode(ValueAnimator.RESTART);</span><br><span class="line">        mTranslateXAnimator.setInterpolator(<span class="keyword">new</span> <span class="title class_">LinearInterpolator</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">initScaleXAnimation</span><span class="params">()</span>&#123;</span><br><span class="line">        mScaleXAnimator = ObjectAnimator.ofFloat(</span><br><span class="line">                mRobot, <span class="string">&quot;scaleX&quot;</span>,</span><br><span class="line">                SCALE_X_Start, SCALE_X_End, SCALE_X_Start);</span><br><span class="line"></span><br><span class="line">        mScaleXAnimator.setDuration(ANIMATION_Duration);</span><br><span class="line">        mScaleXAnimator.setRepeatCount(ANIMATION_Repeat_Count);</span><br><span class="line">        mScaleXAnimator.setRepeatMode(ValueAnimator.RESTART);</span><br><span class="line">        mScaleXAnimator.setInterpolator(<span class="keyword">new</span> <span class="title class_">LinearInterpolator</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ViewAnimationFragment不可交互时调用</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onPause</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onPause();</span><br><span class="line">        cancelAnimation();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 将所有动画类删除</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">cancelAnimation</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">// 动画不为空, 且动画已经启动, 则停止动画</span></span><br><span class="line">        mAnimatorSet.cancel();</span><br><span class="line">        <span class="keyword">if</span>(mAlphaAnimator != <span class="literal">null</span> &amp;&amp; mAlphaAnimator.isRunning())&#123;</span><br><span class="line">            mAlphaAnimator.cancel();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(mRotateAnimator != <span class="literal">null</span> &amp;&amp; mRotateAnimator.isRunning())&#123;</span><br><span class="line">            mRotateAnimator.cancel();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(mTranslateXAnimator != <span class="literal">null</span> &amp;&amp; mTranslateXAnimator.isRunning())&#123;</span><br><span class="line">            mTranslateXAnimator.cancel();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(mScaleXAnimator != <span class="literal">null</span> &amp;&amp; mScaleXAnimator.isRunning())&#123;</span><br><span class="line">            mScaleXAnimator.cancel();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220831105922891.png"
alt="image-20220831105922891" />
<figcaption aria-hidden="true">image-20220831105922891</figcaption>
</figure>
<h4 id="特点xml语法">2.2.5 特点，xml语法</h4>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220831110102106.png"
alt="image-20220831110102106" />
<figcaption aria-hidden="true">image-20220831110102106</figcaption>
</figure>
<h4 id="属性动画核心---valueanimator">2.2.6 属性动画核心 -
ValueAnimator</h4>
<ol type="1">
<li>控制某个数值，在某个时间内，在某个区间内进行规律变化</li>
</ol>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220831110150134.png"
alt="image-20220831110150134" />
<figcaption aria-hidden="true">image-20220831110150134</figcaption>
</figure>
<h4 id="属性动画原理">2.2.7 属性动画原理</h4>
<ol type="1">
<li><p>插值器：决定变化的规律</p></li>
<li><p>估值器：决定变化的具体数值</p>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220831110445532.png"
alt="image-20220831110445532" />
<figcaption aria-hidden="true">image-20220831110445532</figcaption>
</figure></li>
<li><p>常用系统内置插值器</p>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220831110540996.png"
alt="image-20220831110540996" />
<figcaption aria-hidden="true">image-20220831110540996</figcaption>
</figure></li>
</ol>
<h4 id="属性动画---注意">2.2.8 属性动画 - 注意</h4>
<ol type="1">
<li>使用ObjectAnimator 时，⽬标属性必须同时具备getter()及setter()
⽅法</li>
<li>ObjectAnimator
操作对象宿主⻚⾯退出前台或销毁时，需保证动画任务得到妥善处理，防⽌内存泄漏</li>
</ol>
<h4 id="属性动画---自定义属性">2.2.9 属性动画 - 自定义属性</h4>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220831110723890.png"
alt="image-20220831110723890" />
<figcaption aria-hidden="true">image-20220831110723890</figcaption>
</figure>
<h3 id="activity-切换动画">2.3 Activity 切换动画</h3>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220831110751260.png"
alt="image-20220831110751260" />
<figcaption aria-hidden="true">image-20220831110751260</figcaption>
</figure>
<h4 id="示例-fadeinout">2.3.1 示例 FadeInOut</h4>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220831110823317.png"
alt="image-20220831110823317" />
<figcaption aria-hidden="true">image-20220831110823317</figcaption>
</figure>
<h3 id="逐帧动画drawable-动画">2.4 逐帧动画/Drawable 动画</h3>
<ol type="1">
<li>逐帧动画可以被当作⼀种特殊的drawable对象</li>
<li>逐帧动画会按次序播放⼀系列图⽚</li>
<li>逐帧动画会⼀次性将所有图⽚加载到内存中，会有OOM⻛险</li>
</ol>
<h4 id="示例-animationdrawable">2.4.1 示例 AnimationDrawable</h4>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220831110933304.png"
alt="image-20220831110933304" />
<figcaption aria-hidden="true">image-20220831110933304</figcaption>
</figure>
<h3 id="lottie">2.5 Lottie</h3>
<ol type="1">
<li>airbnb公司的开源库</li>
<li>可以直接导入AE制作的动画素材</li>
<li>本质是将所有动画元素抽象成绘制属性</li>
</ol>
<h4 id="示例-1">2.5.1 示例</h4>
<ol type="1">
<li><p>在<strong>app/build.gradle</strong>中，添加依赖</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">	implementation <span class="string">&#x27;com.airbnb.android:lottie:3.4.2&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>添加资源<strong>raw/lottie_raw_rocket.json</strong></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220831173539488.png" alt="image-20220831173539488" style="zoom:80%;" /></p></li>
<li><p>修改<strong>fragment_lottie_animation.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;#ff0000&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.airbnb.lottie.LottieAnimationView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/lottieView&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;200dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;200dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:lottie_rawRes</span>=<span class="string">&quot;@raw/lottie_raw_rocket&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:lottie_autoPlay</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:lottie_loop</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>修改<strong>LottieAnimationFragment.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LottieAnimationFragment</span> <span class="keyword">extends</span> <span class="title class_">Fragment</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PARAM_Color</span> <span class="operator">=</span> <span class="string">&quot;param_color&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LottieAnimationFragment</span><span class="params">()</span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(<span class="meta">@NonNull</span> LayoutInflater inflater, <span class="meta">@Nullable</span> ViewGroup container, <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> inflater.inflate(R.layout.fragment_lottie_animation, container, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="day4-复杂应用组件">Day4 复杂应用组件</h1>
<h2 id="一进程与线程">一、进程与线程</h2>
<h3 id="进程线程">1.1 进程、线程</h3>
<ol type="1">
<li>进程：资源分配的最小单位 ==&gt; 一个软件
<ol type="1">
<li>如一辆列车</li>
</ol></li>
<li>线程：CPU调度的最小单位 ==&gt; 一个软件的各个功能
<ol type="1">
<li>如一辆列车的列车长</li>
</ol></li>
<li>主要区别：
<ol type="1">
<li>一个进程可以有多个线程</li>
<li>同一个进程的多个线程，共享进程的资源</li>
</ol></li>
</ol>
<h3 id="android中的主线程">1.2 Android中的主线程</h3>
<ol type="1">
<li>启动应用时，系统会为该应用创建⼀个称为“main”（主线程）的执行线程。这个线程负责所有和UI界⾯有关的显示、以及响应UI事件监听任务，因此又称座UI线程。</li>
<li>划重点：所有跟<strong>ui相关的操作</strong>都必须放在<strong>主线程</strong></li>
</ol>
<h3 id="anr-拓展">1.3 ANR 拓展</h3>
<p><strong>ANR</strong>：Application Not Responding</p>
<ol type="1">
<li>程序中所有的组件都会运行在UI线程中，所以必须保证该线程的⼯作效率</li>
<li>UI线程⼀旦出现问题，就会降低⽤户体验</li>
<li>如在UI线程中进行耗时操作，如下载文件、查询数据库等就会阻塞UI线程，长时间⽆法响应UI交互操作，给用户带来“卡屏”、“死机”的感觉</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901095158122.png" alt="image-20220901095158122" style="zoom:80%;" /></p>
<h2 id="二handler机制">二、Handler机制</h2>
<h3 id="handler机制">2.1 Handler机制</h3>
<p>Handler机制为Android系统解决了以下两个问题：</p>
<ol type="1">
<li>任务调度</li>
<li>线程通信</li>
</ol>
<h3 id="handler的使用场景">2.2 Handler的使用场景</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901095534573.png" alt="image-20220901095534573" style="zoom:80%;" /></p>
<h3 id="handler机制简介">2.3 Handler机制简介</h3>
<p>本质是消息机制，负责消息的分发以及处理</p>
<ol type="1">
<li>通俗点来说，每个线程都有⼀个“流⽔线”，我们可往这条流⽔线上放“消息”，流⽔线的末端有⼯作⼈员会去处理这些消息。因为流⽔线是单线的，所有消息都必须按照先来后到的形式依次处理</li>
<li>放什么消息以及怎么处理消息，是需要我们去⾃定义的。Handler机制相当于提供了这样的⼀套模式，我们只需要“放消息到流⽔线上”，“编写这些消息的处理逻辑”就可以了，流⽔线会源源不断把消息运送到末端处理。</li>
<li>最后注意重点：每个线程只有⼀个“流⽔线”，他的基本范围是线程，负责线程内的通信以及线程间的通信。</li>
<li><strong>每个线程可以看成⼀个厂房，每个厂房只有⼀个生产线。</strong></li>
</ol>
<h3 id="handler原理ui线程与消息队列机制">2.4
Handler原理：UI线程与消息队列机制</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901095712103.png" alt="image-20220901095712103" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901095732246.png" alt="image-20220901095732246" style="zoom:80%;" /></p>
<ol type="1">
<li><strong>Message</strong>：消息，由MessageQueue统⼀队列，然后交由Handler处理</li>
<li><strong>MessageQueue</strong>：消息队列，⽤来存放Handler发送过来Message，并且按照先⼊先出的规则执⾏</li>
<li><strong>Handler</strong>：处理者，负责发送和处理Message每个Message必须有⼀个对应的Handler</li>
<li><strong>Looper</strong>：消息轮询器，不断的从MessageQueue中抽取Message并执⾏</li>
</ol>
<h3 id="handler常用方法">2.5 Handler常用方法</h3>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ⽴即发送消息</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">sendMessage</span><span class="params">(Message msg)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">post</span><span class="params">(Runnable r)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 延时发送消息: 马上发送消息, 但是会延迟处理</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">sendMessageDelayed</span><span class="params">(Message msg, <span class="type">long</span> delayMillis)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">postDelayed</span><span class="params">(Runnable r, <span class="type">long</span> delayMillis)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定时发送消息</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">sendMessageAtTime</span><span class="params">(Message msg, <span class="type">long</span> uptimeMillis)</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">postAtTime</span><span class="params">(Runnable r, <span class="type">long</span> uptimeMillis)</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">postAtTime</span><span class="params">(Runnable r, Object token, <span class="type">long</span> uptimeMillis)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 移除消息</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">removeCallbacks</span><span class="params">(Runnable r)</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">removeMessages</span><span class="params">(<span class="type">int</span> what)</span>; <span class="comment">// what字段:给消息的命名</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">removeCallbacksAndMessages</span><span class="params">(Object token)</span>; <span class="comment">// token=null: 表示移除所有消息</span></span><br></pre></td></tr></table></figure>
<h3 id="handler的使用">2.6 Handler的使用</h3>
<ol type="1">
<li><strong>调度Message</strong>：
<ol type="1">
<li>建⼀个<strong>Handler</strong>，实现<strong>handleMessage()</strong>⽅法</li>
<li>在适当的时候给上面的Handler发送消息</li>
</ol></li>
<li><strong>调度Runnable</strong>：
<ol type="1">
<li>建⼀个<strong>Handler</strong>，然后直接调度<strong>Runnable</strong>即可</li>
</ol></li>
<li><strong>取消调度</strong>：
<ol type="1">
<li>通过<strong>Handler取消</strong>已经发送过的<strong>Message/Runnable</strong></li>
</ol></li>
</ol>
<h3 id="handler的使用举例">2.7 Handler的使用举例</h3>
<h4 id="发送runnable对象">2.7.1 发送Runnable对象</h4>
<blockquote>
<ol type="1">
<li>新建一个<strong>Handler</strong>对象：new Handler()</li>
<li>新建一个<strong>Runnable</strong>对象 1.
重写<strong>run()</strong>方法，表示该<strong>Runnable</strong>对象要做什么事情</li>
<li>调用<strong>Handler</strong>对象的<strong>post()</strong>方法，将<strong>Runnable</strong>对象发送出去</li>
</ol>
</blockquote>
<p>启动今日头条app的时候，展示了一个开屏广告，默认播放3秒；在3秒后，需跳转到主界面</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901101255260.png" alt="image-20220901101255260" style="zoom:80%;" /></p>
<p>如果用户点击了跳过，则应该直接进入主界面</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901101341933.png" alt="image-20220901101341933" style="zoom:80%;" /></p>
<h4 id="发送message对象">2.7.2 发送Message对象</h4>
<blockquote>
<ol type="1">
<li>新建一个<strong>Handler</strong>对象：new
Handler(Looper.getMainLopper()) 1.
重写<strong>handlerMessage()</strong>方法，表示收到不同<strong>Message</strong>时做出的反应</li>
<li>调用<strong>Handler</strong>对象的<strong>post()</strong>方法，将<strong>Message</strong>对象发送出去
1. 可以直接发送msg.what，来代表一个msg</li>
</ol>
</blockquote>
<p>用户在抖音App中，点击下载视频，下载过程中需要弹出Loading窗，下载结束后提示用户下载成功/失败</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901101208647.png" alt="image-20220901101208647" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901101419103.png" alt="image-20220901101419103" style="zoom:80%;" /></p>
<h4 id="辨析runnable与message">2.7.3 辨析Runnable与Message</h4>
<ol type="1">
<li>Runnable会被打包成Message，所以实际上Runnable也是Message</li>
<li>没有明确的界限，取决于使⽤的⽅便程度</li>
</ol>
<p>以下两段代码等价</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901101512752.png" alt="image-20220901101512752" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901101518680.png" alt="image-20220901101518680" style="zoom:80%;" /></p>
<h3 id="handler总结">2.8 Handler总结</h3>
<ol type="1">
<li><strong>Handler</strong>就是<strong>Android</strong>中的消息队列机制的⼀个应用，可理解为是⼀种⽣产者消费者的模型，解决了<strong>Android</strong>中的线程内&amp;线程间的任务调度问题</li>
<li><strong>Handler</strong>机制的本质就是⼀个死循环，待处理的<strong>Message</strong>加到队列⾥⾯，<strong>Looper</strong>负责轮询执⾏</li>
<li>掌握<strong>Handler</strong>的基本⽤法：立即/延时/定时发送消息、取消消息</li>
</ol>
<h2 id="三android中的多线程">三、Android中的多线程</h2>
<h3 id="thread">3.1 Thread</h3>
<blockquote>
<ol type="1">
<li>新建一个类，继承<strong>Thread</strong>，重写其<strong>run()</strong>方法</li>
<li>调用时，先新建一个实例 1.
可以传入一个String参数，表示线程的名字</li>
<li>调用<strong>tread.start()</strong>方法，开启线程</li>
</ol>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901103023437.png" alt="image-20220901103023437" style="zoom:80%;" /></p>
<h3 id="threadpool">3.2 ThreadPool</h3>
<h4 id="为什么要使用线程池">3.2.1 为什么要使用线程池</h4>
<ol type="1">
<li>线程的创建和销毁的开销都比较⼤，降低资源消耗</li>
<li>线程是可复用的，提⾼响应速度</li>
<li>对多任务多线程进行管理，提高线程的可管理性</li>
</ol>
<h4 id="几种常用的线程池">3.2.2 几种常用的线程池</h4>
<ol type="1">
<li>单个任务处理时间比较短且任务数量很大（多个线程的线程池）：
<ol type="1">
<li><strong>FixedThreadPool</strong> 定长线程池</li>
<li><strong>CachedThreadPool</strong> 可缓存线程池</li>
</ol></li>
<li>执行定时任务（定时线程池）：
<ol type="1">
<li><strong>ScheduledThreadPool</strong> 定时任务线程池</li>
</ol></li>
<li>特定单项任务（单线程线程池）：
<ol type="1">
<li><strong>SingleThreadPool</strong> 只有⼀个线程的线程池</li>
</ol></li>
</ol>
<h4 id="使用示例">3.2.3 使用示例</h4>
<ol type="1">
<li>接口<strong>Java.util.concurrent.ExecutorService</strong>表述了异步执行的机制，并且可以让任务在⼀组线程内执行</li>
<li>重要函数：
<ol type="1">
<li><strong>execute(Runnable)</strong>：向线程池提交⼀个任务</li>
<li><strong>submit(Runnbale/Callable)</strong>：有返回值（Future），可以查询任务的执行状态和执行结果</li>
<li><strong>shutdown()</strong> ：关闭线程池</li>
</ol></li>
</ol>
<blockquote>
<ol type="1">
<li>创建一个线程池<strong>ExecutorService</strong>的示例</li>
<li>创建一个<strong>Runnable</strong>对象，并编写其业务逻辑</li>
<li>通过<strong>service.execute()</strong>方法，向线程池提交任务</li>
</ol>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901103647564.png" alt="image-20220901103647564" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901103714432.png" alt="image-20220901103714432" style="zoom:80%;" /></p>
<h3 id="asynctask已弃用">3.3 AsyncTask(已弃用)</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901103805640.png" alt="image-20220901103805640" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901103822913.png" alt="image-20220901103822913" style="zoom:80%;" /></p>
<h3 id="handlerthread">3.4 HandlerThread</h3>
<ol type="1">
<li><strong>HandlerThread</strong>的本质：继承<strong>Thread</strong>类
&amp; 封装<strong>Handler</strong>类
<ol type="1">
<li>试想⼀款股票交易App：
<ol type="1">
<li>由于因为股票的行情数据都是实时变化的</li>
<li>所以我们软件需要每隔⼀定时间向服务器请求行情数据</li>
</ol></li>
<li>该轮询调度需要放到<strong>子线程</strong>，由Handler +
Looper去处理和调度</li>
</ol></li>
<li><strong>HandlerThread</strong>是Android
API提供的⼀个⽅便、便捷的类，使用它我们可以快速的创建⼀个<strong>带有Looper的线程</strong>。<strong>Looper</strong>可以用来创建Handler实例</li>
</ol>
<blockquote>
<ol type="1">
<li>创建一个<strong>HandlerThread</strong>对象</li>
<li>使用<strong>handlerThread.start()</strong>方法，运行线程</li>
<li>通过<strong>handlerThread.getLooper()</strong>方法，获取该线程的<strong>Looper</strong></li>
<li>通过<strong>Looper</strong>实例创建<strong>Handler</strong>，将<strong>Handler</strong>与该线程关联</li>
</ol>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901104305510.png" alt="image-20220901104305510" style="zoom:80%;" /></p>
<blockquote>
<p><strong>HandlerThread</strong>的源码</p>
<ol type="1">
<li><strong>onLooperPrepared()</strong>：</li>
<li><strong>run()</strong>：运行该线程</li>
<li><strong>getThreadHandler()</strong>：</li>
<li><strong>quit()</strong>和<strong>quitSafely()</strong>：停止该线程</li>
</ol>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901104612875.png" alt="image-20220901104612875" style="zoom:80%;" /></p>
<h3 id="intentservice不常用-自学">3.5 IntentService(不常用, 自学)</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901104842002.png" alt="image-20220901104842002" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901104852833.png" alt="image-20220901104852833" style="zoom:80%;" /></p>
<h3 id="android多线程总结">3.6 Android多线程总结</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901104924134.png" alt="image-20220901104924134" style="zoom:80%;" /></p>
<h2 id="四自定义view">四、自定义View</h2>
<h3 id="view绘制的三个重要步骤">4.1 View绘制的三个重要步骤</h3>
<ol type="1">
<li><strong>Measure</strong>：测量宽高</li>
<li><strong>Layout</strong>：确定位置</li>
<li><strong>Draw</strong>：绘制形状</li>
<li>举例说明：
<ol type="1">
<li>首先画⼀个100 x
100的照片框，需要尺子测量出宽高的长度（measure过程）</li>
<li>然后确定照片框在屏幕中的位置（layout过程）</li>
<li>最后借助尺子用手画出我们的照片框（draw过程）</li>
</ol></li>
</ol>
<h3 id="绘制流程">4.2 绘制流程</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901105430782.png" alt="image-20220901105430782" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901105457172.png" alt="image-20220901105457172" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901105516634.png" alt="image-20220901105516634" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901105526514.png" alt="image-20220901105526514" style="zoom:80%;" /></p>
<h3 id="自定义view重写ondraw">4.3 自定义View：重写onDraw</h3>
<ol type="1">
<li><strong>Canvas</strong>：画布</li>
<li><strong>Paint</strong>：画笔</li>
<li><strong>坐标轴</strong>：<img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901105711985.png" alt="image-20220901105711985" style="zoom:50%;" /></li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901105602114.png" alt="image-20220901105602114" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901105630075.png" alt="image-20220901105630075" style="zoom:80%;" /></p>
<h4 id="画点">4.3.1 画点</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901105822943.png" alt="image-20220901105822943" style="zoom:80%;" /></p>
<h4 id="画线">4.3.2 画线</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901105938514.png" alt="image-20220901105938514" style="zoom:80%;" /></p>
<h4 id="画圆">4.3.3 画圆</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901105928257.png" alt="image-20220901105928257" style="zoom:80%;" /></p>
<h4 id="填充">4.3.4 填充</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901105917656.png" alt="image-20220901105917656" style="zoom:80%;" /></p>
<h4 id="不规则图形">4.3.5 不规则图形</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901105954866.png" alt="image-20220901105954866" style="zoom:80%;" /></p>
<h4 id="画文本">4.3.6 画文本</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901110009241.png" alt="image-20220901110009241" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220901110022511.png" alt="image-20220901110022511" style="zoom:80%;" /></p>
<h3 id="自定义view总结">4.4 自定义View总结</h3>
<ol type="1">
<li>重要绘制流程：
<ol type="1">
<li><strong>Measure</strong>：测量</li>
<li><strong>Layout</strong>：布局</li>
<li><strong>Draw</strong>：绘制</li>
</ol></li>
<li>以及几个重要函数：
<ol type="1">
<li><strong>invalidate</strong></li>
<li><strong>requestLayout</strong></li>
</ol></li>
<li>理解<strong>ViewTree</strong> 及 <strong>ViewGroup</strong>
的<strong>Measure / Layout / Draw</strong>的流程</li>
<li>View自定义绘制：
<ol type="1">
<li>绘制图形：点、线、圆形、椭圆、矩形、圆⻆矩形</li>
<li>绘制文字</li>
</ol></li>
</ol>
<h1 id="day5-android中的网络">Day5 Android中的网络</h1>
<h2 id="一网络基础知识">一、网络基础知识</h2>
<h3 id="网络分层模型">1.1 网络分层模型</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220902093714465.png" alt="image-20220902093714465" style="zoom:80%;" /></p>
<ol type="1">
<li>应用层<strong>Application Layer</strong>：互联网上的各种应用
<ol type="1">
<li>如：看网页、发邮件</li>
<li>如：HTTP/FTP/SMTP协议</li>
</ol></li>
<li>传输层<strong>Transport Layer</strong></li>
<li>网络层<strong>Internet Layer</strong></li>
</ol>
<h3 id="http协议">1.2 HTTP协议</h3>
<ol type="1">
<li><p>HTTP是一个<strong>client-server</strong>协议，只能由<strong>client</strong>主动发起请求，<strong>server</strong>进行响应</p>
<ol type="1">
<li>用户发出请求，服务端进行相应</li>
</ol></li>
<li><p>一个HTTP请求一定要包含<strong>Method</strong>和<strong>URL</strong></p>
<ol type="1">
<li><strong>Method</strong>：要做什么，如GET、PUT、HEAD、POST、DELETE、TRACE、OPTIONS、CONNETC</li>
<li><strong>URL</strong>：</li>
</ol></li>
<li><p><strong>Request</strong>格式：</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220902094648685.png" alt="image-20220902094648685" style="zoom:80%;" /></p></li>
<li><p><strong>Response</strong>格式：</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220902094717700.png" alt="image-20220902094717700" style="zoom:80%;" /></p></li>
<li><p><strong>HTTP</strong>状态码：</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220902094756612.png" alt="image-20220902094756612" style="zoom:80%;" /></p>
<ol type="1">
<li><strong>4XX</strong>：服务器正常，但客户段出错</li>
<li><strong>404</strong>：服务器正常，但服务不存在</li>
<li><strong>5XX</strong>：服务器不正常，无法处理请求(请求过多)</li>
</ol></li>
</ol>
<h3 id="restful-api">1.3 RESTful API</h3>
<h4 id="api">1.3.1 API</h4>
<p><strong>API</strong>：Application Programming Interface
应用程序接口</p>
<ol type="1">
<li><strong>用户端</strong>使用固定的方式发起请求</li>
<li><strong>服务端</strong>提供服务，响应该请求</li>
<li>使用一个固定的方式，保证不同模块之间进行通信，提高兼容性</li>
<li>略去不同模块之间的区别，找到共同的部分</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220902095511020.png" alt="image-20220902095511020" style="zoom:80%;" /></p>
<h4 id="restful-api-1">1.3.2 RESTful API</h4>
<p><strong>RESTful API</strong>：Resource Epresentational State Transfer
(资源)表现层状态转换</p>
<ol type="1">
<li>API
是面向资源的，资源表达的形式可以是json或者xml，它的url中不包含动词，而是通过HTTP动词表达想要的动作</li>
<li>资源：一段文本、一张图片、一首歌曲</li>
<li>表现形式：json、xml</li>
<li>状态变化：通过HTTP动词实现</li>
<li>目的：看 URL 就知道要什么，看HTTP method 就知道干什么</li>
</ol>
<blockquote>
<p><strong>RESTful</strong> 只是一种规范，并不是标准</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220902100654244.png" alt="image-20220902100654244" style="zoom:80%;" /></p>
<h3 id="数据传输格式">1.4 数据传输格式</h3>
<blockquote>
<p>后端与前端/客户端需要约定数据传输的格式，以json为例</p>
<ol type="1">
<li>每一组数据都是键值对</li>
<li>{}括起的数据：单个值</li>
<li>[]括起的数据：数组值</li>
</ol>
</blockquote>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;中国&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;provinces&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;黑龙江&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;cities&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;city&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;哈尔滨&quot;</span><span class="punctuation">,</span> <span class="string">&quot;大庆&quot;</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;广东&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;cities&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;city&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;广州&quot;</span><span class="punctuation">,</span> <span class="string">&quot;深圳&quot;</span><span class="punctuation">,</span> <span class="string">&quot;珠海&quot;</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="json解析器gson">1.4.1 JSON解析器：gson</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220902104328367.png" alt="image-20220902104328367" style="zoom: 80%;" /></p>
<blockquote>
<p>常用<strong>API</strong></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 将对象转化成Json</span></span><br><span class="line"><span class="keyword">public</span> &lt;T&gt; toJson(Object src);</span><br><span class="line"><span class="comment">// 从Json中提取对象</span></span><br><span class="line"><span class="keyword">public</span> &lt;T&gt; fromJson(String json, Class&lt;T&gt; classOfT);</span><br><span class="line"><span class="keyword">public</span> &lt;T&gt; fromJson(Reader json, Type typeOfT);</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220902104903235.png" alt="image-20220902104903235" style="zoom:80%;" /></p>
<h4 id="下划线命名-vs-驼峰命名">1.4.2 下划线命名 vs 驼峰命名</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220902105446240.png" alt="image-20220902105446240" style="zoom:80%;" /></p>
<h3 id="实用工具">1.5 实用工具</h3>
<h4 id="json相关">1.5.1 JSON相关</h4>
<ol type="1">
<li><a target="_blank" rel="noopener" href="https://www.sojson.com/">JSON 在线辅助网站</a>：转
JavaBean；合法性校验；压缩；优化预览</li>
<li>GsonFormatPlus：IDEA 插件，JSON 转 JavaBean</li>
<li>JSON：维基百科，了解 JSON 的来⻰去脉</li>
</ol>
<h4 id="抓包工具-charles">1.5.2 抓包工具 Charles</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220902105219265.png" alt="image-20220902105219265" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220902105234415.png" alt="image-20220902105234415" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220902105347441.png" alt="image-20220902105347441" style="zoom:80%;" /></p>
<h4 id="抓包工具-postman轻松创建请求">1.5.3 抓包工具
Postman–轻松创建请求</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220902105519456.png" alt="image-20220902105519456" style="zoom:80%;" /></p>
<h2 id="二android网络通信基础实现">二、Android网络通信基础实现</h2>
<h3 id="添加网络权限">2.1 添加网络权限</h3>
<blockquote>
<p>在<strong>AndroidManifest.xml</strong>中，添加网络权限<strong>uses-permission</strong></p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">manifest</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.INTERNET&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span> /&gt;</span></span><br><span class="line">    ......</span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="获取网络中的数据">2.2 获取网络中的数据</h3>
<blockquote>
<ol type="1">
<li>新建一个线程<strong>HandlerThread</strong>，用于执行与网络有关的任务</li>
<li>新建一个任务<strong>Handler</strong>，用于从<strong>url</strong>中获取数据
<ol type="1">
<li>在<strong>run()</strong>方法中</li>
<li>调用自定义的<strong>getDataFromNetwork()</strong>方法，获取数据</li>
<li>然后根据得到的数据，调用自定义的<strong>showDataFromNetwork()</strong>方法，刷新界面</li>
</ol></li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">    <span class="comment">// 初始化界面的相关操作</span></span><br><span class="line">    <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.lab5_main_layout);</span><br><span class="line">    networkResult = findViewById(R.id.Lab5_NetworkResult);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行从网络中获取数据的操作</span></span><br><span class="line">    runGetDataFromNetwork(<span class="string">&quot;https://www.wanandroid.com/article/list/0/json/&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 新建线程, 执行从网络中获取数据的操作</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">runGetDataFromNetwork</span><span class="params">(String urlString)</span>&#123;</span><br><span class="line">    <span class="comment">// 新建一个线程, 用于执行与网络有关的任务</span></span><br><span class="line">    <span class="type">HandlerThread</span> <span class="variable">handlerThread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HandlerThread</span>(<span class="string">&quot;Networking&quot;</span>);</span><br><span class="line">    handlerThread.start();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 新建一个Handler, 用于从url中获取数据</span></span><br><span class="line">    <span class="type">Handler</span> <span class="variable">networkingHandler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Handler</span>(handlerThread.getLooper());</span><br><span class="line">    <span class="type">Runnable</span> <span class="variable">networkingRunnable</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            Log.d(TAG, <span class="string">&quot;run networking Runnable: 从url中获取数据&quot;</span>);</span><br><span class="line">            <span class="comment">// 调用getDataFromNetwork()方法, 获取数据</span></span><br><span class="line">            ArrayList&lt;Lab5_NetworkData&gt; result = getDataFromNetwork(urlString);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 根据得到的数据, 刷新界面</span></span><br><span class="line">            <span class="keyword">if</span>(result != <span class="literal">null</span> &amp;&amp; !result.isEmpty())&#123;</span><br><span class="line">                Log.d(TAG, <span class="string">&quot;run networking Runnable: 从url中获取数据为:&quot;</span> + <span class="string">&quot;not null&quot;</span>);</span><br><span class="line">                showDataFromNetwork(result);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                Log.d(TAG, <span class="string">&quot;run networking Runnable: 从url中获取数据为:&quot;</span> + <span class="string">&quot;null&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    networkingHandler.post(networkingRunnable);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<ol type="1">
<li>获取数据：<strong>getDataFromNetwork(String urlString)</strong>方法
<ol type="1">
<li>将传入的<strong>urlString</strong>转化为<strong>URL</strong></li>
<li>使用<strong>HttpURLConnection</strong>建立连接
<ol type="1">
<li>创建实例<strong>connection</strong></li>
</ol></li>
<li>从<strong>connection</strong>中获取数据
<ol type="1">
<li>先获取为<strong>InputStream</strong></li>
<li>然后转化为<strong>BufferedReader</strong></li>
<li>最后，通过<strong>BufferedReader.readLine()</strong>方法，将其中的数据转化为<strong>JSONObject</strong></li>
</ol></li>
<li>解析<strong>JSON</strong>：从<strong>JSONObject</strong>中，读取出所有<strong>data.datas[].title/link</strong>
<ol type="1">
<li>根据目标<strong>JSON</strong>文件的结构，反复调用<strong>getJSONObject()</strong>、<strong>getJSONArray()</strong>方法</li>
<li>如果当前到达了最低层，则调用<strong>getString()</strong>方法，获取<strong>String</strong>类型的数据</li>
<li>将数据存放入一个<strong>ArrayList</strong>中</li>
</ol></li>
<li>将读取到的<strong>ArrayList</strong>返回</li>
</ol></li>
<li>注意要使用<strong>try</strong>，防止操作出现异常</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 从网络中获取数据</span></span><br><span class="line"><span class="comment">// 返回一个List, 存放解析出的Json数据</span></span><br><span class="line"><span class="keyword">private</span> ArrayList&lt;Lab5_NetworkData&gt; <span class="title function_">getDataFromNetwork</span><span class="params">(String urlString)</span>&#123;</span><br><span class="line">    Log.d(TAG, <span class="string">&quot;getDataFromNetwork: 从网络中获取数据, 返回List&quot;</span>);</span><br><span class="line">    ArrayList&lt;Lab5_NetworkData&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Lab5_NetworkData&gt;();</span><br><span class="line">    <span class="comment">// 通过try, 防止获取数据出现问题</span></span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="comment">// 将urlString转化为URL</span></span><br><span class="line">        <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(urlString);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 使用HttpURLConnection建立连接</span></span><br><span class="line">        <span class="type">HttpURLConnection</span> <span class="variable">connection</span> <span class="operator">=</span> (HttpURLConnection) url.openConnection();</span><br><span class="line">        connection.setConnectTimeout(<span class="number">6000</span>);</span><br><span class="line">        connection.connect();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取数据, 并将其转化为JSONObject</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> connection.getInputStream();</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(inputStream, StandardCharsets.UTF_8));</span><br><span class="line">        <span class="type">JSONObject</span> <span class="variable">resultJson</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONObject</span>(reader.readLine());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 从JSONObject中, 读取出所有data.datas[].title/link</span></span><br><span class="line">        <span class="type">JSONObject</span> <span class="variable">data</span> <span class="operator">=</span> resultJson.getJSONObject(<span class="string">&quot;data&quot;</span>);</span><br><span class="line">        <span class="type">JSONArray</span> <span class="variable">datas</span> <span class="operator">=</span> data.getJSONArray(<span class="string">&quot;datas&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>; index &lt; datas.length(); index++)&#123;</span><br><span class="line">            <span class="type">JSONObject</span> <span class="variable">item</span> <span class="operator">=</span> datas.getJSONObject(index);</span><br><span class="line">            <span class="type">String</span> <span class="variable">title</span> <span class="operator">=</span> item.getString(<span class="string">&quot;title&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">link</span> <span class="operator">=</span> item.getString(<span class="string">&quot;link&quot;</span>);</span><br><span class="line">            result.add(<span class="keyword">new</span> <span class="title class_">Lab5_NetworkData</span>(title, link));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 关闭BufferedReader, InputStream, 取消HttpURLConnection的连接</span></span><br><span class="line">        reader.close();</span><br><span class="line">        inputStream.close();</span><br><span class="line">        connection.disconnect();</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="使用webview打开网页">2.3 使用WebView打开网页</h3>
<blockquote>
<ol type="1">
<li>新建一个<strong>Activity</strong>，其中有<strong>WebView</strong>控件</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line">    xmlns:app=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span><br><span class="line">    xmlns:tools=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span><br><span class="line">    android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">    android:layout_height=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">    tools:context=<span class="string">&quot;.Lab5_WebViewActivity&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;WebView</span><br><span class="line">        android:id=<span class="string">&quot;@+id/Lab5_WebView&quot;</span></span><br><span class="line">        android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">        android:layout_height=<span class="string">&quot;match_parent&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<ol start="2" type="1">
<li>切换至<strong>WebViewActivity</strong>时，将<strong>urlString</strong>作为参数，添加进<strong>intent</strong>中</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 使用单个从网络中获取的数据</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">useDataFromNetwork</span><span class="params">(Lab5_NetworkData data)</span>&#123;</span><br><span class="line">    <span class="comment">// 使用WebView Activity打开网页</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">urlString</span> <span class="operator">=</span> data.getLink();</span><br><span class="line">    <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(<span class="built_in">this</span>, Lab5_WebViewActivity.class);</span><br><span class="line">    intent.putExtra(<span class="string">&quot;url&quot;</span>, urlString);</span><br><span class="line">    startActivity(intent);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<ol start="3" type="1">
<li>在<strong>WebViewActivity</strong>初始化时，获取<strong>urlString</strong>参数，打开网页
<ol type="1">
<li>由于现在的网页包含的内容过多，因此要进行一系列设置，才能正常读取页面的数据</li>
</ol></li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Lab5_WebViewActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> WebView webView;</span><br><span class="line">    <span class="keyword">private</span> WebSettings webSettings;</span><br><span class="line">    <span class="keyword">private</span> String urlString;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.lab5_webview_layout);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取WebView控件, 传入的url字符串, WebSettings属性</span></span><br><span class="line">        webView = findViewById(R.id.Lab5_WebView);</span><br><span class="line">        urlString = getIntent().getStringExtra(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">        webSettings = webView.getSettings();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置WebView的属性</span></span><br><span class="line">        webSettings.setJavaScriptEnabled(<span class="literal">true</span>);</span><br><span class="line">        webSettings.setJavaScriptCanOpenWindowsAutomatically(<span class="literal">true</span>);</span><br><span class="line">        webSettings.setSupportZoom(<span class="literal">true</span>);</span><br><span class="line">        webSettings.setBuiltInZoomControls(<span class="literal">true</span>);</span><br><span class="line">        webSettings.setLoadWithOverviewMode(<span class="literal">true</span>);</span><br><span class="line">        webSettings.setAppCacheEnabled(<span class="literal">true</span>);</span><br><span class="line">        webSettings.setDomStorageEnabled(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使用WebView控件, 打开对应网页</span></span><br><span class="line">        webView.loadUrl(urlString);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="三进阶实现retrofit自学">三、进阶实现：Retrofit(自学)</h2>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220902112806576.png" alt="image-20220902112806576" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220902112756408.png" alt="image-20220902112756408" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220902112746043.png" alt="image-20220902112746043" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220902112736535.png" alt="image-20220902112736535" style="zoom:80%;" /></p>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220902112726704.png"
alt="image-20220902112726704" />
<figcaption aria-hidden="true">image-20220902112726704</figcaption>
</figure>
<h1 id="day6-android存储">Day6 Android存储</h1>
<h2 id="一存储空间概览">一、存储空间概览</h2>
<h3 id="存储空间的区分">1.1 存储空间的区分</h3>
<ol type="1">
<li><strong>Internal
Storage</strong>：是系统分配给应用的专属内部存储空间
<ol type="1">
<li>APP专有的</li>
<li>用户不可以直接读取(root用户除外)</li>
<li>应用卸载时自动清空</li>
<li>有且仅有一个</li>
</ol></li>
<li><strong>External Storage</strong>：是系统外部存储空间，如 SD卡
<ol type="1">
<li>所有用户均可访问</li>
<li>不保证可用性(可挂载/物理移除)</li>
<li>可以卸载后仍保留</li>
<li>可以有多个</li>
</ol></li>
</ol>
<h3 id="存储目录">1.2 存储目录</h3>
<ol type="1">
<li><p><strong>Internal Storage</strong>：/</p>
<ol type="1">
<li>APP专用：
<ol type="1">
<li>data/data/{your.package.name}/ files、cache、db...</li>
</ol></li>
</ol></li>
<li><p><strong>External Storage</strong>：</p>
<ol type="1">
<li>APP专用：
<ol type="1">
<li>/storage/emulated/0/Android/data/{your.package.name}/
files、cache</li>
</ol></li>
<li>公共文件夹：./
<ol type="1">
<li> --- Standard: DCIM、Download、Movies</li>
<li> --- Others</li>
</ol></li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905093948124.png" alt="image-20220905093948124" style="zoom:80%;" /></p></li>
</ol>
<h3 id="internal目录的获取">1.3 Internal目录的获取</h3>
<ol type="1">
<li>file目录：<strong>context.getFilesDir()</strong></li>
<li>cache目录：<strong>context.getCacheDir()</strong></li>
<li>自定义目录：<strong>context.getDir(name, mode_private)</strong></li>
</ol>
<h3 id="external目录的获取">1.4 External目录的获取</h3>
<h4 id="获取授权">1.4.1 获取授权</h4>
<blockquote>
<p><strong>AndroidManifest.xml</strong>中声明权限</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.READ_EXTERNAL_STORAGE&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>请求授权（<strong>Android 6.0</strong>及以上）</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">CODE_REQUEST_PERMISSION</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (ContextCompat.checkSelfPermission(<span class="built_in">this</span>, Manifest.permission.READ_CALENDAR) </span><br><span class="line">		!= PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">	ActivityCompat.requestPermissions(<span class="built_in">this</span>, </span><br><span class="line">		<span class="keyword">new</span> <span class="title class_">String</span>[] &#123;Manifest.permission.READ_EXTERNAL_STORAGE&#125;, </span><br><span class="line">		CODE_REQUEST_PERMISSION);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在 <strong>Activity</strong> 的
<strong>onRequestPermissionsResult</strong> 方法中获取授权结果</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onRequestPermissionsResult</span><span class="params">(<span class="type">int</span> requestCode, <span class="meta">@NonNull</span> String[] permissions, <span class="meta">@NonNull</span> <span class="type">int</span>[] grantResults)</span> &#123;</span><br><span class="line">	<span class="built_in">super</span>.onRequestPermissionsResult(requestCode, permissions, grantResults);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (requestCode == CODE_REQUEST_PERMISSION) &#123;</span><br><span class="line">		<span class="keyword">if</span> (grantResults.length &gt; <span class="number">0</span> &amp;&amp; </span><br><span class="line">			grantResults[<span class="number">0</span>] == PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">			<span class="comment">// ⽤户已授权</span></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="comment">// ⽤户拒绝了授权</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="environment-apis">1.4.2 Environment APIs</h4>
<blockquote>
<p>提供了访问<strong>环境变量</strong>的方法</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Environment</span> <span class="keyword">extends</span> <span class="title class_">Object</span>&#123;&#125;;</span><br><span class="line">android.os.Environment;</span><br></pre></td></tr></table></figure>
<h4 id="检查外置存储器的可用性">1.4.3 检查外置存储器的可用性</h4>
<blockquote>
<p>通过<strong>Environment.getExternalStorageState();</strong>调⽤获取当前外部存储的状态，并以此判断外部存储是否可⽤</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905100752309.png" alt="image-20220905100752309" style="zoom:80%;" /></p>
<h4 id="external目录的获取-1">1.4.4 External目录的获取</h4>
<ol type="1">
<li>应用私有目录：
<ol type="1">
<li><strong>file</strong>目录：<strong>context.getExternalFilesDir(String
type)</strong></li>
<li><strong>cache</strong>目录：<strong>context.getExternalCacheDir()</strong></li>
</ol></li>
<li>公共目录：
<ol type="1">
<li>标准目录：<strong>Environment.getExternalStoragePublicDirectory(String
type)</strong></li>
<li>根目录：<strong>Environment.getExternalStorageDirectory()</strong></li>
</ol></li>
<li>标准目录：
<ol type="1">
<li><strong>DIRECTORY_ALARMS</strong></li>
<li><strong>DIRECTORY_DCIM</strong></li>
<li><strong>DIRECTORY_DOCUMENTS</strong></li>
<li><strong>DIRECTORY_DOWNLOADS</strong></li>
<li><strong>DIRECTORY_MOVIES</strong></li>
</ol></li>
</ol>
<h3 id="注意事项">1.5 注意事项</h3>
<ol type="1">
<li>如果用户卸载应⽤，系统会移除保存在应⽤专属存储空间中的⽂件</li>
<li>由于这⼀行为，不应使用此存储空间保存⽤户希望独例于应用而保留的任何内容
<ol type="1">
<li>例如，如果应用允许用户拍摄照片，用户会希望即使卸载应⽤后仍可访问这些照⽚</li>
<li>因此，应改为使用共享存储空间将此类文件保存到适当的媒体集合中。</li>
</ol></li>
</ol>
<p>更多信息可参考：https://developer.android.com/guide/topics/data?hl=zh-cn</p>
<h2 id="二键值对">二、键值对</h2>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905094425569.png" alt="image-20220905094425569" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905094434425.png" alt="image-20220905094434425" style="zoom:80%;" /></p>
<h2 id="三sharedpreferences">三、SharedPreferences</h2>
<h3 id="介绍">3.1 介绍</h3>
<ol type="1">
<li><strong>SharedPreference</strong> 就是 <strong>Android</strong>
提供的数据持久化的⼀个方式，适合单进程，小批量的数据存储和访问。基于
<strong>XML</strong>
进行实现，本质上还是⽂件的读写，<strong>API</strong> 相较
<strong>File</strong> 更简单。</li>
<li>以“键-值”对的方式保存数据的<strong>xml</strong>⽂件，其文件保存在<strong>/data/data/[packageName]/shared_prefs</strong>目录下</li>
</ol>
<h3 id="获取sharedpreferences">3.2 获取SharedPreferences</h3>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905094610997.png"
alt="image-20220905094610997" />
<figcaption aria-hidden="true">image-20220905094610997</figcaption>
</figure>
<h3 id="读取sharedpreferences">3.3 读取SharedPreferences</h3>
<blockquote>
<p>通过<strong>getxxx()</strong>方法获取，需要传入(<strong>key</strong>，<strong>defaultValue</strong>)</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SP_NAME</span> <span class="operator">=</span> <span class="string">&quot;Lab6_SharedPreference&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SAVE_KEY</span>  <span class="operator">=</span> <span class="string">&quot;Lab6_Text&quot;</span>;</span><br><span class="line"><span class="comment">// 从内存中读取EditText的文本</span></span><br><span class="line"><span class="keyword">private</span> String <span class="title function_">readTextFromStorage</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">SharedPreferences</span> <span class="variable">sp</span> <span class="operator">=</span> Lab6_SharedPreference.<span class="built_in">this</span>.getSharedPreferences(SP_NAME, Context.MODE_PRIVATE);</span><br><span class="line">    <span class="type">String</span> <span class="variable">text</span> <span class="operator">=</span> sp.getString(SAVE_KEY,<span class="string">&quot;记录一些文字&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> text;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905094626044.png"
alt="image-20220905094626044" />
<figcaption aria-hidden="true">image-20220905094626044</figcaption>
</figure>
<h3 id="写sharedpreferences">3.4 写SharedPreferences</h3>
<blockquote>
<p>通过<strong>Editor</strong>类来提交修改</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SP_NAME</span> <span class="operator">=</span> <span class="string">&quot;Lab6_SharedPreference&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SAVE_KEY</span>  <span class="operator">=</span> <span class="string">&quot;Lab6_Text&quot;</span>;</span><br><span class="line"><span class="comment">// 将当前EditText的文本保存到内存中</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">saveTextToStorage</span><span class="params">(String text)</span>&#123;</span><br><span class="line">    <span class="type">SharedPreferences</span> <span class="variable">sp</span> <span class="operator">=</span> Lab6_SharedPreference.<span class="built_in">this</span>.getSharedPreferences(SP_NAME, Context.MODE_PRIVATE);</span><br><span class="line">    SharedPreferences.<span class="type">Editor</span> <span class="variable">editor</span> <span class="operator">=</span> sp.edit();</span><br><span class="line">    editor.putString(SAVE_KEY, text);</span><br><span class="line">    editor.commit();</span><br><span class="line">    <span class="comment">// 或者调用apply方法</span></span><br><span class="line">    <span class="comment">// editor.apply();</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="sharedpreferences的原理">3.5 SharedPreferences的原理</h3>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905094927561.png"
alt="image-20220905094927561" />
<figcaption aria-hidden="true">image-20220905094927561</figcaption>
</figure>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905094941985.png"
alt="image-20220905094941985" />
<figcaption aria-hidden="true">image-20220905094941985</figcaption>
</figure>
<h3 id="注意事项-1">3.6 注意事项</h3>
<ol type="1">
<li>SharedPreference 适合场景：小数据</li>
<li>SharedPreference 每次写入均为全量写入</li>
<li>禁止大数据存储在 SharedPreference 中，导致 ANR</li>
</ol>
<p>官方推荐的DataStore：https://developer.android.com/topic/libraries/architecture/datastore</p>
<h2 id="四文件file">四、文件File</h2>
<h3 id="流">4.1 流</h3>
<p>都是相对调用者而言的</p>
<ol type="1">
<li>按流向分为：
<ol type="1">
<li>输⼊流</li>
<li>输出流</li>
</ol></li>
<li>按传输单位分为：
<ol type="1">
<li>字节流：<strong>InputStream</strong> 和
<strong>OutputStream</strong> 基类</li>
<li>字符流：<strong>Reader</strong> 和 <strong>Writer</strong> 基类</li>
</ol></li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905095449287.png" alt="image-20220905095449287"  /></p>
<h3 id="api-1">4.2 API</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905095310212.png" alt="image-20220905095310212" style="zoom:80%;" /></p>
<h3 id="文件操作">4.3 文件操作</h3>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905095407452.png"
alt="image-20220905095407452" />
<figcaption aria-hidden="true">image-20220905095407452</figcaption>
</figure>
<h3 id="文件io读写操作示例">4.4 文件IO读写操作示例</h3>
<blockquote>
<ol type="1">
<li>创建 File 对象，通过构造函数：
<ol type="1">
<li><strong>new File()</strong></li>
</ol></li>
<li>创建输⼊输出流对象：
<ol type="1">
<li><strong>new FileReader()</strong></li>
<li><strong>new FileWriter()</strong></li>
</ol></li>
<li>读取 or 写⼊
<ol type="1">
<li><strong>read</strong> 方法</li>
<li><strong>write</strong> f昂发</li>
</ol></li>
<li>关闭资源
<ol type="1">
<li>有借有还，再借不难</li>
</ol></li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Lab6_FileIO</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TAG</span> <span class="operator">=</span> <span class="string">&quot;Lab6_FileIO&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SAVE_FILE_NAME</span> <span class="operator">=</span> <span class="string">&quot;Lab6_FileIO&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SAVE_KEY</span>  <span class="operator">=</span> <span class="string">&quot;Lab6_Text&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> EditText editText;</span><br><span class="line">    <span class="keyword">private</span> Button saveButton;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.lab6_text_memo);</span><br><span class="line"></span><br><span class="line">        fileName = getFilesDir().getAbsolutePath() + File.separator + SAVE_FILE_NAME;</span><br><span class="line"></span><br><span class="line">        editText = findViewById(R.id.Lab6_EditText);</span><br><span class="line">        readTextFromStorage();</span><br><span class="line"></span><br><span class="line">        saveButton = findViewById(R.id.Lab6_Save_Button);</span><br><span class="line">        saveButton.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                saveTextToStorage(editText.getText().toString());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从内存中读取EditText的文本</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">readTextFromStorage</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(fileName);</span><br><span class="line">                <span class="comment">// 文件不存在, 则新建一个文件</span></span><br><span class="line">                <span class="keyword">if</span>(!file.exists())&#123;</span><br><span class="line">                    <span class="keyword">try</span>&#123;</span><br><span class="line">                        <span class="type">boolean</span> <span class="variable">isSuccess</span> <span class="operator">=</span> file.createNewFile();</span><br><span class="line">                        <span class="keyword">if</span>(!isSuccess) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IOException</span>(<span class="string">&quot;create file exception&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                        Log.e(TAG, <span class="string">&quot;readTextFromStorage: 创建文件失败&quot;</span>);</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 文件存在</span></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">// 创建文件输入流</span></span><br><span class="line">                    <span class="type">FileInputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file);</span><br><span class="line">                    <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">                    <span class="keyword">final</span> <span class="type">StringBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">                    <span class="comment">// 读取数据, 存入buffer中</span></span><br><span class="line">                    <span class="keyword">while</span> (inputStream.read(bytes) != -<span class="number">1</span>)&#123;</span><br><span class="line">                        buffer.append(<span class="keyword">new</span> <span class="title class_">String</span>(bytes));</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// 在UI线程中修改editText的值</span></span><br><span class="line">                    runOnUiThread(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                            <span class="type">String</span> <span class="variable">text</span> <span class="operator">=</span> buffer.toString();</span><br><span class="line">                            text = text.trim();</span><br><span class="line">                            <span class="keyword">if</span>(text.equals(<span class="string">&quot;&quot;</span>)) text = <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;记录一些文字&quot;</span>);</span><br><span class="line">                            editText.setText(text);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    Log.e(TAG, <span class="string">&quot;readTextFromStorage: 文件读取失败&quot;</span>);</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将当前EditText的文本保存到内存中</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">saveTextToStorage</span><span class="params">(String text)</span>&#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(fileName);</span><br><span class="line">                <span class="comment">// 文件不存在, 则新建一个文件</span></span><br><span class="line">                <span class="keyword">if</span>(!file.exists())&#123;</span><br><span class="line">                    <span class="keyword">try</span>&#123;</span><br><span class="line">                        <span class="type">boolean</span> <span class="variable">isSuccess</span> <span class="operator">=</span> file.createNewFile();</span><br><span class="line">                        <span class="keyword">if</span>(!isSuccess) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IOException</span>(<span class="string">&quot;create file exception&quot;</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                        Log.e(TAG, <span class="string">&quot;saveTextToStorage: 创建文件失败&quot;</span>);</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 文件存在</span></span><br><span class="line">                <span class="type">FileOutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    outputStream = <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(file);</span><br><span class="line">                    outputStream.write(text.getBytes());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">                    Log.e(TAG, <span class="string">&quot;saveTextToStorage: 创建文件失败&quot;</span>);</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">finally</span> &#123; <span class="comment">// 将文件输出流关闭</span></span><br><span class="line">                    <span class="keyword">try</span>&#123;</span><br><span class="line">                        <span class="keyword">if</span>(outputStream != <span class="literal">null</span>)</span><br><span class="line">                            outputStream.close();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">                        Log.e(TAG, <span class="string">&quot;saveTextToStorage: 文件输出流关闭失败&quot;</span>);</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="拓展okio">4.7 拓展：OkIO</h3>
<ol type="1">
<li>是在<strong>JavaIO</strong>基础上再次进行封装的<strong>IO</strong>框架</li>
<li>https://square.github.io/okio/</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906142429416.png" alt="image-20220906142429416" style="zoom:80%;" /></p>
<h2 id="五数据库">五、数据库</h2>
<h3 id="使用场景">5.1 使用场景</h3>
<ol type="1">
<li>重复的数据</li>
<li>结构化的数据</li>
<li>关系型数据</li>
</ol>
<h3 id="数据库的设计">5.2 数据库的设计</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905103427035.png" alt="image-20220905103427035"  /></p>
<h3 id="sql">5.3 SQL</h3>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905103449215.png"
alt="image-20220905103449215" />
<figcaption aria-hidden="true">image-20220905103449215</figcaption>
</figure>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905103454598.png"
alt="image-20220905103454598" />
<figcaption aria-hidden="true">image-20220905103454598</figcaption>
</figure>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905103500886.png"
alt="image-20220905103500886" />
<figcaption aria-hidden="true">image-20220905103500886</figcaption>
</figure>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905103506146.png"
alt="image-20220905103506146" />
<figcaption aria-hidden="true">image-20220905103506146</figcaption>
</figure>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905103512495.png"
alt="image-20220905103512495" />
<figcaption aria-hidden="true">image-20220905103512495</figcaption>
</figure>
<h3 id="使用示例todo-list-app">5.4 使用示例：Todo List App</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906142203738.png" alt="image-20220906142203738" style="zoom:80%;" /></p>
<h4 id="定义contract类">5.4.1 定义Contract类</h4>
<blockquote>
<p>定义表结构、SQL语句</p>
</blockquote>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905103926681.png"
alt="image-20220905103926681" />
<figcaption aria-hidden="true">image-20220905103926681</figcaption>
</figure>
<h4 id="继承sqliteopenhelper">5.4.2 继承SQLiteOpenHelper</h4>
<blockquote>
<p>执行<strong>Create</strong> 和 <strong>Delete</strong> 操作</p>
</blockquote>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905103718927.png"
alt="image-20220905103718927" />
<figcaption aria-hidden="true">image-20220905103718927</figcaption>
</figure>
<h4 id="获取sqllitedatabase">5.4.3 获取SQLLiteDatabase</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906142245189.png" alt="image-20220906142245189" style="zoom:80%;" /></p>
<h4 id="insert">5.4.4 Insert</h4>
<blockquote>
<p>通过<strong>ContentValues</strong>进行插⼊操作</p>
</blockquote>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905103913631.png"
alt="image-20220905103913631" />
<figcaption aria-hidden="true">image-20220905103913631</figcaption>
</figure>
<h4 id="query">5.4.5 Query</h4>
<blockquote>
<p>调用<strong>query()</strong>方法，返回 <strong>Cursor</strong>
，对应查询结果集合</p>
<p>当<strong>moveToNext</strong>返回 -1时，遍历结束</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906142305525.png" alt="image-20220906142305525" style="zoom:80%;" /></p>
<h4 id="delete">5.4.6 Delete</h4>
<blockquote>
<p>删除数据库中对应 id 的数据</p>
</blockquote>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905104044993.png"
alt="image-20220905104044993" />
<figcaption aria-hidden="true">image-20220905104044993</figcaption>
</figure>
<h4 id="update">5.4.7 Update</h4>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905104116815.png"
alt="image-20220905104116815" />
<figcaption aria-hidden="true">image-20220905104116815</figcaption>
</figure>
<h4 id="debug">5.4.8 Debug</h4>
<blockquote>
<p>adb + sqlite3：http://www.sqlite.org/cli.html</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906142351296.png" alt="image-20220906142351296" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906142357145.png" alt="image-20220906142357145" style="zoom:80%;" /></p>
<h4 id="注意事项-2">5.4.8 注意事项</h4>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905104435654.png"
alt="image-20220905104435654" />
<figcaption aria-hidden="true">image-20220905104435654</figcaption>
</figure>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905104450504.png"
alt="image-20220905104450504" />
<figcaption aria-hidden="true">image-20220905104450504</figcaption>
</figure>
<h3 id="room-library">5.5 Room Library</h3>
<p>https://developer.android.com/jetpack/androidx/releases/room</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905104524950.png" alt="image-20220905104524950" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906142120880.png" alt="image-20220906142120880" style="zoom: 80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906142128136.png" alt="image-20220906142128136" style="zoom:80%;" /></p>
<h2 id="六content-provider">六、Content Provider</h2>
<h3 id="定义">6.1 定义</h3>
<ol type="1">
<li>当我们需要在应⽤间共享数据时，<strong>ContentProvider</strong>
就是⼀个非常值得使用的组件</li>
<li>四大组件之⼀，<strong>ContentProvider</strong> 是⼀种
<strong>Android</strong>
数据共享机制，无论其内部数据以什么样的方式组织，对外都是提供统⼀的接口</li>
<li>通过
<strong>ContentProvider</strong>可以获取系统的媒体、联系⼈、⽇程等数据</li>
</ol>
<p>https://developer.android.com/reference/android/content/ContentProvider</p>
<h3 id="content-provider架构">6.2 Content Provider架构</h3>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905104930570.png"
alt="image-20220905104930570" />
<figcaption aria-hidden="true">image-20220905104930570</figcaption>
</figure>
<h3 id="优点">6.3 优点</h3>
<ol type="1">
<li>跨应用分享数据
<ol type="1">
<li>系统的 <strong>providers</strong> 有联系人等</li>
</ol></li>
<li>是对数据层的良好抽象</li>
<li>支持精细的权限控制</li>
</ol>
<h2 id="七uri">七、URI</h2>
<h3 id="uri介绍">7.1 URI介绍</h3>
<p><strong>URI</strong>：Uniform Resource
Indentifier，唯一标识ContentProvider的数据</p>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905105150461.png"
alt="image-20220905105150461" />
<figcaption aria-hidden="true">image-20220905105150461</figcaption>
</figure>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905105158051.png"
alt="image-20220905105158051" />
<figcaption aria-hidden="true">image-20220905105158051</figcaption>
</figure>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220905105248202.png"
alt="image-20220905105248202" />
<figcaption aria-hidden="true">image-20220905105248202</figcaption>
</figure>
<h3 id="uri使用示例">7.2 URI使用示例</h3>
<h4 id="查询获取联系人数据">7.2.1 查询：获取联系人数据</h4>
<blockquote>
<ol type="1">
<li><strong>AndroidManifest</strong> 权限声明</li>
</ol>
</blockquote>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">&lt;uses-permission <span class="attr">android:</span>name=<span class="string">&quot;android.permission.READ_CONTACTS&quot;</span> /&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<ol start="2" type="1">
<li>在程序中动态请求权限</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (ContextCompat.checkSelfPermission(<span class="built_in">this</span>, Manifest.permission.READ_CONTACTS)</span><br><span class="line">    	!= PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">    ActivityCompat.requestPermissions(<span class="built_in">this</span>, <span class="keyword">new</span> <span class="title class_">String</span>[] &#123;</span><br><span class="line">        Manifest.permission.READ_CONTACTS</span><br><span class="line">    &#125;, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<ol start="3" type="1">
<li>通过<strong>ContentResolver</strong>
查询对应的<strong>ContentProvider</strong></li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获取 ContentResolver 对象</span></span><br><span class="line"><span class="type">ContentResolver</span> <span class="variable">contentResolver</span> <span class="operator">=</span> <span class="built_in">this</span>.getContentResolver();</span><br><span class="line"><span class="type">Cursor</span> <span class="variable">cursor</span> <span class="operator">=</span>	contentResolver.query(ContactsContract.Contacts.CONTENT_URI, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<ol start="4" type="1">
<li>遍历<strong>cursor</strong>，获取对应字段的值</li>
</ol>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906141831356.png" alt="image-20220906141831356" style="zoom:80%;" /></p>
<h4 id="查询获取系统相册中的视频文件">7.2.2
查询：获取系统相册中的视频文件</h4>
<blockquote>
<ol type="1">
<li><strong>AndroidManifest</strong> 权限声明</li>
</ol>
</blockquote>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">&lt;uses-permission <span class="attr">android:</span>name=<span class="string">&quot;android.permission.READ_EXTERNAL_STORAGE&quot;</span> /&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<ol start="2" type="1">
<li>在程序中动态请求权限</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (ContextCompat.checkSelfPermission(<span class="built_in">this</span>, Manifest.permission.READ_EXTERNAL_STORAGE)</span><br><span class="line">    	!= PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">    ActivityCompat.requestPermissions(<span class="built_in">this</span>, <span class="keyword">new</span> <span class="title class_">String</span>[] &#123;</span><br><span class="line">        Manifest.permission.READ_EXTERNAL_STORAGE</span><br><span class="line">    &#125;, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<ol start="3" type="1">
<li>通过<strong>ContentResolver</strong>查询</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获取 ContentResolver 对象</span></span><br><span class="line"><span class="type">ContentResolver</span> <span class="variable">contentResolver</span> <span class="operator">=</span> <span class="built_in">this</span>.getContentResolver();</span><br><span class="line"><span class="type">Cursor</span> <span class="variable">cursor</span> <span class="operator">=</span> contentResolver.query(MediaStore.Video.Media.EXTERNAL_CONTENT_URI, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>,<span class="literal">null</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906141600052.png" alt="image-20220906141600052" style="zoom:80%;" /></p>
<h4 id="读取uri对应的图片到imageview中">7.2.3
读取URI对应的图片到ImageView中</h4>
<blockquote>
<ol type="1">
<li><strong>AndroidManifest</strong> 权限声明</li>
</ol>
</blockquote>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">&lt;uses-permission <span class="attr">android:</span>name=<span class="string">&quot;android.permission.READ_EXTERNAL_STORAGE&quot;</span> /&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<ol start="2" type="1">
<li>在程序中动态请求权限</li>
<li>重写<strong>onRequestPermissionsResult()</strong>方法，定义授权后的操作</li>
<li>重写<strong>onActivityResult()</strong>方法，定义选择图片之后的操作</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(LayoutInflater inflater, ViewGroup container,</span></span><br><span class="line"><span class="params">                         Bundle savedInstanceState)</span> &#123;</span><br><span class="line">    <span class="comment">// Inflate the layout for this fragment</span></span><br><span class="line">    <span class="type">View</span> <span class="variable">view</span> <span class="operator">=</span> inflater.inflate(R.layout.fragment_my_settings, container, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">    userIcon = view.findViewById(R.id.icon_my_setting_user_info);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 进行一个判断，是否已经有访问权限，如果没有先获取</span></span><br><span class="line">    <span class="keyword">if</span>(ContextCompat.checkSelfPermission(getContext(), Manifest.permission.READ_EXTERNAL_STORAGE)</span><br><span class="line">       		!= PackageManager.PERMISSION_GRANTED)&#123;</span><br><span class="line">        </span><br><span class="line">        ActivityCompat.requestPermissions(getActivity(), </span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;Manifest.permission.READ_EXTERNAL_STORAGE&#125;, <span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">        Toast.makeText(getActivity(),<span class="string">&quot;请授予权限&quot;</span>, Toast.LENGTH_SHORT);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">// 已经有权限了, 直接执行操作</span></span><br><span class="line">        readImageFromStorage();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    userIcon.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">            <span class="comment">// 点击后打开本地图库选择照片</span></span><br><span class="line">            <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(Intent.ACTION_PICK, <span class="literal">null</span>);</span><br><span class="line">            intent.setDataAndType(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, <span class="string">&quot;image/*&quot;</span>);</span><br><span class="line">            startActivityForResult(intent, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> view;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequiresApi(api = Build.VERSION_CODES.O)</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onRequestPermissionsResult</span><span class="params">(<span class="type">int</span> requestCode, <span class="meta">@NonNull</span> String[] permissions, <span class="meta">@NonNull</span> <span class="type">int</span>[] grantResults)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.onRequestPermissionsResult(requestCode, permissions, grantResults);</span><br><span class="line">    <span class="keyword">if</span>(requestCode == <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(grantResults.length &gt; <span class="number">0</span> &amp;&amp; grantResults[<span class="number">0</span>] == PackageManager.PERMISSION_GRANTED)&#123;</span><br><span class="line">            readImageFromStorage();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        Toast.makeText(getActivity(), <span class="string">&quot;授权失败&quot;</span>, Toast.LENGTH_SHORT);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onActivityResult</span><span class="params">(<span class="type">int</span> requestCode, <span class="type">int</span> resultCode, <span class="meta">@Nullable</span> Intent data)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.onActivityResult(requestCode, resultCode, data);</span><br><span class="line">    <span class="keyword">if</span>(requestCode == <span class="number">1</span> &amp;&amp; resultCode == RESULT_OK)&#123;</span><br><span class="line">        <span class="keyword">if</span>(data != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="type">Uri</span> <span class="variable">uri</span> <span class="operator">=</span> data.getData();</span><br><span class="line">            userIcon.setImageURI(uri);</span><br><span class="line">            saveImageToStorage(uri);</span><br><span class="line">            Log.e(TAG, <span class="string">&quot;onActivityResult: 设置图片的路径为&quot;</span> + uri.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<ol start="4" type="1">
<li>自定义<strong>readImageFromStorage()</strong>方法通过URI读取图片</li>
<li>自定义<strong>saveImageToStorage()</strong>方法保存URI</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Constants</span> &#123;</span><br><span class="line">    <span class="comment">// 本地用户的图标</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">USER_ICON_SAVE_SP</span> <span class="operator">=</span> <span class="string">&quot;USER_ICON&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">USER_ICON_SAVE_KEY</span> <span class="operator">=</span> <span class="string">&quot;user_icon&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@RequiresApi(api = Build.VERSION_CODES.O)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">readImageFromStorage</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">SharedPreferences</span> <span class="variable">sp</span> <span class="operator">=</span> getActivity().getSharedPreferences(Constants.USER_ICON_SAVE_SP, Context.MODE_PRIVATE);</span><br><span class="line">    <span class="type">String</span> <span class="variable">uriString</span> <span class="operator">=</span> sp.getString(Constants.USER_ICON_SAVE_KEY, <span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">if</span>(uriString == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">Uri</span> <span class="variable">uri</span> <span class="operator">=</span> Uri.parse(uriString);</span><br><span class="line">    userIcon.setImageURI(uri);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveImageToStorage</span><span class="params">(Uri uri)</span>&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">uriString</span> <span class="operator">=</span> uri.toString();</span><br><span class="line">    <span class="type">SharedPreferences</span> <span class="variable">sp</span> <span class="operator">=</span> getActivity().getSharedPreferences(Constants.USER_ICON_SAVE_SP, Context.MODE_PRIVATE);</span><br><span class="line">    SharedPreferences.<span class="type">Editor</span> <span class="variable">editor</span> <span class="operator">=</span> sp.edit();</span><br><span class="line">    editor.putString(Constants.USER_ICON_SAVE_KEY, uriString);</span><br><span class="line">    editor.commit();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="day7-android多媒体基础">Day7 Android多媒体基础</h1>
<h2 id="一图片基础">一、图片基础</h2>
<h3 id="图片基础颜色空间">1.1 图片基础：颜色空间</h3>
<p>RGB色彩空间(R=Red, G=Green, B=Blue, A=Alpha)</p>
<ol type="1">
<li><strong>ALPHA_8</strong>：A = 8位，1字节</li>
<li><strong>RGB_565</strong>：R = 5位 G = 6位 B = 5位，2字节</li>
<li><strong>ARGB_4444</strong>：A = 4位 R = 4位 G = 4位 B =
4位，2字节</li>
<li><strong>ARGB_8888</strong>：A = 8位 R = 8位 G = 8位 B =
8位，4字节</li>
</ol>
<h3 id="图片存储位图">1.2 图片存储：位图</h3>
<ol type="1">
<li><p>位图以像素(方格点)构成图像，放大时会失真</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906195359445.png" alt="image-20220906195359445" style="zoom:80%;" /></p></li>
</ol>
<h3 id="图片格式压缩标准方案">1.3 图片格式：压缩标准方案</h3>
<p><strong>JPEG</strong>：Joint Photographic Experts Group
有损压缩方案</p>
<ol type="1">
<li>去除冗余的图像和彩色数据</li>
<li>压缩比相对较⾼，⽂件大小相对较小</li>
<li>不支持透明图和动态图</li>
</ol>
<p><strong>PNG</strong>：全称Portable Network Graphics</p>
<ol type="1">
<li>高压缩比的<strong>无损压缩</strong>，⽂件大小比jpeg⾼些</li>
<li>最多⽀持48位⾊彩</li>
<li>支持<strong>α通道</strong>数据(透明度)</li>
<li>是Android开发上常用的图片格式，例如图标</li>
</ol>
<p><strong>WebP</strong>是谷歌提供的⼀种⽀持有损压缩和无损压缩的图片文件格式</p>
<ol type="1">
<li>比JPEG或PNG更好的压缩</li>
<li>在Android 4.0(API level 14)中支持有损的WebP图像</li>
<li>在Android 4.3(API level 18)和更高版本中支持无损和透明的WebP图像</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906195738520.png" alt="image-20220906195738520" style="zoom:80%;" /></p>
<h3 id="图片存储矢量图">1.4 图片存储：矢量图</h3>
<ol type="1">
<li>矢量图使用线段和曲线描述图像，由数学向量构成图形图像</li>
<li>可以被无限放大而不影响质量</li>
</ol>
<h2 id="二android图片加载">二、Android图片加载</h2>
<h3 id="graphics包安卓平台2d图形绘制的基础">2.1
Graphics包：安卓平台2D图形绘制的基础</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906200013440.png" alt="image-20220906200013440" style="zoom:80%;" /></p>
<h3 id="android-bitmap一种存储像素的数据结构">2.2 Android
Bitmap：一种存储像素的数据结构</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906200257970.png" alt="image-20220906200257970" style="zoom:80%;" /></p>
<h3 id="图片加载">2.3 图片加载</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906200618941.png" alt="image-20220906200618941" style="zoom:80%;" /></p>
<h3 id="加载超大图片">2.4 加载超大图片</h3>
<p>加载的图片过大，可能会出现<strong>OOM(Out of Memory)</strong></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906201121241.png" alt="image-20220906201121241" style="zoom:80%;" /></p>
<h3 id="大图分块加载">2.5 大图分块加载</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906201932153.png" alt="image-20220906201932153" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906201944970.png" alt="image-20220906201944970" style="zoom:80%;" /></p>
<h3 id="图片自适应ninepatchdrawable">2.6
图片自适应：NinePatchDrawable</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906202051154.png" alt="image-20220906202051154" style="zoom:80%;" /></p>
<h3 id="imageview-1">2.7 ImageView</h3>
<ol type="1">
<li><p>ImageView：显示图片的组件</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906202112375.png" alt="image-20220906202112375" style="zoom:80%;" /></p>
<p>https://developer.android.com/reference/android/widget/ImageView.ScaleType</p></li>
<li><p><strong>ImageView.ScaleType</strong>：主要值设置所显示的图片如何缩放或移动以适应ImageView的大小</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906202606810.png" alt="image-20220906202606810" style="zoom:80%;" /></p></li>
</ol>
<h3 id="drawable">2.8 Drawable</h3>
<ol type="1">
<li><p><strong>Drawable</strong>在 <strong>View 2D</strong>
绘画里是⼀个很重要的抽象类，抽象出了怎么画，画什么的⼀个概念</p></li>
<li><p>有很多子类</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906202902180.png" alt="image-20220906202902180" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906202830183.png" alt="image-20220906202830183" style="zoom:80%;" /></p></li>
</ol>
<h3 id="常见图片库">2.9 常见图片库</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906203019084.png" alt="image-20220906203019084" style="zoom:80%;" /></p>
<h3 id="glide">2.10 Glide</h3>
<h4 id="glide的基础使用">2.10.1 Glide的基础使用</h4>
<ol type="1">
<li><strong>Glide</strong>是⼀个快速高效的<strong>Android</strong>图片加载库，提供了易用的<strong>API</strong>，高性能、可扩展的图⽚解码管道</li>
</ol>
<blockquote>
<p>在<strong>build.grade</strong>里面添加引用</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">implementation &#x27;com.github.bumptech.glide:glide:4.9.0&#x27;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在代码中使用<strong>Glide</strong></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Glide.with(context)</span><br><span class="line">	.load(uri)</span><br><span class="line">	.into(imageView);</span><br></pre></td></tr></table></figure>
<h4 id="glide流程">2.10.2 Glide流程</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906203447657.png" alt="image-20220906203447657" style="zoom:80%;" /></p>
<h4 id="glide-requestbuilder">2.10.3 Glide RequestBuilder</h4>
<ol type="1">
<li><strong>RequestBuilder</strong>是Glide中请求的骨架，负责携带请求的<strong>url</strong>和你的设置项来开始⼀个新的加载过程。
使用<strong>RequestBuilder</strong> 可以指定:
<ol type="1">
<li>你想加载的资源类型(<strong>Bitmap</strong>,
<strong>Drawable</strong>, 或其他)</li>
<li>你要加载的资源地址(<strong>url</strong>/<strong>model</strong>)</li>
<li>你想最终加载到的<strong>View</strong></li>
<li>任何你想应用的(⼀个或多个)<strong>RequestOption</strong> 对象</li>
<li>任何你想应用的(⼀个或多个)<strong>TransitionOption</strong>
对象</li>
<li>任何你想加载的缩略图 <strong>thumbnail</strong>()</li>
</ol></li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">RequestBuilder&lt;Drawable&gt; requestBuilder = Glide.with(fragment).asDrawable();</span><br><span class="line"></span><br><span class="line">RequestBuilder&lt;Drawable&gt; requestBuilder = Glide.with(fragment).load(url);</span><br></pre></td></tr></table></figure>
<h4 id="glide-requestoptions">2.10.4 Glide RequestOptions</h4>
<p><strong>Glide</strong>中的很多设置项都可以通过
<strong>RequestOptions</strong> 类和 <strong>apply()</strong>
方法来应用到程序中</p>
<p>使用<strong>Request Options</strong>可以实现(包括但不限于):</p>
<ol type="1">
<li>转换(Transformations)</li>
<li>缓存策略(Caching Strategies)</li>
<li>组件特有的设置项，例如编码质量，或Bitmap的解码配置等</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">RequestOptions</span> <span class="variable">cropOptions</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RequestOptions</span>();</span><br><span class="line">cropOptions.circleCrop(); </span><br><span class="line">Glide.with(ImageActivity.<span class="built_in">this</span>)</span><br><span class="line">    .load(uri3)</span><br><span class="line">    .apply(cropOptions)</span><br><span class="line">    .into(imageView);</span><br></pre></td></tr></table></figure>
<h3 id="图片缓存策略">2.11 图片缓存策略</h3>
<p>为了提升用户体验，图片展示的目标</p>
<ol type="1">
<li>每次以最快的速度打开图片</li>
<li>减少网络流量的消耗</li>
<li>都缓存在内存，容易出现OOM</li>
</ol>
<p>如何控制缓存大小：<strong>LRU</strong>(Least Recently Used)</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906204038719.png" alt="image-20220906204038719" style="zoom:80%;" /></p>
<h2 id="三音视频播放">三、音视频播放</h2>
<h3 id="视频帧">3.1 视频帧</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906204329793.png" alt="image-20220906204329793" style="zoom:80%;" /></p>
<h3 id="视频编码">3.2 视频编码</h3>
<p>视频编码：通过特定的压缩技术，将某个视频内容数据转换成另⼀种特定格式文件的方式</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906204620020.png" alt="image-20220906204620020" style="zoom:80%;" /></p>
<h3 id="视频封装格式">3.3 视频封装格式</h3>
<p>PC和移动设备上都离不开视频播放，涉及的视频格式也比较多，不同扩展名实际上使用了不同的视频和音频编码</p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906204714348.png" alt="image-20220906204714348" style="zoom:80%;" /></p>
<h3 id="视频播放">3.4 视频播放</h3>
<ol type="1">
<li>视频解码播放的⼤部分流程，整个视频播放的流程如右图所示</li>
<li>视频文件都会有特定的封装格式、比特率、时长等信息</li>
<li>视频解封装之后，对应视频流和⾳频流。</li>
<li>解复用之后的⾳视频有自己独立的参数，包括
<ol type="1">
<li>编码方式、采样率、画面大小等</li>
<li>音频参数包括采样率、编码方式和声道数等</li>
</ol></li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906205043235.png" alt="image-20220906205043235" style="zoom:80%;" /></p>
<h3 id="android音频播放">3.5 Android音频播放</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906205244255.png" alt="image-20220906205244255" style="zoom:80%;" /></p>
<h3 id="media-player">3.6 Media Player</h3>
<blockquote>
<p><strong>Android</strong>音视频播放相关类：<strong>MediaPlayer</strong></p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906205319512.png" alt="image-20220906205319512" style="zoom:80%;" /></p>
<h3 id="mediaplayer播放视频">3.7 MediaPlayer播放视频</h3>
<blockquote>
<p><strong>MediaPlayer</strong>需要配合<strong>SurfaceHolder</strong></p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906205555970.png" alt="image-20220906205555970" style="zoom:80%;" /></p>
<h3 id="videoview播放视频">3.8 VideoView播放视频</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906205647513.png" alt="image-20220906205647513" style="zoom:80%;" /></p>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906205709970.png" alt="image-20220906205709970" style="zoom:80%;" /></p>
<h3 id="第三方播放器">3.9 第三方播放器</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220906205730172.png" alt="image-20220906205730172" style="zoom:80%;" /></p>
<h1 id="day8-android多媒体进阶">Day8 Android多媒体进阶</h1>
<h2 id="一视频介绍">一、视频介绍</h2>
<h3 id="视觉成像的基础原理">1.1 视觉成像的基础原理</h3>
<h4 id="视网膜视锥细胞">1.1.1 视网膜：视锥细胞</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907165815403.png" alt="image-20220907165815403" style="zoom:80%;" /></p>
<h4 id="rgbred-green-blue">1.1.2 RGB：Red, Green, Blue</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907114039455.png" alt="image-20220907114039455" style="zoom:80%;" /></p>
<h4 id="yuvluma-chroma">1.1.3 YUV：Luma &amp; Chroma</h4>
<ol type="1">
<li><strong>Luma</strong>：黑白值，人眼对其比较敏感</li>
<li><strong>Chroma</strong>：彩度</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907114118012.png" alt="image-20220907114118012" style="zoom:80%;" /></p>
<h4 id="chroma下采样yuv420">1.1.4 Chroma下采样：YUV420</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907115145731.png" alt="image-20220907115145731" style="zoom:80%;" /></p>
<h3 id="视频是什么">1.2 视频是什么</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907115216486.png" alt="image-20220907115216486" style="zoom:80%;" /></p>
<h3 id="分辨率帧率码率">1.3 分辨率、帧率、码率</h3>
<ol type="1">
<li><p><strong>分辨率</strong>：图像内像素的数量，通常使用宽*高表示</p>
<ol type="1">
<li><strong>HD</strong>：全高清，1920*1080</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907115255261.png" alt="image-20220907115255261" style="zoom:80%;" /></p></li>
<li><p><strong>帧率</strong>：每秒钟播放的图片数量，单位是<strong>FPS</strong></p>
<ol type="1">
<li>帧率越高，视频越连续</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907170259982.png" alt="image-20220907170259982" style="zoom:80%;" /></p></li>
<li><p><strong>码率</strong>：视频文件在单位时间内使用的数据流量，单位是<strong>kbps</strong>(千位每秒)</p>
<ol type="1">
<li><strong>视频大小 = duration时长(s) × kbps 千位每秒 / 8 =
xxMB</strong></li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907170420352.png" alt="image-20220907170420352" style="zoom:80%;" /></p></li>
</ol>
<h3 id="视频编码-1">1.4 视频编码</h3>
<h4 id="原理">1.4.1 原理</h4>
<ol type="1">
<li><strong>空间冗余</strong>：图像相邻像素之间有较强的相关性</li>
<li><strong>时间冗余</strong>：视频序列的相邻图像之间内容相似，可以压缩成⼀个关键帧+变化差值</li>
<li><strong>感知冗余</strong>：在人在观看视频时，人眼无法察觉的信息</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907170520111.png" alt="image-20220907170520111" style="zoom:67%;" /></p>
<h4 id="ibp帧">1.4.2 I/B/P帧</h4>
<ol type="1">
<li><strong>I帧</strong>：关键帧，去除<strong>空间冗余</strong>信息</li>
<li><strong>P帧</strong>：前向预测帧，去除<strong>时间冗余</strong>信息</li>
<li><strong>B帧</strong>：双向预测帧，去除<strong>时间冗余</strong>信息</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907170655294.png" alt="image-20220907170655294" style="zoom:80%;" /></p>
<h4 id="编码格式">1.4.3 编码格式</h4>
<ol type="1">
<li>⽬前主要使用的编码格式有<strong>H264</strong>和<strong>H265</strong>
<ol type="1">
<li><strong>H264</strong>可以达到百倍的压缩率</li>
<li><strong>H265</strong>比<strong>H264</strong>的压缩率增加⼀倍</li>
</ol></li>
</ol>
<h4 id="封装格式">1.4.4 封装格式</h4>
<ol type="1">
<li>把视频码流和音频码流按照⼀定的格式存储在⼀个文件中</li>
<li>与编码格式无关</li>
<li>常用的格式有<strong>MP4</strong>，<strong>AVI</strong>，<strong>FLV</strong>，<strong>RMVB</strong>等</li>
</ol>
<h2 id="二相机拍照">二、相机拍照</h2>
<h3 id="调起系统相机">2.1 调起系统相机</h3>
<blockquote>
<p>打开系统相机</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907171037772.png" alt="image-20220907171037772" style="zoom:80%;" /></p>
<blockquote>
<p>接收数据，拿到返回的<strong>bitmap</strong>，并显示在屏幕上</p>
<ol type="1">
<li>接收到的<strong>bitmap</strong>，默认会被进行压缩</li>
</ol>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907171112102.png" alt="image-20220907171112102" style="zoom:80%;" /></p>
<h3 id="自定义存储路径">2.2 自定义存储路径</h3>
<blockquote>
<p>申请存储权限</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907171301200.png" alt="image-20220907171301200" style="zoom:80%;" /></p>
<blockquote>
<p>创建文件</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907171320818.png" alt="image-20220907171320818" style="zoom:80%;" /></p>
<blockquote>
<p>获取<strong>content:// URI</strong></p>
<ol type="1">
<li><strong>7.0</strong>以上手机不允许使用<strong>file://
URI</strong>跳出应⽤</li>
<li><strong>android:authorities</strong>：需要是唯一的字符串，后面会用到</li>
<li><strong>android:resource</strong>：<span class="citation"
data-cites="xml/file_paths打开是下面的代码">@xml/file_paths打开是下面的代码</span></li>
</ol>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907171847367.png" alt="image-20220907171847367" style="zoom:80%;" /></p>
<blockquote>
<p><strong><span class="citation"
data-cites="xml/file_paths">@xml/file_paths</span></strong></p>
<ol type="1">
<li>通过<strong>external-files-path</strong>的方式，保证路径是<strong>Android/data/com.bytedance.camera.demo/files/Pictures</strong></li>
</ol>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907171905455.png" alt="image-20220907171905455" style="zoom:80%;" /></p>
<blockquote>
<p>设置存储地址</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907172107027.png" alt="image-20220907172107027" style="zoom:80%;" /></p>
<h3 id="显示图片">2.3 显示图片</h3>
<blockquote>
<p>防止内存溢出：</p>
<ol type="1">
<li>获取<strong>view</strong>的宽高</li>
<li>获取图片的宽高
<ol type="1">
<li>使用<strong>Options.inJustDecodeBounds =
true</strong>，不返回实际的<strong>bitmap</strong>文件，只获取其属性</li>
</ol></li>
<li>计算缩放比例</li>
<li>获取<strong>bitmap</strong></li>
<li>显示在屏幕上</li>
</ol>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907172323198.png" alt="image-20220907172323198" style="zoom:80%;" /></p>
<h3 id="显示效果">2.4 显示效果</h3>
<blockquote>
<ol type="1">
<li>读取的图片旋转角度
<ol type="1">
<li>通过<strong>ExitInterface.getAttributeInt()</strong>获取旋转角度</li>
</ol></li>
<li>在<strong>matrix</strong>中设置要旋转的角度</li>
<li>旋转图片</li>
</ol>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907172904808.png" alt="image-20220907172904808" style="zoom:80%;" /></p>
<h2 id="三简单录制">三、简单录制</h2>
<h3 id="调起系统相机-1">3.1 调起系统相机</h3>
<blockquote>
<p>调起相机的录像界面</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907173337047.png" alt="image-20220907173337047" style="zoom:80%;" /></p>
<h3 id="显示录制视频">3.2 显示录制视频</h3>
<blockquote>
<p>获取拍摄的视频，并显示在界面上，开始播放</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907173403949.png" alt="image-20220907173403949" style="zoom:80%;" /></p>
<h3 id="将视频存储到自定义存储路径中">3.3
将视频存储到自定义存储路径中</h3>
<p>与<strong>2.2</strong>类似</p>
<h3 id="查看数据">3.4 查看数据</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907173502070.png" alt="image-20220907173502070" style="zoom:80%;" /></p>
<h2 id="四自定义录制">四、自定义录制</h2>
<h3 id="获取camera实例">4.1 获取Camera实例</h3>
<blockquote>
<p>申请权限</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907173635705.png" alt="image-20220907173635705" style="zoom:80%;" /></p>
<blockquote>
<p>可用摄像头的数量</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Camera.getNumberOfCameras</span><br></pre></td></tr></table></figure>
<blockquote>
<p>获取后置摄像头</p>
<ol type="1">
<li>使用<strong>camera.setDisplayOrientation()</strong>方法，旋转预览图片</li>
</ol>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907173717133.png" alt="image-20220907173717133" style="zoom:80%;" /></p>
<h3 id="摄像头数据实时显示">4.2 摄像头数据实时显示</h3>
<blockquote>
<p>使用控件：</p>
<ol type="1">
<li><strong>SurfaceView</strong></li>
</ol>
<p>关键类：</p>
<ol type="1">
<li><strong>Camera</strong>：使用的摄像头</li>
<li><strong>SurfaceView</strong>：预览类
<ol type="1">
<li>一个<strong>SurfaceView</strong>通常有两个<strong>Surface</strong>：双缓冲区</li>
</ol></li>
<li><strong>SurfaceHolder</strong>：<strong>Surface</strong>的持有者
<ol type="1">
<li>通过<strong>SurfaceHolder</strong>对Surface进行生命周期的管理</li>
</ol></li>
<li><strong>SurfaceHolder.Callback</strong>：</li>
</ol>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907173808801.png" alt="image-20220907173808801" style="zoom:80%;" /></p>
<h3 id="surfaceview">4.3 SurfaceView</h3>
<ol type="1">
<li>拥有独立绘图层的特殊View</li>
<li>双缓冲机制</li>
<li>通过在Window上面“挖洞”（设置透明区域）进行显示</li>
</ol>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907174336816.png" alt="image-20220907174336816" style="zoom:80%;" /></p>
<h3 id="处理activity的声明周期对预览的影响">4.4
处理Activity的声明周期对预览的影响</h3>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907174458829.png" alt="image-20220907174458829" style="zoom:80%;" /></p>
<h3 id="拍摄一张实时图片">4.5 拍摄一张实时图片</h3>
<blockquote>
<p>使用<strong>Camera API</strong>拍照</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">mCamera.takePicture(<span class="literal">null</span>,<span class="literal">null</span>,mPicture);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>拍照后继续预览</p>
</blockquote>
<figure>
<img
src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907174611358.png"
alt="image-20220907174611358" />
<figcaption aria-hidden="true">image-20220907174611358</figcaption>
</figure>
<h3 id="mediarecorder">4.6 MediaRecorder</h3>
<h4 id="mediarecorder的状态机">4.6.1 MediaRecorder的状态机</h4>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907174802680.png" alt="image-20220907174802680" style="zoom:80%;" /></p>
<h4 id="开始录制按部就班">4.6.2 开始录制（按部就班）</h4>
<blockquote>
<ol type="1">
<li>解锁<strong>Camera</strong></li>
<li>设置音频、视频源</li>
<li>设置视频的编码格式、输出效果</li>
<li>设置视频文件的保存位置</li>
<li>设置<strong>Surface</strong></li>
<li>让<strong>MediaRecorder</strong>处于prepare状态</li>
<li>开启<strong>MediaRecorder</strong></li>
</ol>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907174909098.png" alt="image-20220907174909098" style="zoom:80%;" /></p>
<h4 id="结束录制按部就班">4.6.3 结束录制（按部就班）</h4>
<blockquote>
<ol type="1">
<li>停止<strong>MediaRecorder</strong></li>
<li>重置<strong>MediaRecorder</strong></li>
<li>释放<strong>MediaRecorder</strong></li>
<li>锁定<strong>Camera</strong></li>
</ol>
</blockquote>
<p><img src="https://raw.githubusercontent.com/unicorn2022/Pictures/main/AssetMarkdown/image-20220907174933063.png" alt="image-20220907174933063" style="zoom:80%;" /></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="unicorn2022.github.io">华丰夏</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://hzoi-unicorn.top/2022/08/29/%E4%B8%93%E4%B8%9A%E8%AF%BE%E7%AC%94%E8%AE%B0/Android%E5%BC%80%E5%8F%91/">https://hzoi-unicorn.top/2022/08/29/专业课笔记/Android开发/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://hzoi-unicorn.top" target="_blank">华风夏韵</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/">专业课</a></div><div class="post_share"><div class="social-share" data-image="/img/avatar.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2022/09/12/%E4%B8%93%E4%B8%9A%E8%AF%BE%E7%AC%94%E8%AE%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="操作系统"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">操作系统</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/06/03/%E6%8C%87%E4%BB%A4%E5%90%88%E9%9B%86/cmake%E6%8C%87%E4%BB%A4%E5%90%88%E9%9B%86/" title="cmake指令合集"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-03</div><div class="title">cmake指令合集</div></div></a></div><div><a href="/2023/06/02/%E6%8C%87%E4%BB%A4%E5%90%88%E9%9B%86/cmake%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="cmake学习笔记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-02</div><div class="title">cmake学习笔记</div></div></a></div><div><a href="/2023/03/04/%E4%B8%93%E4%B8%9A%E8%AF%BE%E7%AC%94%E8%AE%B0/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" title="人工智能"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-04</div><div class="title">人工智能</div></div></a></div><div><a href="/2023/03/03/%E4%B8%93%E4%B8%9A%E8%AF%BE%E7%AC%94%E8%AE%B0/%E5%A4%9A%E5%AA%92%E4%BD%93%E6%8A%80%E6%9C%AF/" title="多媒体技术"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-03</div><div class="title">多媒体技术</div></div></a></div><div><a href="/2023/03/02/%E4%B8%93%E4%B8%9A%E8%AF%BE%E7%AC%94%E8%AE%B0/%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86%E5%AF%BC%E8%AE%BA/" title="自然语言处理导论"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-02</div><div class="title">自然语言处理导论</div></div></a></div><div><a href="/2023/03/01/%E4%B8%93%E4%B8%9A%E8%AF%BE%E7%AC%94%E8%AE%B0/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" title="编译原理"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-01</div><div class="title">编译原理</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">华丰夏</div><div class="author-info__description">一切都是上天最好的安排</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">48</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/unicorn2022"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/unicorn2022" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:496300118@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">愿你前行的道路有群星闪耀。愿你留下的足迹有百花绽放。你即是上帝的馈赠，世界因你而瑰丽。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#day1-android%E7%AE%80%E4%BB%8B"><span class="toc-text">Day1 Android简介</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%AB%E6%8D%B7%E9%94%AE"><span class="toc-text">快捷键</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C"><span class="toc-text">运行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E5%BF%97"><span class="toc-text">日志</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%BC%80%E5%A7%8B%E5%90%AF%E7%A8%8B--%E4%BD%A0%E7%9A%84%E7%AC%AC%E4%B8%80%E8%A1%8Candroid%E4%BB%A3%E7%A0%81"><span class="toc-text">第一章
开始启程--你的第一行Android代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#android%E7%9A%84%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6"><span class="toc-text">1.1 Android的四大组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E7%9B%AE%E5%BD%95"><span class="toc-text">1.2 项目目录</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#gradle%E5%92%8Cidea"><span class="toc-text">1.2.1 .gradle和idea</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#app"><span class="toc-text">1.2.2 app</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#build"><span class="toc-text">1.2.3 build</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gradle"><span class="toc-text">1.2.4 gradle</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gitignore"><span class="toc-text">1.2.5 . gitignore</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#build.gradle"><span class="toc-text">1.2.6 build.gradle</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gradle.properties"><span class="toc-text">1.2.7 gradle.properties</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gradlew%E5%92%8Cgradlew.bat"><span class="toc-text">1.2.8 gradlew和gradlew.bat</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#helloworld.iml"><span class="toc-text">1.2.9 HelloWorld.iml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#local.properties"><span class="toc-text">1.2.10 local.properties</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#settings.gradle"><span class="toc-text">1.2.11 settings.gradle</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#app%E7%9B%AE%E5%BD%95"><span class="toc-text">1.3 app目录</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#build-1"><span class="toc-text">1.3.1 build</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#libs"><span class="toc-text">1.3.2 libs</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#androidtest"><span class="toc-text">1.3.3 androidTest</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#java"><span class="toc-text">1.3.4 java</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#res"><span class="toc-text">1.3.5 res</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#androidmanifest.xml"><span class="toc-text">1.3.6 AndroidManifest.xml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#test"><span class="toc-text">1.3.7 test</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gitignore-1"><span class="toc-text">1.3.8 .gitignore</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#app.iml"><span class="toc-text">1.3.9 app.iml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#build.gradle-1"><span class="toc-text">1.3.10 build.gradle</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#proguard-rules.pro"><span class="toc-text">1.3.11 proguard-rules.pro</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E7%9A%84%E8%BF%90%E8%A1%8C"><span class="toc-text">1.4 项目的运行</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#androidmanifest.xml%E6%B3%A8%E5%86%8C%E6%B4%BB%E5%8A%A8"><span class="toc-text">1.4.1
AndroidManifest.xml：注册活动</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mainactivity.java"><span class="toc-text">1.4.2 MainActivity.java</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#activity_main.xml"><span class="toc-text">1.4.3 activity_main.xml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#resvaluesstrings.xml"><span class="toc-text">1.4.4 res&#x2F;values&#x2F;strings.xml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#build.gradle-2"><span class="toc-text">1.4.5 build.gradle</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E5%B7%A5%E5%85%B7log"><span class="toc-text">1.5 日志工具Log</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E5%B7%A5%E5%85%B7%E7%B1%BB%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">1.5.1 日志工具类的使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#logcat%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">1.5.2 Logcat的使用</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#day2-android%E5%9F%BA%E7%A1%80ui%E5%BC%80%E5%8F%91"><span class="toc-text">Day2 Android基础UI开发</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E5%85%88%E4%BB%8E%E7%9C%8B%E5%BE%97%E5%88%B0%E7%9A%84%E5%85%A5%E6%89%8B--%E6%8E%A2%E7%A9%B6%E6%B4%BB%E5%8A%A8"><span class="toc-text">第二章
先从看得到的入手--探究活动</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B4%BB%E5%8A%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="toc-text">2.1 活动的基本用法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E5%88%9B%E5%BB%BA%E6%B4%BB%E5%8A%A8"><span class="toc-text">2.1.1 手动创建活动</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%92%8C%E5%8A%A0%E8%BD%BD%E5%B8%83%E5%B1%80"><span class="toc-text">2.1.2 创建和加载布局</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8androidmainfest%E6%96%87%E4%BB%B6%E4%B8%AD%E6%B3%A8%E5%86%8C"><span class="toc-text">2.1.3
在AndroidMainfest文件中注册</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8%E6%B4%BB%E5%8A%A8%E4%B8%AD%E4%BD%BF%E7%94%A8toast"><span class="toc-text">2.1.4 在活动中使用Toast</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8%E6%B4%BB%E5%8A%A8%E4%B8%AD%E4%BD%BF%E7%94%A8menu"><span class="toc-text">2.1.5 在活动中使用Menu</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%94%80%E6%AF%81%E4%B8%80%E4%B8%AA%E6%B4%BB%E5%8A%A8"><span class="toc-text">2.1.6 销毁一个活动</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8intent%E5%9C%A8%E6%B4%BB%E5%8A%A8%E4%B9%8B%E9%97%B4%E7%A9%BF%E6%A2%AD"><span class="toc-text">2.2 使用Intent在活动之间穿梭</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%98%BE%E5%BC%8Fintent"><span class="toc-text">2.2.1 使用显式Intent</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E9%9A%90%E5%BC%8Fintent"><span class="toc-text">2.2.2 使用隐式Intent</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E5%A4%9A%E9%9A%90%E5%BC%8Fintent%E7%9A%84%E7%94%A8%E6%B3%95"><span class="toc-text">2.2.3 更多隐式Intent的用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%91%E4%B8%8B%E4%B8%80%E4%B8%AA%E6%B4%BB%E5%8A%A8%E4%BC%A0%E9%80%92%E6%95%B0%E6%8D%AE"><span class="toc-text">2.2.4 向下一个活动传递数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E6%95%B0%E6%8D%AE%E7%BB%99%E4%B8%8A%E4%B8%80%E4%B8%AA%E6%B4%BB%E5%8A%A8"><span class="toc-text">2.2.5 返回数据给上一个活动</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B4%BB%E5%8A%A8%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-text">2.3 活动的生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E6%A0%88-back-stack"><span class="toc-text">2.3.1 返回栈 Back Stack</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B4%BB%E5%8A%A8%E7%8A%B6%E6%80%81"><span class="toc-text">2.3.2 活动状态</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B4%BB%E5%8A%A8%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F-1"><span class="toc-text">2.3.3 活动的生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AF%B9%E5%BA%94%E7%9A%847%E4%B8%AA%E5%9B%9E%E8%B0%83%E6%96%B9%E6%B3%95"><span class="toc-text">2.3.3.1 对应的7个回调方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B0%86%E6%B4%BB%E5%8A%A8%E6%B3%A8%E5%86%8C%E4%B8%BA%E5%AF%B9%E8%AF%9D%E6%A1%86"><span class="toc-text">2.3.3.2 将活动注册为对话框</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B4%BB%E5%8A%A8%E8%A2%AB%E5%9B%9E%E6%94%B6%E4%BA%86%E6%80%8E%E4%B9%88%E5%8A%9E"><span class="toc-text">2.3.4 活动被回收了怎么办</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B4%BB%E5%8A%A8%E7%9A%84%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F"><span class="toc-text">2.4 活动的启动模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#standard"><span class="toc-text">2.4.1 standard</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#singletop"><span class="toc-text">2.4.2 singleTop</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#singletask"><span class="toc-text">2.4.3 singleTask</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#singleinstance"><span class="toc-text">2.4.4 singleInstance</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B4%BB%E5%8A%A8%E7%9A%84%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-text">2.5 活动的最佳实践</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9F%A5%E6%99%93%E5%BD%93%E5%89%8D%E6%98%AF%E5%9C%A8%E5%93%AA%E4%B8%80%E4%B8%AA%E6%B4%BB%E5%8A%A8"><span class="toc-text">2.5.1 知晓当前是在哪一个活动</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9A%8F%E6%97%B6%E9%9A%8F%E5%9C%B0%E9%80%80%E5%87%BA%E7%A8%8B%E5%BA%8F"><span class="toc-text">2.5.2 随时随地退出程序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E8%BF%9B%E7%A8%8B%E7%9A%84%E6%9C%80%E4%BD%B3%E5%86%99%E6%B3%95"><span class="toc-text">2.5.3 启动进程的最佳写法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0-%E8%BD%AF%E4%BB%B6%E4%B9%9F%E8%A6%81%E6%8B%BC%E8%84%B8%E8%9B%8B--ui%E5%BC%80%E5%8F%91%E7%9A%84%E7%82%B9%E7%82%B9%E6%BB%B4%E6%BB%B4"><span class="toc-text">第三章
软件也要拼脸蛋--UI开发的点点滴滴</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A7%E4%BB%B6%E4%B8%8E%E5%B8%83%E5%B1%80"><span class="toc-text">3.1 控件与布局</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%8E%A7%E4%BB%B6"><span class="toc-text">3.2 常用控件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#textview"><span class="toc-text">3.2.1 TextView</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pxdpdpidensity-%E4%B8%8E-sp"><span class="toc-text">3.2.2 px、dp、dpi、density 与 sp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#edittext"><span class="toc-text">3.2.3 EditText</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#imageview"><span class="toc-text">3.2.4 ImageView</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dialogs%E8%87%AA%E5%AD%A6%E5%86%85%E5%AE%B9"><span class="toc-text">3.2.5 Dialogs(自学内容)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%B8%83%E5%B1%80"><span class="toc-text">3.3 基本布局</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#linearlayout"><span class="toc-text">3.3.1 LinearLayout</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#relativelayout"><span class="toc-text">3.3.2 RelativeLayout</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#padding-%E4%B8%8E-margin"><span class="toc-text">3.3.3 padding 与 margin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#framelayout%E8%87%AA%E5%AD%A6%E5%86%85%E5%AE%B9"><span class="toc-text">3.3.4 FrameLayout（自学内容）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#constraintlayout"><span class="toc-text">3.3.5 ConstraintLayout</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6"><span class="toc-text">3.3.6 自定义控件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#recyclerview"><span class="toc-text">3.4 RecyclerView</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%B8%83%E5%B1%80scrollview"><span class="toc-text">3.4.1 基本布局：ScrollView</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#recyclerview-1"><span class="toc-text">3.4.2 RecyclerView</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#layoutmanager"><span class="toc-text">3.4.3 LayoutManager</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#recyclerview%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="toc-text">3.4.4 RecyclerView使用示例</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96"><span class="toc-text">3.4.4.1 添加依赖</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E7%9B%B8%E5%85%B3%E5%86%85%E5%AE%B9%E8%A1%A8%E7%A4%BArecyclerview%E4%B8%AD%E6%AF%8F%E4%B8%80%E4%B8%AA%E7%8B%AC%E7%AB%8B%E7%9A%84item"><span class="toc-text">3.4.4.2
添加相关内容，表示RecyclerView中每一个独立的item</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0recyclerview%E7%9A%84adapter"><span class="toc-text">3.4.4.3
添加RecyclerView的Adapter</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9C%A8activity%E4%B8%AD%E5%AF%B9recyclerview%E6%8E%A7%E4%BB%B6%E8%BF%9B%E8%A1%8C%E7%9B%B8%E5%85%B3%E7%9A%84%E8%AE%BE%E7%BD%AE"><span class="toc-text">3.4.4.4
在Activity中对RecyclerView控件进行相关的设置</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9E%E6%94%B6%E5%A4%8D%E7%94%A8%E6%9C%BA%E5%88%B6"><span class="toc-text">3.4.5 回收复用机制</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#day3-ui%E8%BF%9B%E9%98%B6"><span class="toc-text">Day3 UI进阶</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80fragment"><span class="toc-text">一、Fragment</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#fragment%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95%E5%92%8C%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-text">1.1
Fragment的基本用法和生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#fragment%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-text">1.1.1 Fragment的优点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E6%B7%BB%E5%8A%A0fragment"><span class="toc-text">1.1.2 静态添加Fragment</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E6%B7%BB%E5%8A%A0%E5%88%A0%E9%99%A4fragment"><span class="toc-text">1.1.3 动态添加&#x2F;删除Fragment</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#fragment-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-text">1.1.4 Fragment 生命周期</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#fragment%E6%B7%BB%E5%8A%A0%E5%88%B0%E8%BF%94%E5%9B%9E%E6%A0%88"><span class="toc-text">1.1.5 Fragment添加到返回栈</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E5%90%88-viewpager-%E5%88%9B%E5%BB%BA%E5%A4%9A-tab-%E7%95%8C"><span class="toc-text">1.2 结合 ViewPager 创建多 Tab
界⾯</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#viewpager%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-text">1.2.1 ViewPager的作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#viewpager-fragment"><span class="toc-text">1.2.2 ViewPager + Fragment</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#viewpager-tablayout"><span class="toc-text">1.2.3 ViewPager + TabLayout</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fragmentactivity-%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1"><span class="toc-text">1.3 Fragment&#x2F;Activity
之间的通信</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#fragment%E4%B8%8Eactivity%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1"><span class="toc-text">1.3.1
Fragment与Activity之间的通信</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BC%A0%E5%8F%82"><span class="toc-text">1.3.1.1 传参</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#listener"><span class="toc-text">1.3.1.2 Listener</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#master-detail%E8%87%AA%E5%AD%A6"><span class="toc-text">1.3.2 Master Detail(自学)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">1.4 总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8Canimation"><span class="toc-text">二、Animation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E5%8A%A8%E7%94%BB"><span class="toc-text">2.1 视图动画</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B"><span class="toc-text">2.1.1 示例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E5%8A%A8%E7%94%BB%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="toc-text">2.1.2 视图动画的属性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB"><span class="toc-text">2.2 属性动画</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB-vs-%E8%A7%86%E5%9B%BE%E5%8A%A8%E7%94%BB"><span class="toc-text">2.2.1 属性动画 vs 视图动画</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB%E7%9A%84%E8%A7%92%E8%89%B2%E6%9E%84%E6%88%90"><span class="toc-text">2.2.2 属性动画的角色构成</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#animator%E5%8D%95%E4%B8%AA%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB"><span class="toc-text">2.2.3 Animator：单个属性动画</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#fragment_object_animation.xml"><span class="toc-text">2.2.3.1
fragment_object_animation.xml</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#objectanimationfragment.java"><span class="toc-text">2.2.3.2
ObjectAnimationFragment.java</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#animatorset%E5%A4%9A%E4%B8%AA%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB%E4%B9%8B%E9%97%B4%E7%9A%84%E5%88%87%E6%8D%A2"><span class="toc-text">2.2.4
AnimatorSet：多个属性动画之间的切换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E7%82%B9xml%E8%AF%AD%E6%B3%95"><span class="toc-text">2.2.5 特点，xml语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB%E6%A0%B8%E5%BF%83---valueanimator"><span class="toc-text">2.2.6 属性动画核心 -
ValueAnimator</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB%E5%8E%9F%E7%90%86"><span class="toc-text">2.2.7 属性动画原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB---%E6%B3%A8%E6%84%8F"><span class="toc-text">2.2.8 属性动画 - 注意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB---%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7"><span class="toc-text">2.2.9 属性动画 - 自定义属性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#activity-%E5%88%87%E6%8D%A2%E5%8A%A8%E7%94%BB"><span class="toc-text">2.3 Activity 切换动画</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B-fadeinout"><span class="toc-text">2.3.1 示例 FadeInOut</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%90%E5%B8%A7%E5%8A%A8%E7%94%BBdrawable-%E5%8A%A8%E7%94%BB"><span class="toc-text">2.4 逐帧动画&#x2F;Drawable 动画</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B-animationdrawable"><span class="toc-text">2.4.1 示例 AnimationDrawable</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lottie"><span class="toc-text">2.5 Lottie</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B-1"><span class="toc-text">2.5.1 示例</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#day4-%E5%A4%8D%E6%9D%82%E5%BA%94%E7%94%A8%E7%BB%84%E4%BB%B6"><span class="toc-text">Day4 复杂应用组件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B"><span class="toc-text">一、进程与线程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E7%BA%BF%E7%A8%8B"><span class="toc-text">1.1 进程、线程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#android%E4%B8%AD%E7%9A%84%E4%B8%BB%E7%BA%BF%E7%A8%8B"><span class="toc-text">1.2 Android中的主线程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#anr-%E6%8B%93%E5%B1%95"><span class="toc-text">1.3 ANR 拓展</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8Chandler%E6%9C%BA%E5%88%B6"><span class="toc-text">二、Handler机制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#handler%E6%9C%BA%E5%88%B6"><span class="toc-text">2.1 Handler机制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#handler%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-text">2.2 Handler的使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#handler%E6%9C%BA%E5%88%B6%E7%AE%80%E4%BB%8B"><span class="toc-text">2.3 Handler机制简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#handler%E5%8E%9F%E7%90%86ui%E7%BA%BF%E7%A8%8B%E4%B8%8E%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E6%9C%BA%E5%88%B6"><span class="toc-text">2.4
Handler原理：UI线程与消息队列机制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#handler%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-text">2.5 Handler常用方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#handler%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">2.6 Handler的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#handler%E7%9A%84%E4%BD%BF%E7%94%A8%E4%B8%BE%E4%BE%8B"><span class="toc-text">2.7 Handler的使用举例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E9%80%81runnable%E5%AF%B9%E8%B1%A1"><span class="toc-text">2.7.1 发送Runnable对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E9%80%81message%E5%AF%B9%E8%B1%A1"><span class="toc-text">2.7.2 发送Message对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%A8%E6%9E%90runnable%E4%B8%8Emessage"><span class="toc-text">2.7.3 辨析Runnable与Message</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#handler%E6%80%BB%E7%BB%93"><span class="toc-text">2.8 Handler总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89android%E4%B8%AD%E7%9A%84%E5%A4%9A%E7%BA%BF%E7%A8%8B"><span class="toc-text">三、Android中的多线程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#thread"><span class="toc-text">3.1 Thread</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#threadpool"><span class="toc-text">3.2 ThreadPool</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8%E7%BA%BF%E7%A8%8B%E6%B1%A0"><span class="toc-text">3.2.1 为什么要使用线程池</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%A0%E7%A7%8D%E5%B8%B8%E7%94%A8%E7%9A%84%E7%BA%BF%E7%A8%8B%E6%B1%A0"><span class="toc-text">3.2.2 几种常用的线程池</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="toc-text">3.2.3 使用示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#asynctask%E5%B7%B2%E5%BC%83%E7%94%A8"><span class="toc-text">3.3 AsyncTask(已弃用)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#handlerthread"><span class="toc-text">3.4 HandlerThread</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#intentservice%E4%B8%8D%E5%B8%B8%E7%94%A8-%E8%87%AA%E5%AD%A6"><span class="toc-text">3.5 IntentService(不常用, 自学)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#android%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%80%BB%E7%BB%93"><span class="toc-text">3.6 Android多线程总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E8%87%AA%E5%AE%9A%E4%B9%89view"><span class="toc-text">四、自定义View</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#view%E7%BB%98%E5%88%B6%E7%9A%84%E4%B8%89%E4%B8%AA%E9%87%8D%E8%A6%81%E6%AD%A5%E9%AA%A4"><span class="toc-text">4.1 View绘制的三个重要步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%98%E5%88%B6%E6%B5%81%E7%A8%8B"><span class="toc-text">4.2 绘制流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89view%E9%87%8D%E5%86%99ondraw"><span class="toc-text">4.3 自定义View：重写onDraw</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%BB%E7%82%B9"><span class="toc-text">4.3.1 画点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%BB%E7%BA%BF"><span class="toc-text">4.3.2 画线</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%BB%E5%9C%86"><span class="toc-text">4.3.3 画圆</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A1%AB%E5%85%85"><span class="toc-text">4.3.4 填充</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E8%A7%84%E5%88%99%E5%9B%BE%E5%BD%A2"><span class="toc-text">4.3.5 不规则图形</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%BB%E6%96%87%E6%9C%AC"><span class="toc-text">4.3.6 画文本</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89view%E6%80%BB%E7%BB%93"><span class="toc-text">4.4 自定义View总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#day5-android%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C"><span class="toc-text">Day5 Android中的网络</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-text">一、网络基础知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%88%86%E5%B1%82%E6%A8%A1%E5%9E%8B"><span class="toc-text">1.1 网络分层模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#http%E5%8D%8F%E8%AE%AE"><span class="toc-text">1.2 HTTP协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#restful-api"><span class="toc-text">1.3 RESTful API</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#api"><span class="toc-text">1.3.1 API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#restful-api-1"><span class="toc-text">1.3.2 RESTful API</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E6%A0%BC%E5%BC%8F"><span class="toc-text">1.4 数据传输格式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#json%E8%A7%A3%E6%9E%90%E5%99%A8gson"><span class="toc-text">1.4.1 JSON解析器：gson</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8B%E5%88%92%E7%BA%BF%E5%91%BD%E5%90%8D-vs-%E9%A9%BC%E5%B3%B0%E5%91%BD%E5%90%8D"><span class="toc-text">1.4.2 下划线命名 vs 驼峰命名</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7"><span class="toc-text">1.5 实用工具</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#json%E7%9B%B8%E5%85%B3"><span class="toc-text">1.5.1 JSON相关</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8A%93%E5%8C%85%E5%B7%A5%E5%85%B7-charles"><span class="toc-text">1.5.2 抓包工具 Charles</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8A%93%E5%8C%85%E5%B7%A5%E5%85%B7-postman%E8%BD%BB%E6%9D%BE%E5%88%9B%E5%BB%BA%E8%AF%B7%E6%B1%82"><span class="toc-text">1.5.3 抓包工具
Postman–轻松创建请求</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8Candroid%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1%E5%9F%BA%E7%A1%80%E5%AE%9E%E7%8E%B0"><span class="toc-text">二、Android网络通信基础实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E7%BD%91%E7%BB%9C%E6%9D%83%E9%99%90"><span class="toc-text">2.1 添加网络权限</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%BD%91%E7%BB%9C%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-text">2.2 获取网络中的数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8webview%E6%89%93%E5%BC%80%E7%BD%91%E9%A1%B5"><span class="toc-text">2.3 使用WebView打开网页</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E8%BF%9B%E9%98%B6%E5%AE%9E%E7%8E%B0retrofit%E8%87%AA%E5%AD%A6"><span class="toc-text">三、进阶实现：Retrofit(自学)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#day6-android%E5%AD%98%E5%82%A8"><span class="toc-text">Day6 Android存储</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E5%AD%98%E5%82%A8%E7%A9%BA%E9%97%B4%E6%A6%82%E8%A7%88"><span class="toc-text">一、存储空间概览</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E7%A9%BA%E9%97%B4%E7%9A%84%E5%8C%BA%E5%88%86"><span class="toc-text">1.1 存储空间的区分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E7%9B%AE%E5%BD%95"><span class="toc-text">1.2 存储目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#internal%E7%9B%AE%E5%BD%95%E7%9A%84%E8%8E%B7%E5%8F%96"><span class="toc-text">1.3 Internal目录的获取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#external%E7%9B%AE%E5%BD%95%E7%9A%84%E8%8E%B7%E5%8F%96"><span class="toc-text">1.4 External目录的获取</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%8E%88%E6%9D%83"><span class="toc-text">1.4.1 获取授权</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#environment-apis"><span class="toc-text">1.4.2 Environment APIs</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%A4%96%E7%BD%AE%E5%AD%98%E5%82%A8%E5%99%A8%E7%9A%84%E5%8F%AF%E7%94%A8%E6%80%A7"><span class="toc-text">1.4.3 检查外置存储器的可用性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#external%E7%9B%AE%E5%BD%95%E7%9A%84%E8%8E%B7%E5%8F%96-1"><span class="toc-text">1.4.4 External目录的获取</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">1.5 注意事项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E9%94%AE%E5%80%BC%E5%AF%B9"><span class="toc-text">二、键值对</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89sharedpreferences"><span class="toc-text">三、SharedPreferences</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-text">3.1 介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96sharedpreferences"><span class="toc-text">3.2 获取SharedPreferences</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96sharedpreferences"><span class="toc-text">3.3 读取SharedPreferences</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%99sharedpreferences"><span class="toc-text">3.4 写SharedPreferences</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sharedpreferences%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-text">3.5 SharedPreferences的原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-1"><span class="toc-text">3.6 注意事项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E6%96%87%E4%BB%B6file"><span class="toc-text">四、文件File</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81"><span class="toc-text">4.1 流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#api-1"><span class="toc-text">4.2 API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-text">4.3 文件操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6io%E8%AF%BB%E5%86%99%E6%93%8D%E4%BD%9C%E7%A4%BA%E4%BE%8B"><span class="toc-text">4.4 文件IO读写操作示例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%93%E5%B1%95okio"><span class="toc-text">4.7 拓展：OkIO</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">五、数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-text">5.1 使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E8%AE%BE%E8%AE%A1"><span class="toc-text">5.2 数据库的设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sql"><span class="toc-text">5.3 SQL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8Btodo-list-app"><span class="toc-text">5.4 使用示例：Todo List App</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89contract%E7%B1%BB"><span class="toc-text">5.4.1 定义Contract类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%A7%E6%89%BFsqliteopenhelper"><span class="toc-text">5.4.2 继承SQLiteOpenHelper</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96sqllitedatabase"><span class="toc-text">5.4.3 获取SQLLiteDatabase</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#insert"><span class="toc-text">5.4.4 Insert</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#query"><span class="toc-text">5.4.5 Query</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#delete"><span class="toc-text">5.4.6 Delete</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#update"><span class="toc-text">5.4.7 Update</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#debug"><span class="toc-text">5.4.8 Debug</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-2"><span class="toc-text">5.4.8 注意事项</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#room-library"><span class="toc-text">5.5 Room Library</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%ADcontent-provider"><span class="toc-text">六、Content Provider</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89"><span class="toc-text">6.1 定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#content-provider%E6%9E%B6%E6%9E%84"><span class="toc-text">6.2 Content Provider架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9"><span class="toc-text">6.3 优点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83uri"><span class="toc-text">七、URI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#uri%E4%BB%8B%E7%BB%8D"><span class="toc-text">7.1 URI介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#uri%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="toc-text">7.2 URI使用示例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E8%8E%B7%E5%8F%96%E8%81%94%E7%B3%BB%E4%BA%BA%E6%95%B0%E6%8D%AE"><span class="toc-text">7.2.1 查询：获取联系人数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%86%8C%E4%B8%AD%E7%9A%84%E8%A7%86%E9%A2%91%E6%96%87%E4%BB%B6"><span class="toc-text">7.2.2
查询：获取系统相册中的视频文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96uri%E5%AF%B9%E5%BA%94%E7%9A%84%E5%9B%BE%E7%89%87%E5%88%B0imageview%E4%B8%AD"><span class="toc-text">7.2.3
读取URI对应的图片到ImageView中</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#day7-android%E5%A4%9A%E5%AA%92%E4%BD%93%E5%9F%BA%E7%A1%80"><span class="toc-text">Day7 Android多媒体基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E5%9B%BE%E7%89%87%E5%9F%BA%E7%A1%80"><span class="toc-text">一、图片基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E5%9F%BA%E7%A1%80%E9%A2%9C%E8%89%B2%E7%A9%BA%E9%97%B4"><span class="toc-text">1.1 图片基础：颜色空间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E5%AD%98%E5%82%A8%E4%BD%8D%E5%9B%BE"><span class="toc-text">1.2 图片存储：位图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E5%8E%8B%E7%BC%A9%E6%A0%87%E5%87%86%E6%96%B9%E6%A1%88"><span class="toc-text">1.3 图片格式：压缩标准方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E5%AD%98%E5%82%A8%E7%9F%A2%E9%87%8F%E5%9B%BE"><span class="toc-text">1.4 图片存储：矢量图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8Candroid%E5%9B%BE%E7%89%87%E5%8A%A0%E8%BD%BD"><span class="toc-text">二、Android图片加载</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#graphics%E5%8C%85%E5%AE%89%E5%8D%93%E5%B9%B3%E5%8F%B02d%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6%E7%9A%84%E5%9F%BA%E7%A1%80"><span class="toc-text">2.1
Graphics包：安卓平台2D图形绘制的基础</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#android-bitmap%E4%B8%80%E7%A7%8D%E5%AD%98%E5%82%A8%E5%83%8F%E7%B4%A0%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-text">2.2 Android
Bitmap：一种存储像素的数据结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E5%8A%A0%E8%BD%BD"><span class="toc-text">2.3 图片加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E8%B6%85%E5%A4%A7%E5%9B%BE%E7%89%87"><span class="toc-text">2.4 加载超大图片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E5%9B%BE%E5%88%86%E5%9D%97%E5%8A%A0%E8%BD%BD"><span class="toc-text">2.5 大图分块加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E8%87%AA%E9%80%82%E5%BA%94ninepatchdrawable"><span class="toc-text">2.6
图片自适应：NinePatchDrawable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#imageview-1"><span class="toc-text">2.7 ImageView</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#drawable"><span class="toc-text">2.8 Drawable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E5%9B%BE%E7%89%87%E5%BA%93"><span class="toc-text">2.9 常见图片库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#glide"><span class="toc-text">2.10 Glide</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#glide%E7%9A%84%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8"><span class="toc-text">2.10.1 Glide的基础使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#glide%E6%B5%81%E7%A8%8B"><span class="toc-text">2.10.2 Glide流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#glide-requestbuilder"><span class="toc-text">2.10.3 Glide RequestBuilder</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#glide-requestoptions"><span class="toc-text">2.10.4 Glide RequestOptions</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98%E7%AD%96%E7%95%A5"><span class="toc-text">2.11 图片缓存策略</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E9%9F%B3%E8%A7%86%E9%A2%91%E6%92%AD%E6%94%BE"><span class="toc-text">三、音视频播放</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E9%A2%91%E5%B8%A7"><span class="toc-text">3.1 视频帧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81"><span class="toc-text">3.2 视频编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E9%A2%91%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F"><span class="toc-text">3.3 视频封装格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E9%A2%91%E6%92%AD%E6%94%BE"><span class="toc-text">3.4 视频播放</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#android%E9%9F%B3%E9%A2%91%E6%92%AD%E6%94%BE"><span class="toc-text">3.5 Android音频播放</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#media-player"><span class="toc-text">3.6 Media Player</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mediaplayer%E6%92%AD%E6%94%BE%E8%A7%86%E9%A2%91"><span class="toc-text">3.7 MediaPlayer播放视频</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#videoview%E6%92%AD%E6%94%BE%E8%A7%86%E9%A2%91"><span class="toc-text">3.8 VideoView播放视频</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%96%B9%E6%92%AD%E6%94%BE%E5%99%A8"><span class="toc-text">3.9 第三方播放器</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#day8-android%E5%A4%9A%E5%AA%92%E4%BD%93%E8%BF%9B%E9%98%B6"><span class="toc-text">Day8 Android多媒体进阶</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E8%A7%86%E9%A2%91%E4%BB%8B%E7%BB%8D"><span class="toc-text">一、视频介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E8%A7%89%E6%88%90%E5%83%8F%E7%9A%84%E5%9F%BA%E7%A1%80%E5%8E%9F%E7%90%86"><span class="toc-text">1.1 视觉成像的基础原理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%86%E7%BD%91%E8%86%9C%E8%A7%86%E9%94%A5%E7%BB%86%E8%83%9E"><span class="toc-text">1.1.1 视网膜：视锥细胞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#rgbred-green-blue"><span class="toc-text">1.1.2 RGB：Red, Green, Blue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#yuvluma-chroma"><span class="toc-text">1.1.3 YUV：Luma &amp; Chroma</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#chroma%E4%B8%8B%E9%87%87%E6%A0%B7yuv420"><span class="toc-text">1.1.4 Chroma下采样：YUV420</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E9%A2%91%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">1.2 视频是什么</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E8%BE%A8%E7%8E%87%E5%B8%A7%E7%8E%87%E7%A0%81%E7%8E%87"><span class="toc-text">1.3 分辨率、帧率、码率</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81-1"><span class="toc-text">1.4 视频编码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-text">1.4.1 原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ibp%E5%B8%A7"><span class="toc-text">1.4.2 I&#x2F;B&#x2F;P帧</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E6%A0%BC%E5%BC%8F"><span class="toc-text">1.4.3 编码格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F"><span class="toc-text">1.4.4 封装格式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E7%9B%B8%E6%9C%BA%E6%8B%8D%E7%85%A7"><span class="toc-text">二、相机拍照</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%83%E8%B5%B7%E7%B3%BB%E7%BB%9F%E7%9B%B8%E6%9C%BA"><span class="toc-text">2.1 调起系统相机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%B7%AF%E5%BE%84"><span class="toc-text">2.2 自定义存储路径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%BE%E7%A4%BA%E5%9B%BE%E7%89%87"><span class="toc-text">2.3 显示图片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%BE%E7%A4%BA%E6%95%88%E6%9E%9C"><span class="toc-text">2.4 显示效果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E7%AE%80%E5%8D%95%E5%BD%95%E5%88%B6"><span class="toc-text">三、简单录制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%83%E8%B5%B7%E7%B3%BB%E7%BB%9F%E7%9B%B8%E6%9C%BA-1"><span class="toc-text">3.1 调起系统相机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%BE%E7%A4%BA%E5%BD%95%E5%88%B6%E8%A7%86%E9%A2%91"><span class="toc-text">3.2 显示录制视频</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E8%A7%86%E9%A2%91%E5%AD%98%E5%82%A8%E5%88%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%B7%AF%E5%BE%84%E4%B8%AD"><span class="toc-text">3.3
将视频存储到自定义存储路径中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE"><span class="toc-text">3.4 查看数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BD%95%E5%88%B6"><span class="toc-text">四、自定义录制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96camera%E5%AE%9E%E4%BE%8B"><span class="toc-text">4.1 获取Camera实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%91%84%E5%83%8F%E5%A4%B4%E6%95%B0%E6%8D%AE%E5%AE%9E%E6%97%B6%E6%98%BE%E7%A4%BA"><span class="toc-text">4.2 摄像头数据实时显示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#surfaceview"><span class="toc-text">4.3 SurfaceView</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%84%E7%90%86activity%E7%9A%84%E5%A3%B0%E6%98%8E%E5%91%A8%E6%9C%9F%E5%AF%B9%E9%A2%84%E8%A7%88%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="toc-text">4.4
处理Activity的声明周期对预览的影响</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%8D%E6%91%84%E4%B8%80%E5%BC%A0%E5%AE%9E%E6%97%B6%E5%9B%BE%E7%89%87"><span class="toc-text">4.5 拍摄一张实时图片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mediarecorder"><span class="toc-text">4.6 MediaRecorder</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mediarecorder%E7%9A%84%E7%8A%B6%E6%80%81%E6%9C%BA"><span class="toc-text">4.6.1 MediaRecorder的状态机</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B%E5%BD%95%E5%88%B6%E6%8C%89%E9%83%A8%E5%B0%B1%E7%8F%AD"><span class="toc-text">4.6.2 开始录制（按部就班）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9D%9F%E5%BD%95%E5%88%B6%E6%8C%89%E9%83%A8%E5%B0%B1%E7%8F%AD"><span class="toc-text">4.6.3 结束录制（按部就班）</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/07/18/GAMES104/18--%E7%BD%91%E7%BB%9C%E6%B8%B8%E6%88%8F%E7%9A%84%E6%9E%B6%E6%9E%84%E5%9F%BA%E7%A1%80/" title="GAMES104-18：网络游戏的架构基础">GAMES104-18：网络游戏的架构基础</a><time datetime="2023-07-17T16:00:00.000Z" title="发表于 2023-07-18 00:00:00">2023-07-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/07/14/GAMES104/14--%E5%B7%A5%E5%85%B7%E9%93%BE%EF%BC%9A%E9%AB%98%E7%BA%A7%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%BA%94%E7%94%A8/" title="GAMES104-14：工具链：高级概念及应用">GAMES104-14：工具链：高级概念及应用</a><time datetime="2023-07-13T16:00:00.000Z" title="发表于 2023-07-14 00:00:00">2023-07-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/07/13/GAMES104/13--%E5%B7%A5%E5%85%B7%E9%93%BE%EF%BC%9A%E5%9F%BA%E7%A1%80/" title="GAMES104-13：工具链：基础">GAMES104-13：工具链：基础</a><time datetime="2023-07-12T16:00:00.000Z" title="发表于 2023-07-13 00:00:00">2023-07-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/07/12/GAMES104/12--%E7%89%B9%E6%95%88%EF%BC%9A%E7%B2%92%E5%AD%90%E5%92%8C%E5%A3%B0%E6%95%88%E7%B3%BB%E7%BB%9F/" title="GAMES104-12：特效：粒子和声效系统">GAMES104-12：特效：粒子和声效系统</a><time datetime="2023-07-11T16:00:00.000Z" title="发表于 2023-07-12 00:00:00">2023-07-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/07/11/GAMES104/11--%E7%89%A9%E7%90%86%EF%BC%9A%E9%AB%98%E7%BA%A7%E5%BA%94%E7%94%A8/" title="GAMES104-11：物理：高级应用">GAMES104-11：物理：高级应用</a><time datetime="2023-07-10T16:00:00.000Z" title="发表于 2023-07-11 00:00:00">2023-07-11</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 华丰夏</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>